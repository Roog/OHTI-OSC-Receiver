#region copyright
/*
 * Open Headtracker Initiative OSC Websocket Gateway
 *
 * Copyright (c) 2021 Bo-Erik Sandholm & Roger Sandholm, Stockholm, Sweden
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. The name of the author may not be used to endorse or promote products
 *    derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
 * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
 * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
 * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
#endregion copyright

using System;
using Microsoft.AspNetCore.Mvc;
using OHTI_OSC_Receiver.Helpers;

namespace OHTI_OSC_Receiver.Controllers
{
    public class HomeController : Controller
    {
        [HttpGet]
        [Route("~/", Name = "default")]
        public ActionResult Index()
        {
            var data = @"
                <!DOCTYPE html>
                <html lang='en' xmlns='http://www.w3.org/1999/xhtml'>
                <head>
                    <meta charset='utf-8' />
                    <title>Headtracking gateway</title>
                    <style type='text/css'>
                        @import url('https://fonts.googleapis.com/css2?family=Rubik+Mono+One&display=swap');

                        html {
                            min-height: 100vh;
                        }
                        body {
                            font-family: 'Rubik Mono One', Arial, sans-serif;
                            font-size: 16px;
                            font-weight: 200;
                            background: #00caae;
                            color: #e7f5ff;
                            margin: 0;
                            padding: 0;
                            min-height: 100%;
                        }
                        h1 {
                            font-size: 2.6rem;
                            letter-spacing: -1px;
                            text-align: left;
                            font-weight: 200;
                            word-break: break-all;
                            margin: 0.2rem 0;
                        }
                        h2 {
                            font-size: 1.8rem;
                            text-align: left;
                            font-weight: 200;
                            word-break: break-all;
                            color: #95fff0;
                            margin: 0.2rem 0;
                        }
                        h3 {
                            font-size: 1.4rem;
                            text-align: left;
                            font-weight: 200;
                            word-break: break-all;
                            color: #582222;
                            margin: 0.2rem 0;
                        }
                        .container {
                            padding: 2rem;
                        }
                        .row {
                            padding: 0.8rem 2rem;
                            display: flex;
                            flex-direction: column;
                        }
                        .data-point {
                            display: flex;
                            text-align: left;
                            padding: 0.2rem 0;
                        }
                        .data-point-text {
                            font-size: 1.6rem;
                            font-weight: 200;
                            flex: 0 1 35%;
                            text-align: right;
                            padding-right: 1rem;
                            max-width: 18rem;
                        }
                        .data-point-value {
                            color: #225851;
                            font-size: 1.6rem;
                            align-self: center;
                            word-break: break-all;
                        }
                        .circuit-board {
                            position: fixed;
                            z-index: -1;
                            right: 0;
                            bottom: -6vw;
                            width: 30vw;
                            height: 30vw;
                            pointer-events: none;
                        }
                    </style>
                </head>
                <body>
                    <div class='container'>
                        <h1>Headtracking</h1>
                        <h2 id='socketStatus'></h2>

                        <div class='row'>
                            <div class='data-point'>
                                <div class='data-point-text'>W</div>
                                <div class='data-point-value' id='data-w'></div>
                            </div>
                            <div class='data-point'>
                                <div class='data-point-text'>X</div>
                                <div class='data-point-value' id='data-x'></div>
                            </div>
                            <div class='data-point'>
                                <div class='data-point-text'>Y</div>
                                <div class='data-point-value' id='data-y'></div>
                            </div>
                            <div class='data-point'>
                                <div class='data-point-text'>Z</div>
                                <div class='data-point-value' id='data-z'></div>
                            </div>
                        </div>

                        <div class='row'>
                            <div class='data-point'>
                                <div class='data-point-text'>Roll</div>
                                <div class='data-point-value' id='data-roll'></div>
                            </div>
                            <div class='data-point'>
                                <div class='data-point-text'>Pitch</div>
                                <div class='data-point-value' id='data-pitch'></div>
                            </div>
                            <div class='data-point'>
                                <div class='data-point-text'>Yaw</div>
                                <div class='data-point-value' id='data-yaw'></div>
                            </div>
                        </div>

                        <h2>Settings</h2>
                        <div class='row'>
                            <div class='data-point'>
                                <div class='data-point-text'>Device</div>
                                <div class='data-point-value' id='data-setting-device'></div>
                            </div>
                            <div class='data-point'>
                                <div class='data-point-text'>Listening</div>
                                <div class='data-point-value' id='data-setting-is-listening'></div>
                            </div>
                            <div class='data-point'>
                                <div class='data-point-text'>Receiving</div>
                                <div class='data-point-value' id='data-setting-is-receiving'></div>
                            </div>
                            <div class='data-point'>
                                <div class='data-point-text'>OSC Address</div>
                                <div class='data-point-value' id='data-setting-osc-address'></div>
                            </div>
                        </div>

                        <h3 id='errorStatus'></h3>

                        <div class='circuit-board'>
                            <svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 140 140' enable-background='new 0 0 140 140' xml:space='preserve'>
	                            <g>
		                            <path fill='#DD6460' d='M80.6,128.7L11.3,59.4c-2.3-2.3-2.3-6.1,0-8.5l39.6-39.6c2.3-2.3,6.1-2.3,8.5,0l69.3,69.3c2.3,2.3,2.3,6.1,0,8.5l-39.6,39.6C86.7,131,82.9,131,80.6,128.7z'/>
		                            <circle fill='#DD9B62' cx='120.2' cy='84.8' r='7'/>
		                            <circle fill='#DB7478' cx='120.2' cy='84.8' r='4.4'/>
		                            <circle fill='#DD9B62' cx='19.8' cy='55.2' r='7'/>
		                            <circle fill='#DB7478' cx='19.8' cy='55.2' r='4.4'/>
		                            <polyline fill='none' stroke='#DF6D6A' stroke-width='4' stroke-linecap='round' stroke-linejoin='round' stroke-miterlimit='10' points='71.3,43.3 71.4,30.4 58.4,17.4 50.6,25.1'/>
		                            <polyline fill='none' stroke='#DF6D6A' stroke-width='4' stroke-linecap='round' stroke-linejoin='round' stroke-miterlimit='10' points='86.9,118 81.9,122.9 57.6,98 57.3,82.2'/>
		                            <line fill='none' stroke='#DF6D6A' stroke-width='4' stroke-linecap='round' stroke-linejoin='round' stroke-miterlimit='10' x1='97' y1='107.6' x2='98.7' y2='88.1'/>
		                            <g>
			                            <path fill='#DD9B62' d='M86.3,52.3c1.1,0,2-0.9,2-2v0c0-1.1-0.9-2-2-2h-6v-6c0-1.1-0.9-2-2-2c-1.1,0-2,0.9-2,2v6h-3v-6c0-1.1-0.9-2-2-2s-2,0.9-2,2v6h-3v-6c0-1.1-0.9-2-2-2s-2,0.9-2,2v6h-3v-6c0-1.1-0.9-2-2-2s-2,0.9-2,2v6h-3v-6c0-1.1-0.9-2-2-2c-1.1,0-2,0.9-2,2v6h-6c-1.1,0-2,0.9-2,2v0c0,1.1,0.9,2,2,2h6v3h-6c-1.1,0-2,0.9-2,2c0,1.1,0.9,2,2,2h6v3h-6c-1.1,0-2,0.9-2,2c0,1.1,0.9,2,2,2h6v3h-6c-1.1,0-2,0.9-2,2s0.9,2,2,2h6v3h-6c-1.1,0-2,0.9-2,2s0.9,2,2,2h6v6c0,1.1,0.9,2,2,2c1.1,0,2-0.9,2-2v-6h3v6c0,1.1,0.9,2,2,2s2-0.9,2-2v-6h3v6c0,1.1,0.9,2,2,2s2-0.9,2-2v-6h3v6c0,1.1,0.9,2,2,2s2-0.9,2-2v-6h3v6c0,1.1,0.9,2,2,2c1.1,0,2-0.9,2-2v-6h6c1.1,0,2-0.9,2-2s-0.9-2-2-2h-6v-3h6c1.1,0,2-0.9,2-2s-0.9-2-2-2h-6v-3h6c1.1,0,2-0.9,2-2c0-1.1-0.9-2-2-2h-6v-3h6c1.1,0,2-0.9,2-2c0-1.1-0.9-2-2-2h-6v-3H86.3z'/>
			                            <path fill='#DE7F82' d='M82.3,84.3h-36c-1.1,0-2-0.9-2-2v-36c0-1.1,0.9-2,2-2h36c1.1,0,2,0.9,2,2v36C84.3,83.4,83.4,84.3,82.3,84.3z'/>
			                            <path fill='#E0888B' d='M61.3,64.3h-11c-0.6,0-1-0.4-1-1v-3c0-0.6,0.4-1,1-1h11c0.6,0,1,0.4,1,1v3C62.3,63.9,61.9,64.3,61.3,64.3z'/>
			                            <path fill='#E0888B' d='M66.3,54.3h-16c-0.6,0-1-0.4-1-1v-3c0-0.6,0.4-1,1-1h16c0.6,0,1,0.4,1,1v3C67.3,53.9,66.9,54.3,66.3,54.3z'/>
		                            </g>
		                            <g>
			                            <path fill='#DD9B62' d='M39.6,36.1L39.6,36.1c-0.8-0.8-0.8-2,0-2.8l12.7-12.7c0.8-0.8,2-0.8,2.8,0l0,0c0.8,0.8,0.8,2,0,2.8L42.5,36.1C41.7,36.9,40.4,36.9,39.6,36.1z'/>
			                            <path fill='#F0BCBB' d='M47,37.8L34.3,25.1c-0.8-0.8-0.8-2,0-2.8l7.1-7.1c0.8-0.8,2-0.8,2.8,0l12.7,12.7c0.8,0.8,0.8,2,0,2.8l-7.1,7.1C49.1,38.6,47.8,38.6,47,37.8z'/>
			                            <path fill='#FFE1E1' d='M46.9,34.1L44.7,32c-0.4-0.4-0.4-1,0-1.4l4.9-4.9c0.4-0.4,1-0.4,1.4,0l2.1,2.1c0.4,0.4,0.4,1,0,1.4l-4.9,4.9C47.9,34.5,47.2,34.5,46.9,34.1z'/>
		                            </g>
		                            <g>
			                            <path fill='#DD9B62' d='M85.3,119.3L85.3,119.3c-0.8-0.8-0.8-2,0-2.8l10.6-10.6c0.8-0.8,2-0.8,2.8,0h0c0.8,0.8,0.8,2,0,2.8l-10.6,10.6C87.4,120.1,86.1,120.1,85.3,119.3z'/>
			                            <path fill='#DE7F82' d='M89.8,118.1l-3.3-3.3c-0.8-0.8-0.8-2,0-2.8l4.9-4.9c0.8-0.8,2-0.8,2.8,0l3.3,3.3c0.8,0.8,0.8,2,0,2.8l-4.9,4.9C91.9,118.9,90.6,118.9,89.8,118.1z'/>
		                            </g>
		                            <g>
			                            <circle fill='#DD9A60' cx='98.7' cy='88.1' r='8.5'/>
			                            <circle fill='#EA7878' cx='98.7' cy='88.1' r='4.5'/>
		                            </g>
	                            </g>
                            </svg>
                        </div>
                    </div>

                    <script src='signalr.js'></script>

                    <script type='text/javascript'>
                    'use strict';

                    var connection = new signalR.HubConnectionBuilder()
                        .withUrl('/apiHub')
                        .withAutomaticReconnect()
                        .build();

                    setSocketConnectionFeedback(`Gateway disconnected`);

                    var $dataW = document.getElementById('data-w');
                    var $dataX = document.getElementById('data-x');
                    var $dataY = document.getElementById('data-y');
                    var $dataZ = document.getElementById('data-z');
                    var currentOscPath = '';
                    connection.on('HeadtrackerEvent', (path, dataW, dataX, dataY, dataZ) => {
                        //console.log(path, dataW, dataX, dataY, dataZ);
                        currentOscPath = path;

                        requestAnimationFrame(() => {
                            $dataW.textContent = dataW > 0 ? `+${dataW}` : dataW;
                            $dataX.textContent = dataX > 0 ? `+${dataX}` : dataX;
                            $dataY.textContent = dataY > 0 ? `+${dataY}` : dataY;
                            $dataZ.textContent = dataZ > 0 ? `+${dataZ}` : dataZ;
                        });
                    });

                    var $dataYaw = document.getElementById('data-yaw');
                    var $dataPitch = document.getElementById('data-pitch');
                    var $dataRoll = document.getElementById('data-roll');
                    connection.on('HeadtrackerEulerEvent', (path, yaw, pitch, roll) => {
                        //console.log(path, dataW, dataX, dataY, dataZ);
                        requestAnimationFrame(() => {
                            $dataYaw.textContent = yaw > 0 ? `+${yaw}` : yaw;
                            $dataPitch.textContent = pitch > 0 ? `+${pitch}` : pitch;
                            $dataRoll.textContent = roll > 0 ? `+${roll}` : roll;
                        });
                    });

                    var $dataSettingDevice = document.getElementById('data-setting-device');
                    var $dataSettingOscAddress = document.getElementById('data-setting-osc-address');
                    var applicationSettings = null;
                    connection.on('ApplicationSettings', (settings) => {
                        console.log('Settings: ', settings);
                        applicationSettings = settings;
                        if (!$dataSettingDevice) {
                            return;
                        }
                        $dataSettingDevice.textContent = `${settings.receiver.hostname}:${settings.receiver.port}`;
                        $dataSettingOscAddress.textContent = `${settings.receiver.oscAddress}`;
                    });

                    var $dataSettingIsListening = document.getElementById('data-setting-is-listening');
                    var $dataSettingIsReceiving = document.getElementById('data-setting-is-receiving');
                    var $errorStatus = document.getElementById('errorStatus');
                    var lastReceivedData = new Date();
                    connection.on('ApplicationState', (state) => {
                        $dataSettingIsListening.textContent = state.receiverIsConnected ? `Yes` : `No`;

                        if (lastReceivedData.getTime() >= (new Date(state.lastReceivedData).getTime())) {
                            $dataSettingIsReceiving.textContent = `No, last ${formatDateTime(state.lastReceivedData)}`;
                        } else {
                            $dataSettingIsReceiving.textContent = `Yes`;
                        }
                        lastReceivedData = new Date(state.lastReceivedData);

                        if (applicationSettings.receiver.oscAddress != currentOscPath) {
                            $errorStatus.textContent = `Missmatch in receiving osc address '${currentOscPath}' with configured.`;
                        } else {
                            $errorStatus.textContent = ``;
                        }
                    });

                    connection.start()
                        .then(function () {
                            setSocketConnectionFeedback(`Gateway ${connection.connectionState.toLowerCase()} `);
                        })
                        .catch(function (err) {
                            setSocketConnectionFeedback(`Gateway connection error ${err.toString()}`);
                            $dataSettingIsListening.textContent = `Unknown`;
                            $dataSettingIsReceiving.textContent = `Unknown`;
                            return console.error(err.toString());
                        });

                    connection.onclose(function() {
                        console.log('connection onclose');
                        $dataSettingIsListening.textContent = `Unknown`;
                        $dataSettingIsReceiving.textContent = `Unknown`;
                        setSocketConnectionFeedback(`Gateway ${connection.connectionState.toLowerCase()} `);
                    });

                    connection.onreconnecting(function(error) {
                        console.log('connection onreconnecting', error);
                        $dataSettingIsListening.textContent = `Unknown`;
                        $dataSettingIsReceiving.textContent = `Unknown`;
                        setSocketConnectionFeedback(`Problems with connection to gateway ${connection.connectionState.toLowerCase()} `);
                    });

                    connection.onreconnected(function() {
                        console.log('connection onreconnected');
                        setSocketConnectionFeedback(`Gateway connection ${connection.connectionState.toLowerCase()} `);
                    });

                    function setSocketConnectionFeedback(message) {
                        document.getElementById('socketStatus').textContent = message;
                    }

                    function formatDateTime(incoming) {
                        let date = new Date(incoming);
                        let dd = (date.getDate() < 10 ? '0' : '') + date.getDate();
                        let MM = ((date.getMonth() + 1) < 10 ? '0' : '') + (date.getMonth() + 1);
                        let yyyy = date.getFullYear();

                        let hours = (date.getHours() < 10 ? '0' : '') + date.getHours();
                        let minutes = (date.getMinutes() < 10 ? '0' : '') + date.getMinutes();
                        let seconds = (date.getSeconds() < 10 ? '0' : '') + date.getSeconds();

                        return (`${yyyy}-${MM}-${dd} ${hours}:${minutes}:${seconds}`);
                    }

                    </script>
                </body>
                </html>
            ";

            return new ContentResult
            {
                Content = data,
                ContentType = "text/html",
                StatusCode = 200
            };
        }

        [HttpGet]
        [Route("/signalr.js")]
        public IActionResult JavascriptSignalr()
        {
            try
            {
                var stringPayload = @"KGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsZmFjdG9yeSl7aWYodHlwZW9mIGV4cG9ydHM9PT0ib2JqZWN0IiYmdHlwZW9mIG1vZHVsZT09PSJvYmplY3QiKW1vZHVsZS5leHBvcnRzPWZhY3RvcnkoKTtlbHNlIGlmKHR5cGVvZiBkZWZpbmU9PT0iZnVuY3Rpb24iJiZkZWZpbmUuYW1kKWRlZmluZShbXSxmYWN0b3J5KTtlbHNlIGlmKHR5cGVvZiBleHBvcnRzPT09Im9iamVjdCIpZXhwb3J0c1sic2lnbmFsUiJdPWZhY3RvcnkoKTtlbHNlIHJvb3RbInNpZ25hbFIiXT1mYWN0b3J5KCl9KSh3aW5kb3csZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24obW9kdWxlcyl7dmFyIGluc3RhbGxlZE1vZHVsZXM9e307ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCl7aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pe3JldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzfXZhciBtb2R1bGU9aW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF09e2k6bW9kdWxlSWQsbDpmYWxzZSxleHBvcnRzOnt9fTttb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLG1vZHVsZSxtb2R1bGUuZXhwb3J0cyxfX3dlYnBhY2tfcmVxdWlyZV9fKTttb2R1bGUubD10cnVlO3JldHVybiBtb2R1bGUuZXhwb3J0c31fX3dlYnBhY2tfcmVxdWlyZV9fLm09bW9kdWxlcztfX3dlYnBhY2tfcmVxdWlyZV9fLmM9aW5zdGFsbGVkTW9kdWxlcztfX3dlYnBhY2tfcmVxdWlyZV9fLmQ9ZnVuY3Rpb24oZXhwb3J0cyxuYW1lLGdldHRlcil7aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLG5hbWUpKXtPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cyxuYW1lLHtlbnVtZXJhYmxlOnRydWUsZ2V0OmdldHRlcn0pfX07X193ZWJwYWNrX3JlcXVpcmVfXy5yPWZ1bmN0aW9uKGV4cG9ydHMpe2lmKHR5cGVvZiBTeW1ib2whPT0idW5kZWZpbmVkIiYmU3ltYm9sLnRvU3RyaW5nVGFnKXtPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cyxTeW1ib2wudG9TdHJpbmdUYWcse3ZhbHVlOiJNb2R1bGUifSl9T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIl9fZXNNb2R1bGUiLHt2YWx1ZTp0cnVlfSl9O19fd2VicGFja19yZXF1aXJlX18udD1mdW5jdGlvbih2YWx1ZSxtb2RlKXtpZihtb2RlJjEpdmFsdWU9X193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7aWYobW9kZSY4KXJldHVybiB2YWx1ZTtpZihtb2RlJjQmJnR5cGVvZiB2YWx1ZT09PSJvYmplY3QiJiZ2YWx1ZSYmdmFsdWUuX19lc01vZHVsZSlyZXR1cm4gdmFsdWU7dmFyIG5zPU9iamVjdC5jcmVhdGUobnVsbCk7X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsImRlZmF1bHQiLHtlbnVtZXJhYmxlOnRydWUsdmFsdWU6dmFsdWV9KTtpZihtb2RlJjImJnR5cGVvZiB2YWx1ZSE9InN0cmluZyIpZm9yKHZhciBrZXkgaW4gdmFsdWUpX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLGtleSxmdW5jdGlvbihrZXkpe3JldHVybiB2YWx1ZVtrZXldfS5iaW5kKG51bGwsa2V5KSk7cmV0dXJuIG5zfTtfX3dlYnBhY2tfcmVxdWlyZV9fLm49ZnVuY3Rpb24obW9kdWxlKXt2YXIgZ2V0dGVyPW1vZHVsZSYmbW9kdWxlLl9fZXNNb2R1bGU/ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpe3JldHVybiBtb2R1bGVbImRlZmF1bHQiXX06ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpe3JldHVybiBtb2R1bGV9O19fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsImEiLGdldHRlcik7cmV0dXJuIGdldHRlcn07X193ZWJwYWNrX3JlcXVpcmVfXy5vPWZ1bmN0aW9uKG9iamVjdCxwcm9wZXJ0eSl7cmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QscHJvcGVydHkpfTtfX3dlYnBhY2tfcmVxdWlyZV9fLnA9IiI7cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zPTApfShbZnVuY3Rpb24obW9kdWxlLF9fd2VicGFja19leHBvcnRzX18sX193ZWJwYWNrX3JlcXVpcmVfXyl7InVzZSBzdHJpY3QiO19fd2VicGFja19yZXF1aXJlX18ucihfX3dlYnBhY2tfZXhwb3J0c19fKTt2YXIgZXM2X3Byb21pc2VfZGlzdF9lczZfcHJvbWlzZV9hdXRvX2pzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX189X193ZWJwYWNrX3JlcXVpcmVfXygxKTt2YXIgZXM2X3Byb21pc2VfZGlzdF9lczZfcHJvbWlzZV9hdXRvX2pzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19fZGVmYXVsdD1fX3dlYnBhY2tfcmVxdWlyZV9fLm4oZXM2X3Byb21pc2VfZGlzdF9lczZfcHJvbWlzZV9hdXRvX2pzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX18pO3ZhciBfaW5kZXhfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfXz1fX3dlYnBhY2tfcmVxdWlyZV9fKDMpO19fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCJBYm9ydEVycm9yIixmdW5jdGlvbigpe3JldHVybiBfaW5kZXhfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siQWJvcnRFcnJvciJdfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIkh0dHBFcnJvciIsZnVuY3Rpb24oKXtyZXR1cm4gX2luZGV4X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIkh0dHBFcnJvciJdfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIlRpbWVvdXRFcnJvciIsZnVuY3Rpb24oKXtyZXR1cm4gX2luZGV4X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIlRpbWVvdXRFcnJvciJdfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIkh0dHBDbGllbnQiLGZ1bmN0aW9uKCl7cmV0dXJuIF9pbmRleF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJIdHRwQ2xpZW50Il19KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiSHR0cFJlc3BvbnNlIixmdW5jdGlvbigpe3JldHVybiBfaW5kZXhfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siSHR0cFJlc3BvbnNlIl19KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiRGVmYXVsdEh0dHBDbGllbnQiLGZ1bmN0aW9uKCl7cmV0dXJuIF9pbmRleF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJEZWZhdWx0SHR0cENsaWVudCJdfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIkh1YkNvbm5lY3Rpb24iLGZ1bmN0aW9uKCl7cmV0dXJuIF9pbmRleF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJIdWJDb25uZWN0aW9uIl19KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiSHViQ29ubmVjdGlvblN0YXRlIixmdW5jdGlvbigpe3JldHVybiBfaW5kZXhfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siSHViQ29ubmVjdGlvblN0YXRlIl19KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiSHViQ29ubmVjdGlvbkJ1aWxkZXIiLGZ1bmN0aW9uKCl7cmV0dXJuIF9pbmRleF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJIdWJDb25uZWN0aW9uQnVpbGRlciJdfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIk1lc3NhZ2VUeXBlIixmdW5jdGlvbigpe3JldHVybiBfaW5kZXhfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siTWVzc2FnZVR5cGUiXX0pO19fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCJMb2dMZXZlbCIsZnVuY3Rpb24oKXtyZXR1cm4gX2luZGV4X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIkxvZ0xldmVsIl19KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiSHR0cFRyYW5zcG9ydFR5cGUiLGZ1bmN0aW9uKCl7cmV0dXJuIF9pbmRleF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJIdHRwVHJhbnNwb3J0VHlwZSJdfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIlRyYW5zZmVyRm9ybWF0IixmdW5jdGlvbigpe3JldHVybiBfaW5kZXhfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siVHJhbnNmZXJGb3JtYXQiXX0pO19fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCJOdWxsTG9nZ2VyIixmdW5jdGlvbigpe3JldHVybiBfaW5kZXhfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siTnVsbExvZ2dlciJdfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIkpzb25IdWJQcm90b2NvbCIsZnVuY3Rpb24oKXtyZXR1cm4gX2luZGV4X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIkpzb25IdWJQcm90b2NvbCJdfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIlN1YmplY3QiLGZ1bmN0aW9uKCl7cmV0dXJuIF9pbmRleF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJTdWJqZWN0Il19KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiVkVSU0lPTiIsZnVuY3Rpb24oKXtyZXR1cm4gX2luZGV4X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIlZFUlNJT04iXX0pO2lmKCFVaW50OEFycmF5LnByb3RvdHlwZS5pbmRleE9mKXtPYmplY3QuZGVmaW5lUHJvcGVydHkoVWludDhBcnJheS5wcm90b3R5cGUsImluZGV4T2YiLHt2YWx1ZTpBcnJheS5wcm90b3R5cGUuaW5kZXhPZix3cml0YWJsZTp0cnVlfSl9aWYoIVVpbnQ4QXJyYXkucHJvdG90eXBlLnNsaWNlKXtPYmplY3QuZGVmaW5lUHJvcGVydHkoVWludDhBcnJheS5wcm90b3R5cGUsInNsaWNlIix7dmFsdWU6ZnVuY3Rpb24oc3RhcnQsZW5kKXtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwodGhpcyxzdGFydCxlbmQpKX0sd3JpdGFibGU6dHJ1ZX0pfWlmKCFVaW50OEFycmF5LnByb3RvdHlwZS5mb3JFYWNoKXtPYmplY3QuZGVmaW5lUHJvcGVydHkoVWludDhBcnJheS5wcm90b3R5cGUsImZvckVhY2giLHt2YWx1ZTpBcnJheS5wcm90b3R5cGUuZm9yRWFjaCx3cml0YWJsZTp0cnVlfSl9fSxmdW5jdGlvbihtb2R1bGUsZXhwb3J0cyxfX3dlYnBhY2tfcmVxdWlyZV9fKXsoZnVuY3Rpb24oZ2xvYmFsKXt2YXIgcmVxdWlyZTsKLyohCiAqIEBvdmVydmlldyBlczYtcHJvbWlzZSAtIGEgdGlueSBpbXBsZW1lbnRhdGlvbiBvZiBQcm9taXNlcy9BKy4KICogQGNvcHlyaWdodCBDb3B5cmlnaHQgKGMpIDIwMTQgWWVodWRhIEthdHosIFRvbSBEYWxlLCBTdGVmYW4gUGVubmVyIGFuZCBjb250cmlidXRvcnMgKENvbnZlcnNpb24gdG8gRVM2IEFQSSBieSBKYWtlIEFyY2hpYmFsZCkKICogQGxpY2Vuc2UgICBMaWNlbnNlZCB1bmRlciBNSVQgbGljZW5zZQogKiAgICAgICAgICAgIFNlZSBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vc3RlZmFucGVubmVyL2VzNi1wcm9taXNlL21hc3Rlci9MSUNFTlNFCiAqIEB2ZXJzaW9uICAgdjQuMi4yKzk3NDc4ZWI2CiAqLwovKiEKICogQG92ZXJ2aWV3IGVzNi1wcm9taXNlIC0gYSB0aW55IGltcGxlbWVudGF0aW9uIG9mIFByb21pc2VzL0ErLgogKiBAY29weXJpZ2h0IENvcHlyaWdodCAoYykgMjAxNCBZZWh1ZGEgS2F0eiwgVG9tIERhbGUsIFN0ZWZhbiBQZW5uZXIgYW5kIGNvbnRyaWJ1dG9ycyAoQ29udmVyc2lvbiB0byBFUzYgQVBJIGJ5IEpha2UgQXJjaGliYWxkKQogKiBAbGljZW5zZSAgIExpY2Vuc2VkIHVuZGVyIE1JVCBsaWNlbnNlCiAqICAgICAgICAgICAgU2VlIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9zdGVmYW5wZW5uZXIvZXM2LXByb21pc2UvbWFzdGVyL0xJQ0VOU0UKICogQHZlcnNpb24gICB2NC4yLjIrOTc0NzhlYjYKICovCihmdW5jdGlvbihnbG9iYWwsZmFjdG9yeSl7dHJ1ZT9tb2R1bGUuZXhwb3J0cz1mYWN0b3J5KCk6dW5kZWZpbmVkfSkodGhpcyxmdW5jdGlvbigpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBvYmplY3RPckZ1bmN0aW9uKHgpe3ZhciB0eXBlPXR5cGVvZiB4O3JldHVybiB4IT09bnVsbCYmKHR5cGU9PT0ib2JqZWN0Inx8dHlwZT09PSJmdW5jdGlvbiIpfWZ1bmN0aW9uIGlzRnVuY3Rpb24oeCl7cmV0dXJuIHR5cGVvZiB4PT09ImZ1bmN0aW9uIn12YXIgX2lzQXJyYXk9dm9pZCAwO2lmKEFycmF5LmlzQXJyYXkpe19pc0FycmF5PUFycmF5LmlzQXJyYXl9ZWxzZXtfaXNBcnJheT1mdW5jdGlvbih4KXtyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHgpPT09IltvYmplY3QgQXJyYXldIn19dmFyIGlzQXJyYXk9X2lzQXJyYXk7dmFyIGxlbj0wO3ZhciB2ZXJ0eE5leHQ9dm9pZCAwO3ZhciBjdXN0b21TY2hlZHVsZXJGbj12b2lkIDA7dmFyIGFzYXA9ZnVuY3Rpb24gYXNhcChjYWxsYmFjayxhcmcpe3F1ZXVlW2xlbl09Y2FsbGJhY2s7cXVldWVbbGVuKzFdPWFyZztsZW4rPTI7aWYobGVuPT09Mil7aWYoY3VzdG9tU2NoZWR1bGVyRm4pe2N1c3RvbVNjaGVkdWxlckZuKGZsdXNoKX1lbHNle3NjaGVkdWxlRmx1c2goKX19fTtmdW5jdGlvbiBzZXRTY2hlZHVsZXIoc2NoZWR1bGVGbil7Y3VzdG9tU2NoZWR1bGVyRm49c2NoZWR1bGVGbn1mdW5jdGlvbiBzZXRBc2FwKGFzYXBGbil7YXNhcD1hc2FwRm59dmFyIGJyb3dzZXJXaW5kb3c9dHlwZW9mIHdpbmRvdyE9PSJ1bmRlZmluZWQiP3dpbmRvdzp1bmRlZmluZWQ7dmFyIGJyb3dzZXJHbG9iYWw9YnJvd3NlcldpbmRvd3x8e307dmFyIEJyb3dzZXJNdXRhdGlvbk9ic2VydmVyPWJyb3dzZXJHbG9iYWwuTXV0YXRpb25PYnNlcnZlcnx8YnJvd3Nlckdsb2JhbC5XZWJLaXRNdXRhdGlvbk9ic2VydmVyO3ZhciBpc05vZGU9dHlwZW9mIHNlbGY9PT0idW5kZWZpbmVkIiYmdHlwZW9mIHByb2Nlc3MhPT0idW5kZWZpbmVkIiYme30udG9TdHJpbmcuY2FsbChwcm9jZXNzKT09PSJbb2JqZWN0IHByb2Nlc3NdIjt2YXIgaXNXb3JrZXI9dHlwZW9mIFVpbnQ4Q2xhbXBlZEFycmF5IT09InVuZGVmaW5lZCImJnR5cGVvZiBpbXBvcnRTY3JpcHRzIT09InVuZGVmaW5lZCImJnR5cGVvZiBNZXNzYWdlQ2hhbm5lbCE9PSJ1bmRlZmluZWQiO2Z1bmN0aW9uIHVzZU5leHRUaWNrKCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHByb2Nlc3MubmV4dFRpY2soZmx1c2gpfX1mdW5jdGlvbiB1c2VWZXJ0eFRpbWVyKCl7aWYodHlwZW9mIHZlcnR4TmV4dCE9PSJ1bmRlZmluZWQiKXtyZXR1cm4gZnVuY3Rpb24oKXt2ZXJ0eE5leHQoZmx1c2gpfX1yZXR1cm4gdXNlU2V0VGltZW91dCgpfWZ1bmN0aW9uIHVzZU11dGF0aW9uT2JzZXJ2ZXIoKXt2YXIgaXRlcmF0aW9ucz0wO3ZhciBvYnNlcnZlcj1uZXcgQnJvd3Nlck11dGF0aW9uT2JzZXJ2ZXIoZmx1c2gpO3ZhciBub2RlPWRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCIiKTtvYnNlcnZlci5vYnNlcnZlKG5vZGUse2NoYXJhY3RlckRhdGE6dHJ1ZX0pO3JldHVybiBmdW5jdGlvbigpe25vZGUuZGF0YT1pdGVyYXRpb25zPSsraXRlcmF0aW9ucyUyfX1mdW5jdGlvbiB1c2VNZXNzYWdlQ2hhbm5lbCgpe3ZhciBjaGFubmVsPW5ldyBNZXNzYWdlQ2hhbm5lbDtjaGFubmVsLnBvcnQxLm9ubWVzc2FnZT1mbHVzaDtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gY2hhbm5lbC5wb3J0Mi5wb3N0TWVzc2FnZSgwKX19ZnVuY3Rpb24gdXNlU2V0VGltZW91dCgpe3ZhciBnbG9iYWxTZXRUaW1lb3V0PXNldFRpbWVvdXQ7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGdsb2JhbFNldFRpbWVvdXQoZmx1c2gsMSl9fXZhciBxdWV1ZT1uZXcgQXJyYXkoMWUzKTtmdW5jdGlvbiBmbHVzaCgpe2Zvcih2YXIgaT0wO2k8bGVuO2krPTIpe3ZhciBjYWxsYmFjaz1xdWV1ZVtpXTt2YXIgYXJnPXF1ZXVlW2krMV07Y2FsbGJhY2soYXJnKTtxdWV1ZVtpXT11bmRlZmluZWQ7cXVldWVbaSsxXT11bmRlZmluZWR9bGVuPTB9ZnVuY3Rpb24gYXR0ZW1wdFZlcnR4KCl7dHJ5e3ZhciByPXJlcXVpcmU7dmFyIHZlcnR4PV9fd2VicGFja19yZXF1aXJlX18oIWZ1bmN0aW9uIHdlYnBhY2tNaXNzaW5nTW9kdWxlKCl7dmFyIGU9bmV3IEVycm9yKCJDYW5ub3QgZmluZCBtb2R1bGUgJ3ZlcnR4JyIpO2UuY29kZT0iTU9EVUxFX05PVF9GT1VORCI7dGhyb3cgZX0oKSk7dmVydHhOZXh0PXZlcnR4LnJ1bk9uTG9vcHx8dmVydHgucnVuT25Db250ZXh0O3JldHVybiB1c2VWZXJ0eFRpbWVyKCl9Y2F0Y2goZSl7cmV0dXJuIHVzZVNldFRpbWVvdXQoKX19dmFyIHNjaGVkdWxlRmx1c2g9dm9pZCAwO2lmKGlzTm9kZSl7c2NoZWR1bGVGbHVzaD11c2VOZXh0VGljaygpfWVsc2UgaWYoQnJvd3Nlck11dGF0aW9uT2JzZXJ2ZXIpe3NjaGVkdWxlRmx1c2g9dXNlTXV0YXRpb25PYnNlcnZlcigpfWVsc2UgaWYoaXNXb3JrZXIpe3NjaGVkdWxlRmx1c2g9dXNlTWVzc2FnZUNoYW5uZWwoKX1lbHNlIGlmKGJyb3dzZXJXaW5kb3c9PT11bmRlZmluZWQmJiJmdW5jdGlvbiI9PT0iZnVuY3Rpb24iKXtzY2hlZHVsZUZsdXNoPWF0dGVtcHRWZXJ0eCgpfWVsc2V7c2NoZWR1bGVGbHVzaD11c2VTZXRUaW1lb3V0KCl9ZnVuY3Rpb24gdGhlbihvbkZ1bGZpbGxtZW50LG9uUmVqZWN0aW9uKXt2YXIgcGFyZW50PXRoaXM7dmFyIGNoaWxkPW5ldyB0aGlzLmNvbnN0cnVjdG9yKG5vb3ApO2lmKGNoaWxkW1BST01JU0VfSURdPT09dW5kZWZpbmVkKXttYWtlUHJvbWlzZShjaGlsZCl9dmFyIF9zdGF0ZT1wYXJlbnQuX3N0YXRlO2lmKF9zdGF0ZSl7dmFyIGNhbGxiYWNrPWFyZ3VtZW50c1tfc3RhdGUtMV07YXNhcChmdW5jdGlvbigpe3JldHVybiBpbnZva2VDYWxsYmFjayhfc3RhdGUsY2hpbGQsY2FsbGJhY2sscGFyZW50Ll9yZXN1bHQpfSl9ZWxzZXtzdWJzY3JpYmUocGFyZW50LGNoaWxkLG9uRnVsZmlsbG1lbnQsb25SZWplY3Rpb24pfXJldHVybiBjaGlsZH1mdW5jdGlvbiByZXNvbHZlJDEob2JqZWN0KXt2YXIgQ29uc3RydWN0b3I9dGhpcztpZihvYmplY3QmJnR5cGVvZiBvYmplY3Q9PT0ib2JqZWN0IiYmb2JqZWN0LmNvbnN0cnVjdG9yPT09Q29uc3RydWN0b3Ipe3JldHVybiBvYmplY3R9dmFyIHByb21pc2U9bmV3IENvbnN0cnVjdG9yKG5vb3ApO3Jlc29sdmUocHJvbWlzZSxvYmplY3QpO3JldHVybiBwcm9taXNlfXZhciBQUk9NSVNFX0lEPU1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygxNik7ZnVuY3Rpb24gbm9vcCgpe312YXIgUEVORElORz12b2lkIDA7dmFyIEZVTEZJTExFRD0xO3ZhciBSRUpFQ1RFRD0yO3ZhciBHRVRfVEhFTl9FUlJPUj1uZXcgRXJyb3JPYmplY3Q7ZnVuY3Rpb24gc2VsZkZ1bGZpbGxtZW50KCl7cmV0dXJuIG5ldyBUeXBlRXJyb3IoIllvdSBjYW5ub3QgcmVzb2x2ZSBhIHByb21pc2Ugd2l0aCBpdHNlbGYiKX1mdW5jdGlvbiBjYW5ub3RSZXR1cm5Pd24oKXtyZXR1cm4gbmV3IFR5cGVFcnJvcigiQSBwcm9taXNlcyBjYWxsYmFjayBjYW5ub3QgcmV0dXJuIHRoYXQgc2FtZSBwcm9taXNlLiIpfWZ1bmN0aW9uIGdldFRoZW4ocHJvbWlzZSl7dHJ5e3JldHVybiBwcm9taXNlLnRoZW59Y2F0Y2goZXJyb3Ipe0dFVF9USEVOX0VSUk9SLmVycm9yPWVycm9yO3JldHVybiBHRVRfVEhFTl9FUlJPUn19ZnVuY3Rpb24gdHJ5VGhlbih0aGVuJCQxLHZhbHVlLGZ1bGZpbGxtZW50SGFuZGxlcixyZWplY3Rpb25IYW5kbGVyKXt0cnl7dGhlbiQkMS5jYWxsKHZhbHVlLGZ1bGZpbGxtZW50SGFuZGxlcixyZWplY3Rpb25IYW5kbGVyKX1jYXRjaChlKXtyZXR1cm4gZX19ZnVuY3Rpb24gaGFuZGxlRm9yZWlnblRoZW5hYmxlKHByb21pc2UsdGhlbmFibGUsdGhlbiQkMSl7YXNhcChmdW5jdGlvbihwcm9taXNlKXt2YXIgc2VhbGVkPWZhbHNlO3ZhciBlcnJvcj10cnlUaGVuKHRoZW4kJDEsdGhlbmFibGUsZnVuY3Rpb24odmFsdWUpe2lmKHNlYWxlZCl7cmV0dXJufXNlYWxlZD10cnVlO2lmKHRoZW5hYmxlIT09dmFsdWUpe3Jlc29sdmUocHJvbWlzZSx2YWx1ZSl9ZWxzZXtmdWxmaWxsKHByb21pc2UsdmFsdWUpfX0sZnVuY3Rpb24ocmVhc29uKXtpZihzZWFsZWQpe3JldHVybn1zZWFsZWQ9dHJ1ZTtyZWplY3QocHJvbWlzZSxyZWFzb24pfSwiU2V0dGxlOiAiKyhwcm9taXNlLl9sYWJlbHx8IiB1bmtub3duIHByb21pc2UiKSk7aWYoIXNlYWxlZCYmZXJyb3Ipe3NlYWxlZD10cnVlO3JlamVjdChwcm9taXNlLGVycm9yKX19LHByb21pc2UpfWZ1bmN0aW9uIGhhbmRsZU93blRoZW5hYmxlKHByb21pc2UsdGhlbmFibGUpe2lmKHRoZW5hYmxlLl9zdGF0ZT09PUZVTEZJTExFRCl7ZnVsZmlsbChwcm9taXNlLHRoZW5hYmxlLl9yZXN1bHQpfWVsc2UgaWYodGhlbmFibGUuX3N0YXRlPT09UkVKRUNURUQpe3JlamVjdChwcm9taXNlLHRoZW5hYmxlLl9yZXN1bHQpfWVsc2V7c3Vic2NyaWJlKHRoZW5hYmxlLHVuZGVmaW5lZCxmdW5jdGlvbih2YWx1ZSl7cmV0dXJuIHJlc29sdmUocHJvbWlzZSx2YWx1ZSl9LGZ1bmN0aW9uKHJlYXNvbil7cmV0dXJuIHJlamVjdChwcm9taXNlLHJlYXNvbil9KX19ZnVuY3Rpb24gaGFuZGxlTWF5YmVUaGVuYWJsZShwcm9taXNlLG1heWJlVGhlbmFibGUsdGhlbiQkMSl7aWYobWF5YmVUaGVuYWJsZS5jb25zdHJ1Y3Rvcj09PXByb21pc2UuY29uc3RydWN0b3ImJnRoZW4kJDE9PT10aGVuJiZtYXliZVRoZW5hYmxlLmNvbnN0cnVjdG9yLnJlc29sdmU9PT1yZXNvbHZlJDEpe2hhbmRsZU93blRoZW5hYmxlKHByb21pc2UsbWF5YmVUaGVuYWJsZSl9ZWxzZXtpZih0aGVuJCQxPT09R0VUX1RIRU5fRVJST1Ipe3JlamVjdChwcm9taXNlLEdFVF9USEVOX0VSUk9SLmVycm9yKTtHRVRfVEhFTl9FUlJPUi5lcnJvcj1udWxsfWVsc2UgaWYodGhlbiQkMT09PXVuZGVmaW5lZCl7ZnVsZmlsbChwcm9taXNlLG1heWJlVGhlbmFibGUpfWVsc2UgaWYoaXNGdW5jdGlvbih0aGVuJCQxKSl7aGFuZGxlRm9yZWlnblRoZW5hYmxlKHByb21pc2UsbWF5YmVUaGVuYWJsZSx0aGVuJCQxKX1lbHNle2Z1bGZpbGwocHJvbWlzZSxtYXliZVRoZW5hYmxlKX19fWZ1bmN0aW9uIHJlc29sdmUocHJvbWlzZSx2YWx1ZSl7aWYocHJvbWlzZT09PXZhbHVlKXtyZWplY3QocHJvbWlzZSxzZWxmRnVsZmlsbG1lbnQoKSl9ZWxzZSBpZihvYmplY3RPckZ1bmN0aW9uKHZhbHVlKSl7aGFuZGxlTWF5YmVUaGVuYWJsZShwcm9taXNlLHZhbHVlLGdldFRoZW4odmFsdWUpKX1lbHNle2Z1bGZpbGwocHJvbWlzZSx2YWx1ZSl9fWZ1bmN0aW9uIHB1Ymxpc2hSZWplY3Rpb24ocHJvbWlzZSl7aWYocHJvbWlzZS5fb25lcnJvcil7cHJvbWlzZS5fb25lcnJvcihwcm9taXNlLl9yZXN1bHQpfXB1Ymxpc2gocHJvbWlzZSl9ZnVuY3Rpb24gZnVsZmlsbChwcm9taXNlLHZhbHVlKXtpZihwcm9taXNlLl9zdGF0ZSE9PVBFTkRJTkcpe3JldHVybn1wcm9taXNlLl9yZXN1bHQ9dmFsdWU7cHJvbWlzZS5fc3RhdGU9RlVMRklMTEVEO2lmKHByb21pc2UuX3N1YnNjcmliZXJzLmxlbmd0aCE9PTApe2FzYXAocHVibGlzaCxwcm9taXNlKX19ZnVuY3Rpb24gcmVqZWN0KHByb21pc2UscmVhc29uKXtpZihwcm9taXNlLl9zdGF0ZSE9PVBFTkRJTkcpe3JldHVybn1wcm9taXNlLl9zdGF0ZT1SRUpFQ1RFRDtwcm9taXNlLl9yZXN1bHQ9cmVhc29uO2FzYXAocHVibGlzaFJlamVjdGlvbixwcm9taXNlKX1mdW5jdGlvbiBzdWJzY3JpYmUocGFyZW50LGNoaWxkLG9uRnVsZmlsbG1lbnQsb25SZWplY3Rpb24pe3ZhciBfc3Vic2NyaWJlcnM9cGFyZW50Ll9zdWJzY3JpYmVyczt2YXIgbGVuZ3RoPV9zdWJzY3JpYmVycy5sZW5ndGg7cGFyZW50Ll9vbmVycm9yPW51bGw7X3N1YnNjcmliZXJzW2xlbmd0aF09Y2hpbGQ7X3N1YnNjcmliZXJzW2xlbmd0aCtGVUxGSUxMRURdPW9uRnVsZmlsbG1lbnQ7X3N1YnNjcmliZXJzW2xlbmd0aCtSRUpFQ1RFRF09b25SZWplY3Rpb247aWYobGVuZ3RoPT09MCYmcGFyZW50Ll9zdGF0ZSl7YXNhcChwdWJsaXNoLHBhcmVudCl9fWZ1bmN0aW9uIHB1Ymxpc2gocHJvbWlzZSl7dmFyIHN1YnNjcmliZXJzPXByb21pc2UuX3N1YnNjcmliZXJzO3ZhciBzZXR0bGVkPXByb21pc2UuX3N0YXRlO2lmKHN1YnNjcmliZXJzLmxlbmd0aD09PTApe3JldHVybn12YXIgY2hpbGQ9dm9pZCAwLGNhbGxiYWNrPXZvaWQgMCxkZXRhaWw9cHJvbWlzZS5fcmVzdWx0O2Zvcih2YXIgaT0wO2k8c3Vic2NyaWJlcnMubGVuZ3RoO2krPTMpe2NoaWxkPXN1YnNjcmliZXJzW2ldO2NhbGxiYWNrPXN1YnNjcmliZXJzW2krc2V0dGxlZF07aWYoY2hpbGQpe2ludm9rZUNhbGxiYWNrKHNldHRsZWQsY2hpbGQsY2FsbGJhY2ssZGV0YWlsKX1lbHNle2NhbGxiYWNrKGRldGFpbCl9fXByb21pc2UuX3N1YnNjcmliZXJzLmxlbmd0aD0wfWZ1bmN0aW9uIEVycm9yT2JqZWN0KCl7dGhpcy5lcnJvcj1udWxsfXZhciBUUllfQ0FUQ0hfRVJST1I9bmV3IEVycm9yT2JqZWN0O2Z1bmN0aW9uIHRyeUNhdGNoKGNhbGxiYWNrLGRldGFpbCl7dHJ5e3JldHVybiBjYWxsYmFjayhkZXRhaWwpfWNhdGNoKGUpe1RSWV9DQVRDSF9FUlJPUi5lcnJvcj1lO3JldHVybiBUUllfQ0FUQ0hfRVJST1J9fWZ1bmN0aW9uIGludm9rZUNhbGxiYWNrKHNldHRsZWQscHJvbWlzZSxjYWxsYmFjayxkZXRhaWwpe3ZhciBoYXNDYWxsYmFjaz1pc0Z1bmN0aW9uKGNhbGxiYWNrKSx2YWx1ZT12b2lkIDAsZXJyb3I9dm9pZCAwLHN1Y2NlZWRlZD12b2lkIDAsZmFpbGVkPXZvaWQgMDtpZihoYXNDYWxsYmFjayl7dmFsdWU9dHJ5Q2F0Y2goY2FsbGJhY2ssZGV0YWlsKTtpZih2YWx1ZT09PVRSWV9DQVRDSF9FUlJPUil7ZmFpbGVkPXRydWU7ZXJyb3I9dmFsdWUuZXJyb3I7dmFsdWUuZXJyb3I9bnVsbH1lbHNle3N1Y2NlZWRlZD10cnVlfWlmKHByb21pc2U9PT12YWx1ZSl7cmVqZWN0KHByb21pc2UsY2Fubm90UmV0dXJuT3duKCkpO3JldHVybn19ZWxzZXt2YWx1ZT1kZXRhaWw7c3VjY2VlZGVkPXRydWV9aWYocHJvbWlzZS5fc3RhdGUhPT1QRU5ESU5HKXt9ZWxzZSBpZihoYXNDYWxsYmFjayYmc3VjY2VlZGVkKXtyZXNvbHZlKHByb21pc2UsdmFsdWUpfWVsc2UgaWYoZmFpbGVkKXtyZWplY3QocHJvbWlzZSxlcnJvcil9ZWxzZSBpZihzZXR0bGVkPT09RlVMRklMTEVEKXtmdWxmaWxsKHByb21pc2UsdmFsdWUpfWVsc2UgaWYoc2V0dGxlZD09PVJFSkVDVEVEKXtyZWplY3QocHJvbWlzZSx2YWx1ZSl9fWZ1bmN0aW9uIGluaXRpYWxpemVQcm9taXNlKHByb21pc2UscmVzb2x2ZXIpe3RyeXtyZXNvbHZlcihmdW5jdGlvbiByZXNvbHZlUHJvbWlzZSh2YWx1ZSl7cmVzb2x2ZShwcm9taXNlLHZhbHVlKX0sZnVuY3Rpb24gcmVqZWN0UHJvbWlzZShyZWFzb24pe3JlamVjdChwcm9taXNlLHJlYXNvbil9KX1jYXRjaChlKXtyZWplY3QocHJvbWlzZSxlKX19dmFyIGlkPTA7ZnVuY3Rpb24gbmV4dElkKCl7cmV0dXJuIGlkKyt9ZnVuY3Rpb24gbWFrZVByb21pc2UocHJvbWlzZSl7cHJvbWlzZVtQUk9NSVNFX0lEXT1pZCsrO3Byb21pc2UuX3N0YXRlPXVuZGVmaW5lZDtwcm9taXNlLl9yZXN1bHQ9dW5kZWZpbmVkO3Byb21pc2UuX3N1YnNjcmliZXJzPVtdfWZ1bmN0aW9uIHZhbGlkYXRpb25FcnJvcigpe3JldHVybiBuZXcgRXJyb3IoIkFycmF5IE1ldGhvZHMgbXVzdCBiZSBwcm92aWRlZCBhbiBBcnJheSIpfWZ1bmN0aW9uIHZhbGlkYXRpb25FcnJvcigpe3JldHVybiBuZXcgRXJyb3IoIkFycmF5IE1ldGhvZHMgbXVzdCBiZSBwcm92aWRlZCBhbiBBcnJheSIpfXZhciBFbnVtZXJhdG9yPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gRW51bWVyYXRvcihDb25zdHJ1Y3RvcixpbnB1dCl7dGhpcy5faW5zdGFuY2VDb25zdHJ1Y3Rvcj1Db25zdHJ1Y3Rvcjt0aGlzLnByb21pc2U9bmV3IENvbnN0cnVjdG9yKG5vb3ApO2lmKCF0aGlzLnByb21pc2VbUFJPTUlTRV9JRF0pe21ha2VQcm9taXNlKHRoaXMucHJvbWlzZSl9aWYoaXNBcnJheShpbnB1dCkpe3RoaXMubGVuZ3RoPWlucHV0Lmxlbmd0aDt0aGlzLl9yZW1haW5pbmc9aW5wdXQubGVuZ3RoO3RoaXMuX3Jlc3VsdD1uZXcgQXJyYXkodGhpcy5sZW5ndGgpO2lmKHRoaXMubGVuZ3RoPT09MCl7ZnVsZmlsbCh0aGlzLnByb21pc2UsdGhpcy5fcmVzdWx0KX1lbHNle3RoaXMubGVuZ3RoPXRoaXMubGVuZ3RofHwwO3RoaXMuX2VudW1lcmF0ZShpbnB1dCk7aWYodGhpcy5fcmVtYWluaW5nPT09MCl7ZnVsZmlsbCh0aGlzLnByb21pc2UsdGhpcy5fcmVzdWx0KX19fWVsc2V7cmVqZWN0KHRoaXMucHJvbWlzZSx2YWxpZGF0aW9uRXJyb3IoKSl9fUVudW1lcmF0b3IucHJvdG90eXBlLl9lbnVtZXJhdGU9ZnVuY3Rpb24gX2VudW1lcmF0ZShpbnB1dCl7Zm9yKHZhciBpPTA7dGhpcy5fc3RhdGU9PT1QRU5ESU5HJiZpPGlucHV0Lmxlbmd0aDtpKyspe3RoaXMuX2VhY2hFbnRyeShpbnB1dFtpXSxpKX19O0VudW1lcmF0b3IucHJvdG90eXBlLl9lYWNoRW50cnk9ZnVuY3Rpb24gX2VhY2hFbnRyeShlbnRyeSxpKXt2YXIgYz10aGlzLl9pbnN0YW5jZUNvbnN0cnVjdG9yO3ZhciByZXNvbHZlJCQxPWMucmVzb2x2ZTtpZihyZXNvbHZlJCQxPT09cmVzb2x2ZSQxKXt2YXIgX3RoZW49Z2V0VGhlbihlbnRyeSk7aWYoX3RoZW49PT10aGVuJiZlbnRyeS5fc3RhdGUhPT1QRU5ESU5HKXt0aGlzLl9zZXR0bGVkQXQoZW50cnkuX3N0YXRlLGksZW50cnkuX3Jlc3VsdCl9ZWxzZSBpZih0eXBlb2YgX3RoZW4hPT0iZnVuY3Rpb24iKXt0aGlzLl9yZW1haW5pbmctLTt0aGlzLl9yZXN1bHRbaV09ZW50cnl9ZWxzZSBpZihjPT09UHJvbWlzZSQyKXt2YXIgcHJvbWlzZT1uZXcgYyhub29wKTtoYW5kbGVNYXliZVRoZW5hYmxlKHByb21pc2UsZW50cnksX3RoZW4pO3RoaXMuX3dpbGxTZXR0bGVBdChwcm9taXNlLGkpfWVsc2V7dGhpcy5fd2lsbFNldHRsZUF0KG5ldyBjKGZ1bmN0aW9uKHJlc29sdmUkJDEpe3JldHVybiByZXNvbHZlJCQxKGVudHJ5KX0pLGkpfX1lbHNle3RoaXMuX3dpbGxTZXR0bGVBdChyZXNvbHZlJCQxKGVudHJ5KSxpKX19O0VudW1lcmF0b3IucHJvdG90eXBlLl9zZXR0bGVkQXQ9ZnVuY3Rpb24gX3NldHRsZWRBdChzdGF0ZSxpLHZhbHVlKXt2YXIgcHJvbWlzZT10aGlzLnByb21pc2U7aWYocHJvbWlzZS5fc3RhdGU9PT1QRU5ESU5HKXt0aGlzLl9yZW1haW5pbmctLTtpZihzdGF0ZT09PVJFSkVDVEVEKXtyZWplY3QocHJvbWlzZSx2YWx1ZSl9ZWxzZXt0aGlzLl9yZXN1bHRbaV09dmFsdWV9fWlmKHRoaXMuX3JlbWFpbmluZz09PTApe2Z1bGZpbGwocHJvbWlzZSx0aGlzLl9yZXN1bHQpfX07RW51bWVyYXRvci5wcm90b3R5cGUuX3dpbGxTZXR0bGVBdD1mdW5jdGlvbiBfd2lsbFNldHRsZUF0KHByb21pc2UsaSl7dmFyIGVudW1lcmF0b3I9dGhpcztzdWJzY3JpYmUocHJvbWlzZSx1bmRlZmluZWQsZnVuY3Rpb24odmFsdWUpe3JldHVybiBlbnVtZXJhdG9yLl9zZXR0bGVkQXQoRlVMRklMTEVELGksdmFsdWUpfSxmdW5jdGlvbihyZWFzb24pe3JldHVybiBlbnVtZXJhdG9yLl9zZXR0bGVkQXQoUkVKRUNURUQsaSxyZWFzb24pfSl9O3JldHVybiBFbnVtZXJhdG9yfSgpO2Z1bmN0aW9uIGFsbChlbnRyaWVzKXtyZXR1cm4gbmV3IEVudW1lcmF0b3IodGhpcyxlbnRyaWVzKS5wcm9taXNlfWZ1bmN0aW9uIHJhY2UoZW50cmllcyl7dmFyIENvbnN0cnVjdG9yPXRoaXM7aWYoIWlzQXJyYXkoZW50cmllcykpe3JldHVybiBuZXcgQ29uc3RydWN0b3IoZnVuY3Rpb24oXyxyZWplY3Qpe3JldHVybiByZWplY3QobmV3IFR5cGVFcnJvcigiWW91IG11c3QgcGFzcyBhbiBhcnJheSB0byByYWNlLiIpKX0pfWVsc2V7cmV0dXJuIG5ldyBDb25zdHJ1Y3RvcihmdW5jdGlvbihyZXNvbHZlLHJlamVjdCl7dmFyIGxlbmd0aD1lbnRyaWVzLmxlbmd0aDtmb3IodmFyIGk9MDtpPGxlbmd0aDtpKyspe0NvbnN0cnVjdG9yLnJlc29sdmUoZW50cmllc1tpXSkudGhlbihyZXNvbHZlLHJlamVjdCl9fSl9fWZ1bmN0aW9uIHJlamVjdCQxKHJlYXNvbil7dmFyIENvbnN0cnVjdG9yPXRoaXM7dmFyIHByb21pc2U9bmV3IENvbnN0cnVjdG9yKG5vb3ApO3JlamVjdChwcm9taXNlLHJlYXNvbik7cmV0dXJuIHByb21pc2V9ZnVuY3Rpb24gbmVlZHNSZXNvbHZlcigpe3Rocm93IG5ldyBUeXBlRXJyb3IoIllvdSBtdXN0IHBhc3MgYSByZXNvbHZlciBmdW5jdGlvbiBhcyB0aGUgZmlyc3QgYXJndW1lbnQgdG8gdGhlIHByb21pc2UgY29uc3RydWN0b3IiKX1mdW5jdGlvbiBuZWVkc05ldygpe3Rocm93IG5ldyBUeXBlRXJyb3IoIkZhaWxlZCB0byBjb25zdHJ1Y3QgJ1Byb21pc2UnOiBQbGVhc2UgdXNlIHRoZSAnbmV3JyBvcGVyYXRvciwgdGhpcyBvYmplY3QgY29uc3RydWN0b3IgY2Fubm90IGJlIGNhbGxlZCBhcyBhIGZ1bmN0aW9uLiIpfXZhciBQcm9taXNlJDI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBQcm9taXNlKHJlc29sdmVyKXt0aGlzW1BST01JU0VfSURdPW5leHRJZCgpO3RoaXMuX3Jlc3VsdD10aGlzLl9zdGF0ZT11bmRlZmluZWQ7dGhpcy5fc3Vic2NyaWJlcnM9W107aWYobm9vcCE9PXJlc29sdmVyKXt0eXBlb2YgcmVzb2x2ZXIhPT0iZnVuY3Rpb24iJiZuZWVkc1Jlc29sdmVyKCk7dGhpcyBpbnN0YW5jZW9mIFByb21pc2U/aW5pdGlhbGl6ZVByb21pc2UodGhpcyxyZXNvbHZlcik6bmVlZHNOZXcoKX19UHJvbWlzZS5wcm90b3R5cGUuY2F0Y2g9ZnVuY3Rpb24gX2NhdGNoKG9uUmVqZWN0aW9uKXtyZXR1cm4gdGhpcy50aGVuKG51bGwsb25SZWplY3Rpb24pfTtQcm9taXNlLnByb3RvdHlwZS5maW5hbGx5PWZ1bmN0aW9uIF9maW5hbGx5KGNhbGxiYWNrKXt2YXIgcHJvbWlzZT10aGlzO3ZhciBjb25zdHJ1Y3Rvcj1wcm9taXNlLmNvbnN0cnVjdG9yO3JldHVybiBwcm9taXNlLnRoZW4oZnVuY3Rpb24odmFsdWUpe3JldHVybiBjb25zdHJ1Y3Rvci5yZXNvbHZlKGNhbGxiYWNrKCkpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gdmFsdWV9KX0sZnVuY3Rpb24ocmVhc29uKXtyZXR1cm4gY29uc3RydWN0b3IucmVzb2x2ZShjYWxsYmFjaygpKS50aGVuKGZ1bmN0aW9uKCl7dGhyb3cgcmVhc29ufSl9KX07cmV0dXJuIFByb21pc2V9KCk7UHJvbWlzZSQyLnByb3RvdHlwZS50aGVuPXRoZW47UHJvbWlzZSQyLmFsbD1hbGw7UHJvbWlzZSQyLnJhY2U9cmFjZTtQcm9taXNlJDIucmVzb2x2ZT1yZXNvbHZlJDE7UHJvbWlzZSQyLnJlamVjdD1yZWplY3QkMTtQcm9taXNlJDIuX3NldFNjaGVkdWxlcj1zZXRTY2hlZHVsZXI7UHJvbWlzZSQyLl9zZXRBc2FwPXNldEFzYXA7UHJvbWlzZSQyLl9hc2FwPWFzYXA7ZnVuY3Rpb24gcG9seWZpbGwoKXt2YXIgbG9jYWw9dm9pZCAwO2lmKHR5cGVvZiBnbG9iYWwhPT0idW5kZWZpbmVkIil7bG9jYWw9Z2xvYmFsfWVsc2UgaWYodHlwZW9mIHNlbGYhPT0idW5kZWZpbmVkIil7bG9jYWw9c2VsZn1lbHNle3RyeXtsb2NhbD1GdW5jdGlvbigicmV0dXJuIHRoaXMiKSgpfWNhdGNoKGUpe3Rocm93IG5ldyBFcnJvcigicG9seWZpbGwgZmFpbGVkIGJlY2F1c2UgZ2xvYmFsIG9iamVjdCBpcyB1bmF2YWlsYWJsZSBpbiB0aGlzIGVudmlyb25tZW50Iil9fXZhciBQPWxvY2FsLlByb21pc2U7aWYoUCl7dmFyIHByb21pc2VUb1N0cmluZz1udWxsO3RyeXtwcm9taXNlVG9TdHJpbmc9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKFAucmVzb2x2ZSgpKX1jYXRjaChlKXt9aWYocHJvbWlzZVRvU3RyaW5nPT09IltvYmplY3QgUHJvbWlzZV0iJiYhUC5jYXN0KXtyZXR1cm59fWxvY2FsLlByb21pc2U9UHJvbWlzZSQyfVByb21pc2UkMi5wb2x5ZmlsbD1wb2x5ZmlsbDtQcm9taXNlJDIuUHJvbWlzZT1Qcm9taXNlJDI7UHJvbWlzZSQyLnBvbHlmaWxsKCk7cmV0dXJuIFByb21pc2UkMn0pfSkuY2FsbCh0aGlzLF9fd2VicGFja19yZXF1aXJlX18oMikpfSxmdW5jdGlvbihtb2R1bGUsZXhwb3J0cyl7dmFyIGc7Zz1mdW5jdGlvbigpe3JldHVybiB0aGlzfSgpO3RyeXtnPWd8fG5ldyBGdW5jdGlvbigicmV0dXJuIHRoaXMiKSgpfWNhdGNoKGUpe2lmKHR5cGVvZiB3aW5kb3c9PT0ib2JqZWN0IilnPXdpbmRvd31tb2R1bGUuZXhwb3J0cz1nfSxmdW5jdGlvbihtb2R1bGUsX193ZWJwYWNrX2V4cG9ydHNfXyxfX3dlYnBhY2tfcmVxdWlyZV9fKXsidXNlIHN0cmljdCI7X193ZWJwYWNrX3JlcXVpcmVfXy5yKF9fd2VicGFja19leHBvcnRzX18pO3ZhciBfRXJyb3JzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX189X193ZWJwYWNrX3JlcXVpcmVfXyg0KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiQWJvcnRFcnJvciIsZnVuY3Rpb24oKXtyZXR1cm4gX0Vycm9yc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fWyJBYm9ydEVycm9yIl19KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiSHR0cEVycm9yIixmdW5jdGlvbigpe3JldHVybiBfRXJyb3JzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19bIkh0dHBFcnJvciJdfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIlRpbWVvdXRFcnJvciIsZnVuY3Rpb24oKXtyZXR1cm4gX0Vycm9yc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fWyJUaW1lb3V0RXJyb3IiXX0pO3ZhciBfSHR0cENsaWVudF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fPV9fd2VicGFja19yZXF1aXJlX18oNSk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIkh0dHBDbGllbnQiLGZ1bmN0aW9uKCl7cmV0dXJuIF9IdHRwQ2xpZW50X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIkh0dHBDbGllbnQiXX0pO19fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCJIdHRwUmVzcG9uc2UiLGZ1bmN0aW9uKCl7cmV0dXJuIF9IdHRwQ2xpZW50X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIkh0dHBSZXNwb25zZSJdfSk7dmFyIF9EZWZhdWx0SHR0cENsaWVudF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fPV9fd2VicGFja19yZXF1aXJlX18oNik7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIkRlZmF1bHRIdHRwQ2xpZW50IixmdW5jdGlvbigpe3JldHVybiBfRGVmYXVsdEh0dHBDbGllbnRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siRGVmYXVsdEh0dHBDbGllbnQiXX0pO3ZhciBfSHViQ29ubmVjdGlvbl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfM19fPV9fd2VicGFja19yZXF1aXJlX18oMTIpO19fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCJIdWJDb25uZWN0aW9uIixmdW5jdGlvbigpe3JldHVybiBfSHViQ29ubmVjdGlvbl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfM19fWyJIdWJDb25uZWN0aW9uIl19KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiSHViQ29ubmVjdGlvblN0YXRlIixmdW5jdGlvbigpe3JldHVybiBfSHViQ29ubmVjdGlvbl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfM19fWyJIdWJDb25uZWN0aW9uU3RhdGUiXX0pO3ZhciBfSHViQ29ubmVjdGlvbkJ1aWxkZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzRfXz1fX3dlYnBhY2tfcmVxdWlyZV9fKDE3KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiSHViQ29ubmVjdGlvbkJ1aWxkZXIiLGZ1bmN0aW9uKCl7cmV0dXJuIF9IdWJDb25uZWN0aW9uQnVpbGRlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfNF9fWyJIdWJDb25uZWN0aW9uQnVpbGRlciJdfSk7dmFyIF9JSHViUHJvdG9jb2xfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzVfXz1fX3dlYnBhY2tfcmVxdWlyZV9fKDE1KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiTWVzc2FnZVR5cGUiLGZ1bmN0aW9uKCl7cmV0dXJuIF9JSHViUHJvdG9jb2xfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzVfX1siTWVzc2FnZVR5cGUiXX0pO3ZhciBfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfNl9fPV9fd2VicGFja19yZXF1aXJlX18oOCk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIkxvZ0xldmVsIixmdW5jdGlvbigpe3JldHVybiBfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfNl9fWyJMb2dMZXZlbCJdfSk7dmFyIF9JVHJhbnNwb3J0X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV83X189X193ZWJwYWNrX3JlcXVpcmVfXygyMCk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIkh0dHBUcmFuc3BvcnRUeXBlIixmdW5jdGlvbigpe3JldHVybiBfSVRyYW5zcG9ydF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfN19fWyJIdHRwVHJhbnNwb3J0VHlwZSJdfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIlRyYW5zZmVyRm9ybWF0IixmdW5jdGlvbigpe3JldHVybiBfSVRyYW5zcG9ydF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfN19fWyJUcmFuc2ZlckZvcm1hdCJdfSk7dmFyIF9Mb2dnZXJzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV84X189X193ZWJwYWNrX3JlcXVpcmVfXygxMCk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIk51bGxMb2dnZXIiLGZ1bmN0aW9uKCl7cmV0dXJuIF9Mb2dnZXJzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV84X19bIk51bGxMb2dnZXIiXX0pO3ZhciBfSnNvbkh1YlByb3RvY29sX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV85X189X193ZWJwYWNrX3JlcXVpcmVfXygyNSk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIkpzb25IdWJQcm90b2NvbCIsZnVuY3Rpb24oKXtyZXR1cm4gX0pzb25IdWJQcm90b2NvbF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfOV9fWyJKc29uSHViUHJvdG9jb2wiXX0pO3ZhciBfU3ViamVjdF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMTBfXz1fX3dlYnBhY2tfcmVxdWlyZV9fKDE2KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiU3ViamVjdCIsZnVuY3Rpb24oKXtyZXR1cm4gX1N1YmplY3RfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzEwX19bIlN1YmplY3QiXX0pO3ZhciBfVXRpbHNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzExX189X193ZWJwYWNrX3JlcXVpcmVfXyg5KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiVkVSU0lPTiIsZnVuY3Rpb24oKXtyZXR1cm4gX1V0aWxzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xMV9fWyJWRVJTSU9OIl19KX0sZnVuY3Rpb24obW9kdWxlLF9fd2VicGFja19leHBvcnRzX18sX193ZWJwYWNrX3JlcXVpcmVfXyl7InVzZSBzdHJpY3QiO19fd2VicGFja19yZXF1aXJlX18ucihfX3dlYnBhY2tfZXhwb3J0c19fKTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiSHR0cEVycm9yIixmdW5jdGlvbigpe3JldHVybiBIdHRwRXJyb3J9KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiVGltZW91dEVycm9yIixmdW5jdGlvbigpe3JldHVybiBUaW1lb3V0RXJyb3J9KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiQWJvcnRFcnJvciIsZnVuY3Rpb24oKXtyZXR1cm4gQWJvcnRFcnJvcn0pO3ZhciBfX2V4dGVuZHM9dW5kZWZpbmVkJiZ1bmRlZmluZWQuX19leHRlbmRzfHxmdW5jdGlvbigpe3ZhciBleHRlbmRTdGF0aWNzPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8e19fcHJvdG9fXzpbXX1pbnN0YW5jZW9mIEFycmF5JiZmdW5jdGlvbihkLGIpe2QuX19wcm90b19fPWJ9fHxmdW5jdGlvbihkLGIpe2Zvcih2YXIgcCBpbiBiKWlmKGIuaGFzT3duUHJvcGVydHkocCkpZFtwXT1iW3BdfTtyZXR1cm4gZnVuY3Rpb24oZCxiKXtleHRlbmRTdGF0aWNzKGQsYik7ZnVuY3Rpb24gX18oKXt0aGlzLmNvbnN0cnVjdG9yPWR9ZC5wcm90b3R5cGU9Yj09PW51bGw/T2JqZWN0LmNyZWF0ZShiKTooX18ucHJvdG90eXBlPWIucHJvdG90eXBlLG5ldyBfXyl9fSgpO3ZhciBIdHRwRXJyb3I9ZnVuY3Rpb24oX3N1cGVyKXtfX2V4dGVuZHMoSHR0cEVycm9yLF9zdXBlcik7ZnVuY3Rpb24gSHR0cEVycm9yKGVycm9yTWVzc2FnZSxzdGF0dXNDb2RlKXt2YXIgX25ld1RhcmdldD10aGlzLmNvbnN0cnVjdG9yO3ZhciBfdGhpcz10aGlzO3ZhciB0cnVlUHJvdG89X25ld1RhcmdldC5wcm90b3R5cGU7X3RoaXM9X3N1cGVyLmNhbGwodGhpcyxlcnJvck1lc3NhZ2UpfHx0aGlzO190aGlzLnN0YXR1c0NvZGU9c3RhdHVzQ29kZTtfdGhpcy5fX3Byb3RvX189dHJ1ZVByb3RvO3JldHVybiBfdGhpc31yZXR1cm4gSHR0cEVycm9yfShFcnJvcik7dmFyIFRpbWVvdXRFcnJvcj1mdW5jdGlvbihfc3VwZXIpe19fZXh0ZW5kcyhUaW1lb3V0RXJyb3IsX3N1cGVyKTtmdW5jdGlvbiBUaW1lb3V0RXJyb3IoZXJyb3JNZXNzYWdlKXt2YXIgX25ld1RhcmdldD10aGlzLmNvbnN0cnVjdG9yO2lmKGVycm9yTWVzc2FnZT09PXZvaWQgMCl7ZXJyb3JNZXNzYWdlPSJBIHRpbWVvdXQgb2NjdXJyZWQuIn12YXIgX3RoaXM9dGhpczt2YXIgdHJ1ZVByb3RvPV9uZXdUYXJnZXQucHJvdG90eXBlO190aGlzPV9zdXBlci5jYWxsKHRoaXMsZXJyb3JNZXNzYWdlKXx8dGhpcztfdGhpcy5fX3Byb3RvX189dHJ1ZVByb3RvO3JldHVybiBfdGhpc31yZXR1cm4gVGltZW91dEVycm9yfShFcnJvcik7dmFyIEFib3J0RXJyb3I9ZnVuY3Rpb24oX3N1cGVyKXtfX2V4dGVuZHMoQWJvcnRFcnJvcixfc3VwZXIpO2Z1bmN0aW9uIEFib3J0RXJyb3IoZXJyb3JNZXNzYWdlKXt2YXIgX25ld1RhcmdldD10aGlzLmNvbnN0cnVjdG9yO2lmKGVycm9yTWVzc2FnZT09PXZvaWQgMCl7ZXJyb3JNZXNzYWdlPSJBbiBhYm9ydCBvY2N1cnJlZC4ifXZhciBfdGhpcz10aGlzO3ZhciB0cnVlUHJvdG89X25ld1RhcmdldC5wcm90b3R5cGU7X3RoaXM9X3N1cGVyLmNhbGwodGhpcyxlcnJvck1lc3NhZ2UpfHx0aGlzO190aGlzLl9fcHJvdG9fXz10cnVlUHJvdG87cmV0dXJuIF90aGlzfXJldHVybiBBYm9ydEVycm9yfShFcnJvcil9LGZ1bmN0aW9uKG1vZHVsZSxfX3dlYnBhY2tfZXhwb3J0c19fLF9fd2VicGFja19yZXF1aXJlX18peyJ1c2Ugc3RyaWN0IjtfX3dlYnBhY2tfcmVxdWlyZV9fLnIoX193ZWJwYWNrX2V4cG9ydHNfXyk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIkh0dHBSZXNwb25zZSIsZnVuY3Rpb24oKXtyZXR1cm4gSHR0cFJlc3BvbnNlfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIkh0dHBDbGllbnQiLGZ1bmN0aW9uKCl7cmV0dXJuIEh0dHBDbGllbnR9KTt2YXIgX19hc3NpZ249dW5kZWZpbmVkJiZ1bmRlZmluZWQuX19hc3NpZ258fE9iamVjdC5hc3NpZ258fGZ1bmN0aW9uKHQpe2Zvcih2YXIgcyxpPTEsbj1hcmd1bWVudHMubGVuZ3RoO2k8bjtpKyspe3M9YXJndW1lbnRzW2ldO2Zvcih2YXIgcCBpbiBzKWlmKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLHApKXRbcF09c1twXX1yZXR1cm4gdH07dmFyIEh0dHBSZXNwb25zZT1mdW5jdGlvbigpe2Z1bmN0aW9uIEh0dHBSZXNwb25zZShzdGF0dXNDb2RlLHN0YXR1c1RleHQsY29udGVudCl7dGhpcy5zdGF0dXNDb2RlPXN0YXR1c0NvZGU7dGhpcy5zdGF0dXNUZXh0PXN0YXR1c1RleHQ7dGhpcy5jb250ZW50PWNvbnRlbnR9cmV0dXJuIEh0dHBSZXNwb25zZX0oKTt2YXIgSHR0cENsaWVudD1mdW5jdGlvbigpe2Z1bmN0aW9uIEh0dHBDbGllbnQoKXt9SHR0cENsaWVudC5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKHVybCxvcHRpb25zKXtyZXR1cm4gdGhpcy5zZW5kKF9fYXNzaWduKHt9LG9wdGlvbnMse21ldGhvZDoiR0VUIix1cmw6dXJsfSkpfTtIdHRwQ2xpZW50LnByb3RvdHlwZS5wb3N0PWZ1bmN0aW9uKHVybCxvcHRpb25zKXtyZXR1cm4gdGhpcy5zZW5kKF9fYXNzaWduKHt9LG9wdGlvbnMse21ldGhvZDoiUE9TVCIsdXJsOnVybH0pKX07SHR0cENsaWVudC5wcm90b3R5cGUuZGVsZXRlPWZ1bmN0aW9uKHVybCxvcHRpb25zKXtyZXR1cm4gdGhpcy5zZW5kKF9fYXNzaWduKHt9LG9wdGlvbnMse21ldGhvZDoiREVMRVRFIix1cmw6dXJsfSkpfTtIdHRwQ2xpZW50LnByb3RvdHlwZS5nZXRDb29raWVTdHJpbmc9ZnVuY3Rpb24odXJsKXtyZXR1cm4iIn07cmV0dXJuIEh0dHBDbGllbnR9KCl9LGZ1bmN0aW9uKG1vZHVsZSxfX3dlYnBhY2tfZXhwb3J0c19fLF9fd2VicGFja19yZXF1aXJlX18peyJ1c2Ugc3RyaWN0IjtfX3dlYnBhY2tfcmVxdWlyZV9fLnIoX193ZWJwYWNrX2V4cG9ydHNfXyk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIkRlZmF1bHRIdHRwQ2xpZW50IixmdW5jdGlvbigpe3JldHVybiBEZWZhdWx0SHR0cENsaWVudH0pO3ZhciBfRXJyb3JzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX189X193ZWJwYWNrX3JlcXVpcmVfXyg0KTt2YXIgX0ZldGNoSHR0cENsaWVudF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fPV9fd2VicGFja19yZXF1aXJlX18oNyk7dmFyIF9IdHRwQ2xpZW50X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX189X193ZWJwYWNrX3JlcXVpcmVfXyg1KTt2YXIgX1V0aWxzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8zX189X193ZWJwYWNrX3JlcXVpcmVfXyg5KTt2YXIgX1hockh0dHBDbGllbnRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzRfXz1fX3dlYnBhY2tfcmVxdWlyZV9fKDExKTt2YXIgX19leHRlbmRzPXVuZGVmaW5lZCYmdW5kZWZpbmVkLl9fZXh0ZW5kc3x8ZnVuY3Rpb24oKXt2YXIgZXh0ZW5kU3RhdGljcz1PYmplY3Quc2V0UHJvdG90eXBlT2Z8fHtfX3Byb3RvX186W119aW5zdGFuY2VvZiBBcnJheSYmZnVuY3Rpb24oZCxiKXtkLl9fcHJvdG9fXz1ifXx8ZnVuY3Rpb24oZCxiKXtmb3IodmFyIHAgaW4gYilpZihiLmhhc093blByb3BlcnR5KHApKWRbcF09YltwXX07cmV0dXJuIGZ1bmN0aW9uKGQsYil7ZXh0ZW5kU3RhdGljcyhkLGIpO2Z1bmN0aW9uIF9fKCl7dGhpcy5jb25zdHJ1Y3Rvcj1kfWQucHJvdG90eXBlPWI9PT1udWxsP09iamVjdC5jcmVhdGUoYik6KF9fLnByb3RvdHlwZT1iLnByb3RvdHlwZSxuZXcgX18pfX0oKTt2YXIgRGVmYXVsdEh0dHBDbGllbnQ9ZnVuY3Rpb24oX3N1cGVyKXtfX2V4dGVuZHMoRGVmYXVsdEh0dHBDbGllbnQsX3N1cGVyKTtmdW5jdGlvbiBEZWZhdWx0SHR0cENsaWVudChsb2dnZXIpe3ZhciBfdGhpcz1fc3VwZXIuY2FsbCh0aGlzKXx8dGhpcztpZih0eXBlb2YgZmV0Y2ghPT0idW5kZWZpbmVkInx8X1V0aWxzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8zX19bIlBsYXRmb3JtIl0uaXNOb2RlKXtfdGhpcy5odHRwQ2xpZW50PW5ldyBfRmV0Y2hIdHRwQ2xpZW50X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIkZldGNoSHR0cENsaWVudCJdKGxvZ2dlcil9ZWxzZSBpZih0eXBlb2YgWE1MSHR0cFJlcXVlc3QhPT0idW5kZWZpbmVkIil7X3RoaXMuaHR0cENsaWVudD1uZXcgX1hockh0dHBDbGllbnRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzRfX1siWGhySHR0cENsaWVudCJdKGxvZ2dlcil9ZWxzZXt0aHJvdyBuZXcgRXJyb3IoIk5vIHVzYWJsZSBIdHRwQ2xpZW50IGZvdW5kLiIpfXJldHVybiBfdGhpc31EZWZhdWx0SHR0cENsaWVudC5wcm90b3R5cGUuc2VuZD1mdW5jdGlvbihyZXF1ZXN0KXtpZihyZXF1ZXN0LmFib3J0U2lnbmFsJiZyZXF1ZXN0LmFib3J0U2lnbmFsLmFib3J0ZWQpe3JldHVybiBQcm9taXNlLnJlamVjdChuZXcgX0Vycm9yc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fWyJBYm9ydEVycm9yIl0pfWlmKCFyZXF1ZXN0Lm1ldGhvZCl7cmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcigiTm8gbWV0aG9kIGRlZmluZWQuIikpfWlmKCFyZXF1ZXN0LnVybCl7cmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcigiTm8gdXJsIGRlZmluZWQuIikpfXJldHVybiB0aGlzLmh0dHBDbGllbnQuc2VuZChyZXF1ZXN0KX07RGVmYXVsdEh0dHBDbGllbnQucHJvdG90eXBlLmdldENvb2tpZVN0cmluZz1mdW5jdGlvbih1cmwpe3JldHVybiB0aGlzLmh0dHBDbGllbnQuZ2V0Q29va2llU3RyaW5nKHVybCl9O3JldHVybiBEZWZhdWx0SHR0cENsaWVudH0oX0h0dHBDbGllbnRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siSHR0cENsaWVudCJdKX0sZnVuY3Rpb24obW9kdWxlLF9fd2VicGFja19leHBvcnRzX18sX193ZWJwYWNrX3JlcXVpcmVfXyl7InVzZSBzdHJpY3QiO19fd2VicGFja19yZXF1aXJlX18ucihfX3dlYnBhY2tfZXhwb3J0c19fKTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiRmV0Y2hIdHRwQ2xpZW50IixmdW5jdGlvbigpe3JldHVybiBGZXRjaEh0dHBDbGllbnR9KTt2YXIgX0Vycm9yc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fPV9fd2VicGFja19yZXF1aXJlX18oNCk7dmFyIF9IdHRwQ2xpZW50X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX189X193ZWJwYWNrX3JlcXVpcmVfXyg1KTt2YXIgX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfXz1fX3dlYnBhY2tfcmVxdWlyZV9fKDgpO3ZhciBfVXRpbHNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzNfXz1fX3dlYnBhY2tfcmVxdWlyZV9fKDkpO3ZhciBfX2V4dGVuZHM9dW5kZWZpbmVkJiZ1bmRlZmluZWQuX19leHRlbmRzfHxmdW5jdGlvbigpe3ZhciBleHRlbmRTdGF0aWNzPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8e19fcHJvdG9fXzpbXX1pbnN0YW5jZW9mIEFycmF5JiZmdW5jdGlvbihkLGIpe2QuX19wcm90b19fPWJ9fHxmdW5jdGlvbihkLGIpe2Zvcih2YXIgcCBpbiBiKWlmKGIuaGFzT3duUHJvcGVydHkocCkpZFtwXT1iW3BdfTtyZXR1cm4gZnVuY3Rpb24oZCxiKXtleHRlbmRTdGF0aWNzKGQsYik7ZnVuY3Rpb24gX18oKXt0aGlzLmNvbnN0cnVjdG9yPWR9ZC5wcm90b3R5cGU9Yj09PW51bGw/T2JqZWN0LmNyZWF0ZShiKTooX18ucHJvdG90eXBlPWIucHJvdG90eXBlLG5ldyBfXyl9fSgpO3ZhciBfX2Fzc2lnbj11bmRlZmluZWQmJnVuZGVmaW5lZC5fX2Fzc2lnbnx8T2JqZWN0LmFzc2lnbnx8ZnVuY3Rpb24odCl7Zm9yKHZhciBzLGk9MSxuPWFyZ3VtZW50cy5sZW5ndGg7aTxuO2krKyl7cz1hcmd1bWVudHNbaV07Zm9yKHZhciBwIGluIHMpaWYoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMscCkpdFtwXT1zW3BdfXJldHVybiB0fTt2YXIgX19hd2FpdGVyPXVuZGVmaW5lZCYmdW5kZWZpbmVkLl9fYXdhaXRlcnx8ZnVuY3Rpb24odGhpc0FyZyxfYXJndW1lbnRzLFAsZ2VuZXJhdG9yKXtyZXR1cm4gbmV3KFB8fChQPVByb21pc2UpKShmdW5jdGlvbihyZXNvbHZlLHJlamVjdCl7ZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKXt0cnl7c3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpfWNhdGNoKGUpe3JlamVjdChlKX19ZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpe3RyeXtzdGVwKGdlbmVyYXRvclsidGhyb3ciXSh2YWx1ZSkpfWNhdGNoKGUpe3JlamVjdChlKX19ZnVuY3Rpb24gc3RlcChyZXN1bHQpe3Jlc3VsdC5kb25lP3Jlc29sdmUocmVzdWx0LnZhbHVlKTpuZXcgUChmdW5jdGlvbihyZXNvbHZlKXtyZXNvbHZlKHJlc3VsdC52YWx1ZSl9KS50aGVuKGZ1bGZpbGxlZCxyZWplY3RlZCl9c3RlcCgoZ2VuZXJhdG9yPWdlbmVyYXRvci5hcHBseSh0aGlzQXJnLF9hcmd1bWVudHN8fFtdKSkubmV4dCgpKX0pfTt2YXIgX19nZW5lcmF0b3I9dW5kZWZpbmVkJiZ1bmRlZmluZWQuX19nZW5lcmF0b3J8fGZ1bmN0aW9uKHRoaXNBcmcsYm9keSl7dmFyIF89e2xhYmVsOjAsc2VudDpmdW5jdGlvbigpe2lmKHRbMF0mMSl0aHJvdyB0WzFdO3JldHVybiB0WzFdfSx0cnlzOltdLG9wczpbXX0sZix5LHQsZztyZXR1cm4gZz17bmV4dDp2ZXJiKDApLHRocm93OnZlcmIoMSkscmV0dXJuOnZlcmIoMil9LHR5cGVvZiBTeW1ib2w9PT0iZnVuY3Rpb24iJiYoZ1tTeW1ib2wuaXRlcmF0b3JdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KSxnO2Z1bmN0aW9uIHZlcmIobil7cmV0dXJuIGZ1bmN0aW9uKHYpe3JldHVybiBzdGVwKFtuLHZdKX19ZnVuY3Rpb24gc3RlcChvcCl7aWYoZil0aHJvdyBuZXcgVHlwZUVycm9yKCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuIik7d2hpbGUoXyl0cnl7aWYoZj0xLHkmJih0PW9wWzBdJjI/eVsicmV0dXJuIl06b3BbMF0/eVsidGhyb3ciXXx8KCh0PXlbInJldHVybiJdKSYmdC5jYWxsKHkpLDApOnkubmV4dCkmJiEodD10LmNhbGwoeSxvcFsxXSkpLmRvbmUpcmV0dXJuIHQ7aWYoeT0wLHQpb3A9W29wWzBdJjIsdC52YWx1ZV07c3dpdGNoKG9wWzBdKXtjYXNlIDA6Y2FzZSAxOnQ9b3A7YnJlYWs7Y2FzZSA0Ol8ubGFiZWwrKztyZXR1cm57dmFsdWU6b3BbMV0sZG9uZTpmYWxzZX07Y2FzZSA1Ol8ubGFiZWwrKzt5PW9wWzFdO29wPVswXTtjb250aW51ZTtjYXNlIDc6b3A9Xy5vcHMucG9wKCk7Xy50cnlzLnBvcCgpO2NvbnRpbnVlO2RlZmF1bHQ6aWYoISh0PV8udHJ5cyx0PXQubGVuZ3RoPjAmJnRbdC5sZW5ndGgtMV0pJiYob3BbMF09PT02fHxvcFswXT09PTIpKXtfPTA7Y29udGludWV9aWYob3BbMF09PT0zJiYoIXR8fG9wWzFdPnRbMF0mJm9wWzFdPHRbM10pKXtfLmxhYmVsPW9wWzFdO2JyZWFrfWlmKG9wWzBdPT09NiYmXy5sYWJlbDx0WzFdKXtfLmxhYmVsPXRbMV07dD1vcDticmVha31pZih0JiZfLmxhYmVsPHRbMl0pe18ubGFiZWw9dFsyXTtfLm9wcy5wdXNoKG9wKTticmVha31pZih0WzJdKV8ub3BzLnBvcCgpO18udHJ5cy5wb3AoKTtjb250aW51ZX1vcD1ib2R5LmNhbGwodGhpc0FyZyxfKX1jYXRjaChlKXtvcD1bNixlXTt5PTB9ZmluYWxseXtmPXQ9MH1pZihvcFswXSY1KXRocm93IG9wWzFdO3JldHVybnt2YWx1ZTpvcFswXT9vcFsxXTp2b2lkIDAsZG9uZTp0cnVlfX19O3ZhciBGZXRjaEh0dHBDbGllbnQ9ZnVuY3Rpb24oX3N1cGVyKXtfX2V4dGVuZHMoRmV0Y2hIdHRwQ2xpZW50LF9zdXBlcik7ZnVuY3Rpb24gRmV0Y2hIdHRwQ2xpZW50KGxvZ2dlcil7dmFyIF90aGlzPV9zdXBlci5jYWxsKHRoaXMpfHx0aGlzO190aGlzLmxvZ2dlcj1sb2dnZXI7aWYodHlwZW9mIGZldGNoPT09InVuZGVmaW5lZCIpe3ZhciByZXF1aXJlRnVuYz10cnVlP3JlcXVpcmU6dW5kZWZpbmVkO190aGlzLmphcj1uZXcocmVxdWlyZUZ1bmMoInRvdWdoLWNvb2tpZSIpLkNvb2tpZUphcik7X3RoaXMuZmV0Y2hUeXBlPXJlcXVpcmVGdW5jKCJub2RlLWZldGNoIik7X3RoaXMuZmV0Y2hUeXBlPXJlcXVpcmVGdW5jKCJmZXRjaC1jb29raWUiKShfdGhpcy5mZXRjaFR5cGUsX3RoaXMuamFyKTtfdGhpcy5hYm9ydENvbnRyb2xsZXJUeXBlPXJlcXVpcmVGdW5jKCJhYm9ydC1jb250cm9sbGVyIil9ZWxzZXtfdGhpcy5mZXRjaFR5cGU9ZmV0Y2guYmluZChzZWxmKTtfdGhpcy5hYm9ydENvbnRyb2xsZXJUeXBlPUFib3J0Q29udHJvbGxlcn1yZXR1cm4gX3RoaXN9RmV0Y2hIdHRwQ2xpZW50LnByb3RvdHlwZS5zZW5kPWZ1bmN0aW9uKHJlcXVlc3Qpe3JldHVybiBfX2F3YWl0ZXIodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKCl7dmFyIGFib3J0Q29udHJvbGxlcixlcnJvcix0aW1lb3V0SWQsbXNUaW1lb3V0LHJlc3BvbnNlLGVfMSxjb250ZW50LHBheWxvYWQ7dmFyIF90aGlzPXRoaXM7cmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsZnVuY3Rpb24oX2Epe3N3aXRjaChfYS5sYWJlbCl7Y2FzZSAwOmlmKHJlcXVlc3QuYWJvcnRTaWduYWwmJnJlcXVlc3QuYWJvcnRTaWduYWwuYWJvcnRlZCl7dGhyb3cgbmV3IF9FcnJvcnNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX1siQWJvcnRFcnJvciJdfWlmKCFyZXF1ZXN0Lm1ldGhvZCl7dGhyb3cgbmV3IEVycm9yKCJObyBtZXRob2QgZGVmaW5lZC4iKX1pZighcmVxdWVzdC51cmwpe3Rocm93IG5ldyBFcnJvcigiTm8gdXJsIGRlZmluZWQuIil9YWJvcnRDb250cm9sbGVyPW5ldyB0aGlzLmFib3J0Q29udHJvbGxlclR5cGU7aWYocmVxdWVzdC5hYm9ydFNpZ25hbCl7cmVxdWVzdC5hYm9ydFNpZ25hbC5vbmFib3J0PWZ1bmN0aW9uKCl7YWJvcnRDb250cm9sbGVyLmFib3J0KCk7ZXJyb3I9bmV3IF9FcnJvcnNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX1siQWJvcnRFcnJvciJdfX10aW1lb3V0SWQ9bnVsbDtpZihyZXF1ZXN0LnRpbWVvdXQpe21zVGltZW91dD1yZXF1ZXN0LnRpbWVvdXQ7dGltZW91dElkPXNldFRpbWVvdXQoZnVuY3Rpb24oKXthYm9ydENvbnRyb2xsZXIuYWJvcnQoKTtfdGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIkxvZ0xldmVsIl0uV2FybmluZywiVGltZW91dCBmcm9tIEhUVFAgcmVxdWVzdC4iKTtlcnJvcj1uZXcgX0Vycm9yc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fWyJUaW1lb3V0RXJyb3IiXX0sbXNUaW1lb3V0KX1fYS5sYWJlbD0xO2Nhc2UgMTpfYS50cnlzLnB1c2goWzEsMyw0LDVdKTtyZXR1cm5bNCx0aGlzLmZldGNoVHlwZShyZXF1ZXN0LnVybCx7Ym9keTpyZXF1ZXN0LmNvbnRlbnQsY2FjaGU6Im5vLWNhY2hlIixjcmVkZW50aWFsczpyZXF1ZXN0LndpdGhDcmVkZW50aWFscz09PXRydWU/ImluY2x1ZGUiOiJzYW1lLW9yaWdpbiIsaGVhZGVyczpfX2Fzc2lnbih7IkNvbnRlbnQtVHlwZSI6InRleHQvcGxhaW47Y2hhcnNldD1VVEYtOCIsIlgtUmVxdWVzdGVkLVdpdGgiOiJYTUxIdHRwUmVxdWVzdCJ9LHJlcXVlc3QuaGVhZGVycyksbWV0aG9kOnJlcXVlc3QubWV0aG9kLG1vZGU6ImNvcnMiLHJlZGlyZWN0OiJtYW51YWwiLHNpZ25hbDphYm9ydENvbnRyb2xsZXIuc2lnbmFsfSldO2Nhc2UgMjpyZXNwb25zZT1fYS5zZW50KCk7cmV0dXJuWzMsNV07Y2FzZSAzOmVfMT1fYS5zZW50KCk7aWYoZXJyb3Ipe3Rocm93IGVycm9yfXRoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJMb2dMZXZlbCJdLldhcm5pbmcsIkVycm9yIGZyb20gSFRUUCByZXF1ZXN0LiAiK2VfMSsiLiIpO3Rocm93IGVfMTtjYXNlIDQ6aWYodGltZW91dElkKXtjbGVhclRpbWVvdXQodGltZW91dElkKX1pZihyZXF1ZXN0LmFib3J0U2lnbmFsKXtyZXF1ZXN0LmFib3J0U2lnbmFsLm9uYWJvcnQ9bnVsbH1yZXR1cm5bN107Y2FzZSA1OmlmKCFyZXNwb25zZS5vayl7dGhyb3cgbmV3IF9FcnJvcnNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX1siSHR0cEVycm9yIl0ocmVzcG9uc2Uuc3RhdHVzVGV4dCxyZXNwb25zZS5zdGF0dXMpfWNvbnRlbnQ9ZGVzZXJpYWxpemVDb250ZW50KHJlc3BvbnNlLHJlcXVlc3QucmVzcG9uc2VUeXBlKTtyZXR1cm5bNCxjb250ZW50XTtjYXNlIDY6cGF5bG9hZD1fYS5zZW50KCk7cmV0dXJuWzIsbmV3IF9IdHRwQ2xpZW50X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIkh0dHBSZXNwb25zZSJdKHJlc3BvbnNlLnN0YXR1cyxyZXNwb25zZS5zdGF0dXNUZXh0LHBheWxvYWQpXX19KX0pfTtGZXRjaEh0dHBDbGllbnQucHJvdG90eXBlLmdldENvb2tpZVN0cmluZz1mdW5jdGlvbih1cmwpe3ZhciBjb29raWVzPSIiO2lmKF9VdGlsc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfM19fWyJQbGF0Zm9ybSJdLmlzTm9kZSYmdGhpcy5qYXIpe3RoaXMuamFyLmdldENvb2tpZXModXJsLGZ1bmN0aW9uKGUsYyl7cmV0dXJuIGNvb2tpZXM9Yy5qb2luKCI7ICIpfSl9cmV0dXJuIGNvb2tpZXN9O3JldHVybiBGZXRjaEh0dHBDbGllbnR9KF9IdHRwQ2xpZW50X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIkh0dHBDbGllbnQiXSk7ZnVuY3Rpb24gZGVzZXJpYWxpemVDb250ZW50KHJlc3BvbnNlLHJlc3BvbnNlVHlwZSl7dmFyIGNvbnRlbnQ7c3dpdGNoKHJlc3BvbnNlVHlwZSl7Y2FzZSJhcnJheWJ1ZmZlciI6Y29udGVudD1yZXNwb25zZS5hcnJheUJ1ZmZlcigpO2JyZWFrO2Nhc2UidGV4dCI6Y29udGVudD1yZXNwb25zZS50ZXh0KCk7YnJlYWs7Y2FzZSJibG9iIjpjYXNlImRvY3VtZW50IjpjYXNlImpzb24iOnRocm93IG5ldyBFcnJvcihyZXNwb25zZVR5cGUrIiBpcyBub3Qgc3VwcG9ydGVkLiIpO2RlZmF1bHQ6Y29udGVudD1yZXNwb25zZS50ZXh0KCk7YnJlYWt9cmV0dXJuIGNvbnRlbnR9fSxmdW5jdGlvbihtb2R1bGUsX193ZWJwYWNrX2V4cG9ydHNfXyxfX3dlYnBhY2tfcmVxdWlyZV9fKXsidXNlIHN0cmljdCI7X193ZWJwYWNrX3JlcXVpcmVfXy5yKF9fd2VicGFja19leHBvcnRzX18pO19fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCJMb2dMZXZlbCIsZnVuY3Rpb24oKXtyZXR1cm4gTG9nTGV2ZWx9KTt2YXIgTG9nTGV2ZWw7KGZ1bmN0aW9uKExvZ0xldmVsKXtMb2dMZXZlbFtMb2dMZXZlbFsiVHJhY2UiXT0wXT0iVHJhY2UiO0xvZ0xldmVsW0xvZ0xldmVsWyJEZWJ1ZyJdPTFdPSJEZWJ1ZyI7TG9nTGV2ZWxbTG9nTGV2ZWxbIkluZm9ybWF0aW9uIl09Ml09IkluZm9ybWF0aW9uIjtMb2dMZXZlbFtMb2dMZXZlbFsiV2FybmluZyJdPTNdPSJXYXJuaW5nIjtMb2dMZXZlbFtMb2dMZXZlbFsiRXJyb3IiXT00XT0iRXJyb3IiO0xvZ0xldmVsW0xvZ0xldmVsWyJDcml0aWNhbCJdPTVdPSJDcml0aWNhbCI7TG9nTGV2ZWxbTG9nTGV2ZWxbIk5vbmUiXT02XT0iTm9uZSJ9KShMb2dMZXZlbHx8KExvZ0xldmVsPXt9KSl9LGZ1bmN0aW9uKG1vZHVsZSxfX3dlYnBhY2tfZXhwb3J0c19fLF9fd2VicGFja19yZXF1aXJlX18peyJ1c2Ugc3RyaWN0IjtfX3dlYnBhY2tfcmVxdWlyZV9fLnIoX193ZWJwYWNrX2V4cG9ydHNfXyk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIlZFUlNJT04iLGZ1bmN0aW9uKCl7cmV0dXJuIFZFUlNJT059KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiQXJnIixmdW5jdGlvbigpe3JldHVybiBBcmd9KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiUGxhdGZvcm0iLGZ1bmN0aW9uKCl7cmV0dXJuIFBsYXRmb3JtfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sImdldERhdGFEZXRhaWwiLGZ1bmN0aW9uKCl7cmV0dXJuIGdldERhdGFEZXRhaWx9KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiZm9ybWF0QXJyYXlCdWZmZXIiLGZ1bmN0aW9uKCl7cmV0dXJuIGZvcm1hdEFycmF5QnVmZmVyfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sImlzQXJyYXlCdWZmZXIiLGZ1bmN0aW9uKCl7cmV0dXJuIGlzQXJyYXlCdWZmZXJ9KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywic2VuZE1lc3NhZ2UiLGZ1bmN0aW9uKCl7cmV0dXJuIHNlbmRNZXNzYWdlfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sImNyZWF0ZUxvZ2dlciIsZnVuY3Rpb24oKXtyZXR1cm4gY3JlYXRlTG9nZ2VyfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIlN1YmplY3RTdWJzY3JpcHRpb24iLGZ1bmN0aW9uKCl7cmV0dXJuIFN1YmplY3RTdWJzY3JpcHRpb259KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiQ29uc29sZUxvZ2dlciIsZnVuY3Rpb24oKXtyZXR1cm4gQ29uc29sZUxvZ2dlcn0pO19fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCJnZXRVc2VyQWdlbnRIZWFkZXIiLGZ1bmN0aW9uKCl7cmV0dXJuIGdldFVzZXJBZ2VudEhlYWRlcn0pO19fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCJjb25zdHJ1Y3RVc2VyQWdlbnQiLGZ1bmN0aW9uKCl7cmV0dXJuIGNvbnN0cnVjdFVzZXJBZ2VudH0pO3ZhciBfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fPV9fd2VicGFja19yZXF1aXJlX18oOCk7dmFyIF9Mb2dnZXJzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX189X193ZWJwYWNrX3JlcXVpcmVfXygxMCk7dmFyIF9fYXNzaWduPXVuZGVmaW5lZCYmdW5kZWZpbmVkLl9fYXNzaWdufHxPYmplY3QuYXNzaWdufHxmdW5jdGlvbih0KXtmb3IodmFyIHMsaT0xLG49YXJndW1lbnRzLmxlbmd0aDtpPG47aSsrKXtzPWFyZ3VtZW50c1tpXTtmb3IodmFyIHAgaW4gcylpZihPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocyxwKSl0W3BdPXNbcF19cmV0dXJuIHR9O3ZhciBfX2F3YWl0ZXI9dW5kZWZpbmVkJiZ1bmRlZmluZWQuX19hd2FpdGVyfHxmdW5jdGlvbih0aGlzQXJnLF9hcmd1bWVudHMsUCxnZW5lcmF0b3Ipe3JldHVybiBuZXcoUHx8KFA9UHJvbWlzZSkpKGZ1bmN0aW9uKHJlc29sdmUscmVqZWN0KXtmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpe3RyeXtzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSl9Y2F0Y2goZSl7cmVqZWN0KGUpfX1mdW5jdGlvbiByZWplY3RlZCh2YWx1ZSl7dHJ5e3N0ZXAoZ2VuZXJhdG9yWyJ0aHJvdyJdKHZhbHVlKSl9Y2F0Y2goZSl7cmVqZWN0KGUpfX1mdW5jdGlvbiBzdGVwKHJlc3VsdCl7cmVzdWx0LmRvbmU/cmVzb2x2ZShyZXN1bHQudmFsdWUpOm5ldyBQKGZ1bmN0aW9uKHJlc29sdmUpe3Jlc29sdmUocmVzdWx0LnZhbHVlKX0pLnRoZW4oZnVsZmlsbGVkLHJlamVjdGVkKX1zdGVwKChnZW5lcmF0b3I9Z2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsX2FyZ3VtZW50c3x8W10pKS5uZXh0KCkpfSl9O3ZhciBfX2dlbmVyYXRvcj11bmRlZmluZWQmJnVuZGVmaW5lZC5fX2dlbmVyYXRvcnx8ZnVuY3Rpb24odGhpc0FyZyxib2R5KXt2YXIgXz17bGFiZWw6MCxzZW50OmZ1bmN0aW9uKCl7aWYodFswXSYxKXRocm93IHRbMV07cmV0dXJuIHRbMV19LHRyeXM6W10sb3BzOltdfSxmLHksdCxnO3JldHVybiBnPXtuZXh0OnZlcmIoMCksdGhyb3c6dmVyYigxKSxyZXR1cm46dmVyYigyKX0sdHlwZW9mIFN5bWJvbD09PSJmdW5jdGlvbiImJihnW1N5bWJvbC5pdGVyYXRvcl09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30pLGc7ZnVuY3Rpb24gdmVyYihuKXtyZXR1cm4gZnVuY3Rpb24odil7cmV0dXJuIHN0ZXAoW24sdl0pfX1mdW5jdGlvbiBzdGVwKG9wKXtpZihmKXRocm93IG5ldyBUeXBlRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy4iKTt3aGlsZShfKXRyeXtpZihmPTEseSYmKHQ9b3BbMF0mMj95WyJyZXR1cm4iXTpvcFswXT95WyJ0aHJvdyJdfHwoKHQ9eVsicmV0dXJuIl0pJiZ0LmNhbGwoeSksMCk6eS5uZXh0KSYmISh0PXQuY2FsbCh5LG9wWzFdKSkuZG9uZSlyZXR1cm4gdDtpZih5PTAsdClvcD1bb3BbMF0mMix0LnZhbHVlXTtzd2l0Y2gob3BbMF0pe2Nhc2UgMDpjYXNlIDE6dD1vcDticmVhaztjYXNlIDQ6Xy5sYWJlbCsrO3JldHVybnt2YWx1ZTpvcFsxXSxkb25lOmZhbHNlfTtjYXNlIDU6Xy5sYWJlbCsrO3k9b3BbMV07b3A9WzBdO2NvbnRpbnVlO2Nhc2UgNzpvcD1fLm9wcy5wb3AoKTtfLnRyeXMucG9wKCk7Y29udGludWU7ZGVmYXVsdDppZighKHQ9Xy50cnlzLHQ9dC5sZW5ndGg+MCYmdFt0Lmxlbmd0aC0xXSkmJihvcFswXT09PTZ8fG9wWzBdPT09Mikpe189MDtjb250aW51ZX1pZihvcFswXT09PTMmJighdHx8b3BbMV0+dFswXSYmb3BbMV08dFszXSkpe18ubGFiZWw9b3BbMV07YnJlYWt9aWYob3BbMF09PT02JiZfLmxhYmVsPHRbMV0pe18ubGFiZWw9dFsxXTt0PW9wO2JyZWFrfWlmKHQmJl8ubGFiZWw8dFsyXSl7Xy5sYWJlbD10WzJdO18ub3BzLnB1c2gob3ApO2JyZWFrfWlmKHRbMl0pXy5vcHMucG9wKCk7Xy50cnlzLnBvcCgpO2NvbnRpbnVlfW9wPWJvZHkuY2FsbCh0aGlzQXJnLF8pfWNhdGNoKGUpe29wPVs2LGVdO3k9MH1maW5hbGx5e2Y9dD0wfWlmKG9wWzBdJjUpdGhyb3cgb3BbMV07cmV0dXJue3ZhbHVlOm9wWzBdP29wWzFdOnZvaWQgMCxkb25lOnRydWV9fX07dmFyIFZFUlNJT049IjUuMC4yIjt2YXIgQXJnPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gQXJnKCl7fUFyZy5pc1JlcXVpcmVkPWZ1bmN0aW9uKHZhbCxuYW1lKXtpZih2YWw9PT1udWxsfHx2YWw9PT11bmRlZmluZWQpe3Rocm93IG5ldyBFcnJvcigiVGhlICciK25hbWUrIicgYXJndW1lbnQgaXMgcmVxdWlyZWQuIil9fTtBcmcuaXNOb3RFbXB0eT1mdW5jdGlvbih2YWwsbmFtZSl7aWYoIXZhbHx8dmFsLm1hdGNoKC9eXHMqJC8pKXt0aHJvdyBuZXcgRXJyb3IoIlRoZSAnIituYW1lKyInIGFyZ3VtZW50IHNob3VsZCBub3QgYmUgZW1wdHkuIil9fTtBcmcuaXNJbj1mdW5jdGlvbih2YWwsdmFsdWVzLG5hbWUpe2lmKCEodmFsIGluIHZhbHVlcykpe3Rocm93IG5ldyBFcnJvcigiVW5rbm93biAiK25hbWUrIiB2YWx1ZTogIit2YWwrIi4iKX19O3JldHVybiBBcmd9KCk7dmFyIFBsYXRmb3JtPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gUGxhdGZvcm0oKXt9T2JqZWN0LmRlZmluZVByb3BlcnR5KFBsYXRmb3JtLCJpc0Jyb3dzZXIiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdHlwZW9mIHdpbmRvdz09PSJvYmplY3QifSxlbnVtZXJhYmxlOnRydWUsY29uZmlndXJhYmxlOnRydWV9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoUGxhdGZvcm0sImlzV2ViV29ya2VyIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHR5cGVvZiBzZWxmPT09Im9iamVjdCImJiJpbXBvcnRTY3JpcHRzImluIHNlbGZ9LGVudW1lcmFibGU6dHJ1ZSxjb25maWd1cmFibGU6dHJ1ZX0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShQbGF0Zm9ybSwiaXNOb2RlIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIXRoaXMuaXNCcm93c2VyJiYhdGhpcy5pc1dlYldvcmtlcn0sZW51bWVyYWJsZTp0cnVlLGNvbmZpZ3VyYWJsZTp0cnVlfSk7cmV0dXJuIFBsYXRmb3JtfSgpO2Z1bmN0aW9uIGdldERhdGFEZXRhaWwoZGF0YSxpbmNsdWRlQ29udGVudCl7dmFyIGRldGFpbD0iIjtpZihpc0FycmF5QnVmZmVyKGRhdGEpKXtkZXRhaWw9IkJpbmFyeSBkYXRhIG9mIGxlbmd0aCAiK2RhdGEuYnl0ZUxlbmd0aDtpZihpbmNsdWRlQ29udGVudCl7ZGV0YWlsKz0iLiBDb250ZW50OiAnIitmb3JtYXRBcnJheUJ1ZmZlcihkYXRhKSsiJyJ9fWVsc2UgaWYodHlwZW9mIGRhdGE9PT0ic3RyaW5nIil7ZGV0YWlsPSJTdHJpbmcgZGF0YSBvZiBsZW5ndGggIitkYXRhLmxlbmd0aDtpZihpbmNsdWRlQ29udGVudCl7ZGV0YWlsKz0iLiBDb250ZW50OiAnIitkYXRhKyInIn19cmV0dXJuIGRldGFpbH1mdW5jdGlvbiBmb3JtYXRBcnJheUJ1ZmZlcihkYXRhKXt2YXIgdmlldz1uZXcgVWludDhBcnJheShkYXRhKTt2YXIgc3RyPSIiO3ZpZXcuZm9yRWFjaChmdW5jdGlvbihudW0pe3ZhciBwYWQ9bnVtPDE2PyIwIjoiIjtzdHIrPSIweCIrcGFkK251bS50b1N0cmluZygxNikrIiAifSk7cmV0dXJuIHN0ci5zdWJzdHIoMCxzdHIubGVuZ3RoLTEpfWZ1bmN0aW9uIGlzQXJyYXlCdWZmZXIodmFsKXtyZXR1cm4gdmFsJiZ0eXBlb2YgQXJyYXlCdWZmZXIhPT0idW5kZWZpbmVkIiYmKHZhbCBpbnN0YW5jZW9mIEFycmF5QnVmZmVyfHx2YWwuY29uc3RydWN0b3ImJnZhbC5jb25zdHJ1Y3Rvci5uYW1lPT09IkFycmF5QnVmZmVyIil9ZnVuY3Rpb24gc2VuZE1lc3NhZ2UobG9nZ2VyLHRyYW5zcG9ydE5hbWUsaHR0cENsaWVudCx1cmwsYWNjZXNzVG9rZW5GYWN0b3J5LGNvbnRlbnQsbG9nTWVzc2FnZUNvbnRlbnQsd2l0aENyZWRlbnRpYWxzLGRlZmF1bHRIZWFkZXJzKXtyZXR1cm4gX19hd2FpdGVyKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbigpe3ZhciBfYSxoZWFkZXJzLHRva2VuLF9iLG5hbWUsdmFsdWUscmVzcG9uc2VUeXBlLHJlc3BvbnNlO3JldHVybiBfX2dlbmVyYXRvcih0aGlzLGZ1bmN0aW9uKF9jKXtzd2l0Y2goX2MubGFiZWwpe2Nhc2UgMDpoZWFkZXJzPXt9O2lmKCFhY2Nlc3NUb2tlbkZhY3RvcnkpcmV0dXJuWzMsMl07cmV0dXJuWzQsYWNjZXNzVG9rZW5GYWN0b3J5KCldO2Nhc2UgMTp0b2tlbj1fYy5zZW50KCk7aWYodG9rZW4pe2hlYWRlcnM9KF9hPXt9LF9hWyJBdXRob3JpemF0aW9uIl09IkJlYXJlciAiK3Rva2VuLF9hKX1fYy5sYWJlbD0yO2Nhc2UgMjpfYj1nZXRVc2VyQWdlbnRIZWFkZXIoKSxuYW1lPV9iWzBdLHZhbHVlPV9iWzFdO2hlYWRlcnNbbmFtZV09dmFsdWU7bG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fWyJMb2dMZXZlbCJdLlRyYWNlLCIoIit0cmFuc3BvcnROYW1lKyIgdHJhbnNwb3J0KSBzZW5kaW5nIGRhdGEuICIrZ2V0RGF0YURldGFpbChjb250ZW50LGxvZ01lc3NhZ2VDb250ZW50KSsiLiIpO3Jlc3BvbnNlVHlwZT1pc0FycmF5QnVmZmVyKGNvbnRlbnQpPyJhcnJheWJ1ZmZlciI6InRleHQiO3JldHVybls0LGh0dHBDbGllbnQucG9zdCh1cmwse2NvbnRlbnQ6Y29udGVudCxoZWFkZXJzOl9fYXNzaWduKHt9LGhlYWRlcnMsZGVmYXVsdEhlYWRlcnMpLHJlc3BvbnNlVHlwZTpyZXNwb25zZVR5cGUsd2l0aENyZWRlbnRpYWxzOndpdGhDcmVkZW50aWFsc30pXTtjYXNlIDM6cmVzcG9uc2U9X2Muc2VudCgpO2xvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX1siTG9nTGV2ZWwiXS5UcmFjZSwiKCIrdHJhbnNwb3J0TmFtZSsiIHRyYW5zcG9ydCkgcmVxdWVzdCBjb21wbGV0ZS4gUmVzcG9uc2Ugc3RhdHVzOiAiK3Jlc3BvbnNlLnN0YXR1c0NvZGUrIi4iKTtyZXR1cm5bMl19fSl9KX1mdW5jdGlvbiBjcmVhdGVMb2dnZXIobG9nZ2VyKXtpZihsb2dnZXI9PT11bmRlZmluZWQpe3JldHVybiBuZXcgQ29uc29sZUxvZ2dlcihfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fWyJMb2dMZXZlbCJdLkluZm9ybWF0aW9uKX1pZihsb2dnZXI9PT1udWxsKXtyZXR1cm4gX0xvZ2dlcnNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siTnVsbExvZ2dlciJdLmluc3RhbmNlfWlmKGxvZ2dlci5sb2cpe3JldHVybiBsb2dnZXJ9cmV0dXJuIG5ldyBDb25zb2xlTG9nZ2VyKGxvZ2dlcil9dmFyIFN1YmplY3RTdWJzY3JpcHRpb249ZnVuY3Rpb24oKXtmdW5jdGlvbiBTdWJqZWN0U3Vic2NyaXB0aW9uKHN1YmplY3Qsb2JzZXJ2ZXIpe3RoaXMuc3ViamVjdD1zdWJqZWN0O3RoaXMub2JzZXJ2ZXI9b2JzZXJ2ZXJ9U3ViamVjdFN1YnNjcmlwdGlvbi5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3ZhciBpbmRleD10aGlzLnN1YmplY3Qub2JzZXJ2ZXJzLmluZGV4T2YodGhpcy5vYnNlcnZlcik7aWYoaW5kZXg+LTEpe3RoaXMuc3ViamVjdC5vYnNlcnZlcnMuc3BsaWNlKGluZGV4LDEpfWlmKHRoaXMuc3ViamVjdC5vYnNlcnZlcnMubGVuZ3RoPT09MCYmdGhpcy5zdWJqZWN0LmNhbmNlbENhbGxiYWNrKXt0aGlzLnN1YmplY3QuY2FuY2VsQ2FsbGJhY2soKS5jYXRjaChmdW5jdGlvbihfKXt9KX19O3JldHVybiBTdWJqZWN0U3Vic2NyaXB0aW9ufSgpO3ZhciBDb25zb2xlTG9nZ2VyPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gQ29uc29sZUxvZ2dlcihtaW5pbXVtTG9nTGV2ZWwpe3RoaXMubWluaW11bUxvZ0xldmVsPW1pbmltdW1Mb2dMZXZlbDt0aGlzLm91dHB1dENvbnNvbGU9Y29uc29sZX1Db25zb2xlTG9nZ2VyLnByb3RvdHlwZS5sb2c9ZnVuY3Rpb24obG9nTGV2ZWwsbWVzc2FnZSl7aWYobG9nTGV2ZWw+PXRoaXMubWluaW11bUxvZ0xldmVsKXtzd2l0Y2gobG9nTGV2ZWwpe2Nhc2UgX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX1siTG9nTGV2ZWwiXS5Dcml0aWNhbDpjYXNlIF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19bIkxvZ0xldmVsIl0uRXJyb3I6dGhpcy5vdXRwdXRDb25zb2xlLmVycm9yKCJbIisobmV3IERhdGUpLnRvSVNPU3RyaW5nKCkrIl0gIitfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fWyJMb2dMZXZlbCJdW2xvZ0xldmVsXSsiOiAiK21lc3NhZ2UpO2JyZWFrO2Nhc2UgX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX1siTG9nTGV2ZWwiXS5XYXJuaW5nOnRoaXMub3V0cHV0Q29uc29sZS53YXJuKCJbIisobmV3IERhdGUpLnRvSVNPU3RyaW5nKCkrIl0gIitfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fWyJMb2dMZXZlbCJdW2xvZ0xldmVsXSsiOiAiK21lc3NhZ2UpO2JyZWFrO2Nhc2UgX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX1siTG9nTGV2ZWwiXS5JbmZvcm1hdGlvbjp0aGlzLm91dHB1dENvbnNvbGUuaW5mbygiWyIrKG5ldyBEYXRlKS50b0lTT1N0cmluZygpKyJdICIrX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX1siTG9nTGV2ZWwiXVtsb2dMZXZlbF0rIjogIittZXNzYWdlKTticmVhaztkZWZhdWx0OnRoaXMub3V0cHV0Q29uc29sZS5sb2coIlsiKyhuZXcgRGF0ZSkudG9JU09TdHJpbmcoKSsiXSAiK19JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19bIkxvZ0xldmVsIl1bbG9nTGV2ZWxdKyI6ICIrbWVzc2FnZSk7YnJlYWt9fX07cmV0dXJuIENvbnNvbGVMb2dnZXJ9KCk7ZnVuY3Rpb24gZ2V0VXNlckFnZW50SGVhZGVyKCl7dmFyIHVzZXJBZ2VudEhlYWRlck5hbWU9IlgtU2lnbmFsUi1Vc2VyLUFnZW50IjtpZihQbGF0Zm9ybS5pc05vZGUpe3VzZXJBZ2VudEhlYWRlck5hbWU9IlVzZXItQWdlbnQifXJldHVyblt1c2VyQWdlbnRIZWFkZXJOYW1lLGNvbnN0cnVjdFVzZXJBZ2VudChWRVJTSU9OLGdldE9zTmFtZSgpLGdldFJ1bnRpbWUoKSxnZXRSdW50aW1lVmVyc2lvbigpKV19ZnVuY3Rpb24gY29uc3RydWN0VXNlckFnZW50KHZlcnNpb24sb3MscnVudGltZSxydW50aW1lVmVyc2lvbil7dmFyIHVzZXJBZ2VudD0iTWljcm9zb2Z0IFNpZ25hbFIvIjt2YXIgbWFqb3JBbmRNaW5vcj12ZXJzaW9uLnNwbGl0KCIuIik7dXNlckFnZW50Kz1tYWpvckFuZE1pbm9yWzBdKyIuIittYWpvckFuZE1pbm9yWzFdO3VzZXJBZ2VudCs9IiAoIit2ZXJzaW9uKyI7ICI7aWYob3MmJm9zIT09IiIpe3VzZXJBZ2VudCs9b3MrIjsgIn1lbHNle3VzZXJBZ2VudCs9IlVua25vd24gT1M7ICJ9dXNlckFnZW50Kz0iIitydW50aW1lO2lmKHJ1bnRpbWVWZXJzaW9uKXt1c2VyQWdlbnQrPSI7ICIrcnVudGltZVZlcnNpb259ZWxzZXt1c2VyQWdlbnQrPSI7IFVua25vd24gUnVudGltZSBWZXJzaW9uIn11c2VyQWdlbnQrPSIpIjtyZXR1cm4gdXNlckFnZW50fWZ1bmN0aW9uIGdldE9zTmFtZSgpe2lmKFBsYXRmb3JtLmlzTm9kZSl7c3dpdGNoKHByb2Nlc3MucGxhdGZvcm0pe2Nhc2Uid2luMzIiOnJldHVybiJXaW5kb3dzIE5UIjtjYXNlImRhcndpbiI6cmV0dXJuIm1hY09TIjtjYXNlImxpbnV4IjpyZXR1cm4iTGludXgiO2RlZmF1bHQ6cmV0dXJuIHByb2Nlc3MucGxhdGZvcm19fWVsc2V7cmV0dXJuIiJ9fWZ1bmN0aW9uIGdldFJ1bnRpbWVWZXJzaW9uKCl7aWYoUGxhdGZvcm0uaXNOb2RlKXtyZXR1cm4gcHJvY2Vzcy52ZXJzaW9ucy5ub2RlfXJldHVybiB1bmRlZmluZWR9ZnVuY3Rpb24gZ2V0UnVudGltZSgpe2lmKFBsYXRmb3JtLmlzTm9kZSl7cmV0dXJuIk5vZGVKUyJ9ZWxzZXtyZXR1cm4iQnJvd3NlciJ9fX0sZnVuY3Rpb24obW9kdWxlLF9fd2VicGFja19leHBvcnRzX18sX193ZWJwYWNrX3JlcXVpcmVfXyl7InVzZSBzdHJpY3QiO19fd2VicGFja19yZXF1aXJlX18ucihfX3dlYnBhY2tfZXhwb3J0c19fKTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiTnVsbExvZ2dlciIsZnVuY3Rpb24oKXtyZXR1cm4gTnVsbExvZ2dlcn0pO3ZhciBOdWxsTG9nZ2VyPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gTnVsbExvZ2dlcigpe31OdWxsTG9nZ2VyLnByb3RvdHlwZS5sb2c9ZnVuY3Rpb24oX2xvZ0xldmVsLF9tZXNzYWdlKXt9O051bGxMb2dnZXIuaW5zdGFuY2U9bmV3IE51bGxMb2dnZXI7cmV0dXJuIE51bGxMb2dnZXJ9KCl9LGZ1bmN0aW9uKG1vZHVsZSxfX3dlYnBhY2tfZXhwb3J0c19fLF9fd2VicGFja19yZXF1aXJlX18peyJ1c2Ugc3RyaWN0IjtfX3dlYnBhY2tfcmVxdWlyZV9fLnIoX193ZWJwYWNrX2V4cG9ydHNfXyk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIlhockh0dHBDbGllbnQiLGZ1bmN0aW9uKCl7cmV0dXJuIFhockh0dHBDbGllbnR9KTt2YXIgX0Vycm9yc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fPV9fd2VicGFja19yZXF1aXJlX18oNCk7dmFyIF9IdHRwQ2xpZW50X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX189X193ZWJwYWNrX3JlcXVpcmVfXyg1KTt2YXIgX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfXz1fX3dlYnBhY2tfcmVxdWlyZV9fKDgpO3ZhciBfX2V4dGVuZHM9dW5kZWZpbmVkJiZ1bmRlZmluZWQuX19leHRlbmRzfHxmdW5jdGlvbigpe3ZhciBleHRlbmRTdGF0aWNzPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8e19fcHJvdG9fXzpbXX1pbnN0YW5jZW9mIEFycmF5JiZmdW5jdGlvbihkLGIpe2QuX19wcm90b19fPWJ9fHxmdW5jdGlvbihkLGIpe2Zvcih2YXIgcCBpbiBiKWlmKGIuaGFzT3duUHJvcGVydHkocCkpZFtwXT1iW3BdfTtyZXR1cm4gZnVuY3Rpb24oZCxiKXtleHRlbmRTdGF0aWNzKGQsYik7ZnVuY3Rpb24gX18oKXt0aGlzLmNvbnN0cnVjdG9yPWR9ZC5wcm90b3R5cGU9Yj09PW51bGw/T2JqZWN0LmNyZWF0ZShiKTooX18ucHJvdG90eXBlPWIucHJvdG90eXBlLG5ldyBfXyl9fSgpO3ZhciBYaHJIdHRwQ2xpZW50PWZ1bmN0aW9uKF9zdXBlcil7X19leHRlbmRzKFhockh0dHBDbGllbnQsX3N1cGVyKTtmdW5jdGlvbiBYaHJIdHRwQ2xpZW50KGxvZ2dlcil7dmFyIF90aGlzPV9zdXBlci5jYWxsKHRoaXMpfHx0aGlzO190aGlzLmxvZ2dlcj1sb2dnZXI7cmV0dXJuIF90aGlzfVhockh0dHBDbGllbnQucHJvdG90eXBlLnNlbmQ9ZnVuY3Rpb24ocmVxdWVzdCl7dmFyIF90aGlzPXRoaXM7aWYocmVxdWVzdC5hYm9ydFNpZ25hbCYmcmVxdWVzdC5hYm9ydFNpZ25hbC5hYm9ydGVkKXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IF9FcnJvcnNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX1siQWJvcnRFcnJvciJdKX1pZighcmVxdWVzdC5tZXRob2Qpe3JldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoIk5vIG1ldGhvZCBkZWZpbmVkLiIpKX1pZighcmVxdWVzdC51cmwpe3JldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoIk5vIHVybCBkZWZpbmVkLiIpKX1yZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSxyZWplY3Qpe3ZhciB4aHI9bmV3IFhNTEh0dHBSZXF1ZXN0O3hoci5vcGVuKHJlcXVlc3QubWV0aG9kLHJlcXVlc3QudXJsLHRydWUpO3hoci53aXRoQ3JlZGVudGlhbHM9cmVxdWVzdC53aXRoQ3JlZGVudGlhbHM9PT11bmRlZmluZWQ/dHJ1ZTpyZXF1ZXN0LndpdGhDcmVkZW50aWFsczt4aHIuc2V0UmVxdWVzdEhlYWRlcigiWC1SZXF1ZXN0ZWQtV2l0aCIsIlhNTEh0dHBSZXF1ZXN0Iik7eGhyLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsInRleHQvcGxhaW47Y2hhcnNldD1VVEYtOCIpO3ZhciBoZWFkZXJzPXJlcXVlc3QuaGVhZGVycztpZihoZWFkZXJzKXtPYmplY3Qua2V5cyhoZWFkZXJzKS5mb3JFYWNoKGZ1bmN0aW9uKGhlYWRlcil7eGhyLnNldFJlcXVlc3RIZWFkZXIoaGVhZGVyLGhlYWRlcnNbaGVhZGVyXSl9KX1pZihyZXF1ZXN0LnJlc3BvbnNlVHlwZSl7eGhyLnJlc3BvbnNlVHlwZT1yZXF1ZXN0LnJlc3BvbnNlVHlwZX1pZihyZXF1ZXN0LmFib3J0U2lnbmFsKXtyZXF1ZXN0LmFib3J0U2lnbmFsLm9uYWJvcnQ9ZnVuY3Rpb24oKXt4aHIuYWJvcnQoKTtyZWplY3QobmV3IF9FcnJvcnNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX1siQWJvcnRFcnJvciJdKX19aWYocmVxdWVzdC50aW1lb3V0KXt4aHIudGltZW91dD1yZXF1ZXN0LnRpbWVvdXR9eGhyLm9ubG9hZD1mdW5jdGlvbigpe2lmKHJlcXVlc3QuYWJvcnRTaWduYWwpe3JlcXVlc3QuYWJvcnRTaWduYWwub25hYm9ydD1udWxsfWlmKHhoci5zdGF0dXM+PTIwMCYmeGhyLnN0YXR1czwzMDApe3Jlc29sdmUobmV3IF9IdHRwQ2xpZW50X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIkh0dHBSZXNwb25zZSJdKHhoci5zdGF0dXMseGhyLnN0YXR1c1RleHQseGhyLnJlc3BvbnNlfHx4aHIucmVzcG9uc2VUZXh0KSl9ZWxzZXtyZWplY3QobmV3IF9FcnJvcnNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX1siSHR0cEVycm9yIl0oeGhyLnN0YXR1c1RleHQseGhyLnN0YXR1cykpfX07eGhyLm9uZXJyb3I9ZnVuY3Rpb24oKXtfdGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIkxvZ0xldmVsIl0uV2FybmluZywiRXJyb3IgZnJvbSBIVFRQIHJlcXVlc3QuICIreGhyLnN0YXR1cysiOiAiK3hoci5zdGF0dXNUZXh0KyIuIik7cmVqZWN0KG5ldyBfRXJyb3JzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19bIkh0dHBFcnJvciJdKHhoci5zdGF0dXNUZXh0LHhoci5zdGF0dXMpKX07eGhyLm9udGltZW91dD1mdW5jdGlvbigpe190aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siTG9nTGV2ZWwiXS5XYXJuaW5nLCJUaW1lb3V0IGZyb20gSFRUUCByZXF1ZXN0LiIpO3JlamVjdChuZXcgX0Vycm9yc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fWyJUaW1lb3V0RXJyb3IiXSl9O3hoci5zZW5kKHJlcXVlc3QuY29udGVudHx8IiIpfSl9O3JldHVybiBYaHJIdHRwQ2xpZW50fShfSHR0cENsaWVudF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJIdHRwQ2xpZW50Il0pfSxmdW5jdGlvbihtb2R1bGUsX193ZWJwYWNrX2V4cG9ydHNfXyxfX3dlYnBhY2tfcmVxdWlyZV9fKXsidXNlIHN0cmljdCI7X193ZWJwYWNrX3JlcXVpcmVfXy5yKF9fd2VicGFja19leHBvcnRzX18pO19fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCJIdWJDb25uZWN0aW9uU3RhdGUiLGZ1bmN0aW9uKCl7cmV0dXJuIEh1YkNvbm5lY3Rpb25TdGF0ZX0pO19fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCJIdWJDb25uZWN0aW9uIixmdW5jdGlvbigpe3JldHVybiBIdWJDb25uZWN0aW9ufSk7dmFyIF9IYW5kc2hha2VQcm90b2NvbF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fPV9fd2VicGFja19yZXF1aXJlX18oMTMpO3ZhciBfSUh1YlByb3RvY29sX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX189X193ZWJwYWNrX3JlcXVpcmVfXygxNSk7dmFyIF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX189X193ZWJwYWNrX3JlcXVpcmVfXyg4KTt2YXIgX1N1YmplY3RfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzNfXz1fX3dlYnBhY2tfcmVxdWlyZV9fKDE2KTt2YXIgX1V0aWxzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV80X189X193ZWJwYWNrX3JlcXVpcmVfXyg5KTt2YXIgX19hd2FpdGVyPXVuZGVmaW5lZCYmdW5kZWZpbmVkLl9fYXdhaXRlcnx8ZnVuY3Rpb24odGhpc0FyZyxfYXJndW1lbnRzLFAsZ2VuZXJhdG9yKXtyZXR1cm4gbmV3KFB8fChQPVByb21pc2UpKShmdW5jdGlvbihyZXNvbHZlLHJlamVjdCl7ZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKXt0cnl7c3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpfWNhdGNoKGUpe3JlamVjdChlKX19ZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpe3RyeXtzdGVwKGdlbmVyYXRvclsidGhyb3ciXSh2YWx1ZSkpfWNhdGNoKGUpe3JlamVjdChlKX19ZnVuY3Rpb24gc3RlcChyZXN1bHQpe3Jlc3VsdC5kb25lP3Jlc29sdmUocmVzdWx0LnZhbHVlKTpuZXcgUChmdW5jdGlvbihyZXNvbHZlKXtyZXNvbHZlKHJlc3VsdC52YWx1ZSl9KS50aGVuKGZ1bGZpbGxlZCxyZWplY3RlZCl9c3RlcCgoZ2VuZXJhdG9yPWdlbmVyYXRvci5hcHBseSh0aGlzQXJnLF9hcmd1bWVudHN8fFtdKSkubmV4dCgpKX0pfTt2YXIgX19nZW5lcmF0b3I9dW5kZWZpbmVkJiZ1bmRlZmluZWQuX19nZW5lcmF0b3J8fGZ1bmN0aW9uKHRoaXNBcmcsYm9keSl7dmFyIF89e2xhYmVsOjAsc2VudDpmdW5jdGlvbigpe2lmKHRbMF0mMSl0aHJvdyB0WzFdO3JldHVybiB0WzFdfSx0cnlzOltdLG9wczpbXX0sZix5LHQsZztyZXR1cm4gZz17bmV4dDp2ZXJiKDApLHRocm93OnZlcmIoMSkscmV0dXJuOnZlcmIoMil9LHR5cGVvZiBTeW1ib2w9PT0iZnVuY3Rpb24iJiYoZ1tTeW1ib2wuaXRlcmF0b3JdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KSxnO2Z1bmN0aW9uIHZlcmIobil7cmV0dXJuIGZ1bmN0aW9uKHYpe3JldHVybiBzdGVwKFtuLHZdKX19ZnVuY3Rpb24gc3RlcChvcCl7aWYoZil0aHJvdyBuZXcgVHlwZUVycm9yKCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuIik7d2hpbGUoXyl0cnl7aWYoZj0xLHkmJih0PW9wWzBdJjI/eVsicmV0dXJuIl06b3BbMF0/eVsidGhyb3ciXXx8KCh0PXlbInJldHVybiJdKSYmdC5jYWxsKHkpLDApOnkubmV4dCkmJiEodD10LmNhbGwoeSxvcFsxXSkpLmRvbmUpcmV0dXJuIHQ7aWYoeT0wLHQpb3A9W29wWzBdJjIsdC52YWx1ZV07c3dpdGNoKG9wWzBdKXtjYXNlIDA6Y2FzZSAxOnQ9b3A7YnJlYWs7Y2FzZSA0Ol8ubGFiZWwrKztyZXR1cm57dmFsdWU6b3BbMV0sZG9uZTpmYWxzZX07Y2FzZSA1Ol8ubGFiZWwrKzt5PW9wWzFdO29wPVswXTtjb250aW51ZTtjYXNlIDc6b3A9Xy5vcHMucG9wKCk7Xy50cnlzLnBvcCgpO2NvbnRpbnVlO2RlZmF1bHQ6aWYoISh0PV8udHJ5cyx0PXQubGVuZ3RoPjAmJnRbdC5sZW5ndGgtMV0pJiYob3BbMF09PT02fHxvcFswXT09PTIpKXtfPTA7Y29udGludWV9aWYob3BbMF09PT0zJiYoIXR8fG9wWzFdPnRbMF0mJm9wWzFdPHRbM10pKXtfLmxhYmVsPW9wWzFdO2JyZWFrfWlmKG9wWzBdPT09NiYmXy5sYWJlbDx0WzFdKXtfLmxhYmVsPXRbMV07dD1vcDticmVha31pZih0JiZfLmxhYmVsPHRbMl0pe18ubGFiZWw9dFsyXTtfLm9wcy5wdXNoKG9wKTticmVha31pZih0WzJdKV8ub3BzLnBvcCgpO18udHJ5cy5wb3AoKTtjb250aW51ZX1vcD1ib2R5LmNhbGwodGhpc0FyZyxfKX1jYXRjaChlKXtvcD1bNixlXTt5PTB9ZmluYWxseXtmPXQ9MH1pZihvcFswXSY1KXRocm93IG9wWzFdO3JldHVybnt2YWx1ZTpvcFswXT9vcFsxXTp2b2lkIDAsZG9uZTp0cnVlfX19O3ZhciBERUZBVUxUX1RJTUVPVVRfSU5fTVM9MzAqMWUzO3ZhciBERUZBVUxUX1BJTkdfSU5URVJWQUxfSU5fTVM9MTUqMWUzO3ZhciBIdWJDb25uZWN0aW9uU3RhdGU7KGZ1bmN0aW9uKEh1YkNvbm5lY3Rpb25TdGF0ZSl7SHViQ29ubmVjdGlvblN0YXRlWyJEaXNjb25uZWN0ZWQiXT0iRGlzY29ubmVjdGVkIjtIdWJDb25uZWN0aW9uU3RhdGVbIkNvbm5lY3RpbmciXT0iQ29ubmVjdGluZyI7SHViQ29ubmVjdGlvblN0YXRlWyJDb25uZWN0ZWQiXT0iQ29ubmVjdGVkIjtIdWJDb25uZWN0aW9uU3RhdGVbIkRpc2Nvbm5lY3RpbmciXT0iRGlzY29ubmVjdGluZyI7SHViQ29ubmVjdGlvblN0YXRlWyJSZWNvbm5lY3RpbmciXT0iUmVjb25uZWN0aW5nIn0pKEh1YkNvbm5lY3Rpb25TdGF0ZXx8KEh1YkNvbm5lY3Rpb25TdGF0ZT17fSkpO3ZhciBIdWJDb25uZWN0aW9uPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gSHViQ29ubmVjdGlvbihjb25uZWN0aW9uLGxvZ2dlcixwcm90b2NvbCxyZWNvbm5lY3RQb2xpY3kpe3ZhciBfdGhpcz10aGlzO19VdGlsc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfNF9fWyJBcmciXS5pc1JlcXVpcmVkKGNvbm5lY3Rpb24sImNvbm5lY3Rpb24iKTtfVXRpbHNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzRfX1siQXJnIl0uaXNSZXF1aXJlZChsb2dnZXIsImxvZ2dlciIpO19VdGlsc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfNF9fWyJBcmciXS5pc1JlcXVpcmVkKHByb3RvY29sLCJwcm90b2NvbCIpO3RoaXMuc2VydmVyVGltZW91dEluTWlsbGlzZWNvbmRzPURFRkFVTFRfVElNRU9VVF9JTl9NUzt0aGlzLmtlZXBBbGl2ZUludGVydmFsSW5NaWxsaXNlY29uZHM9REVGQVVMVF9QSU5HX0lOVEVSVkFMX0lOX01TO3RoaXMubG9nZ2VyPWxvZ2dlcjt0aGlzLnByb3RvY29sPXByb3RvY29sO3RoaXMuY29ubmVjdGlvbj1jb25uZWN0aW9uO3RoaXMucmVjb25uZWN0UG9saWN5PXJlY29ubmVjdFBvbGljeTt0aGlzLmhhbmRzaGFrZVByb3RvY29sPW5ldyBfSGFuZHNoYWtlUHJvdG9jb2xfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX1siSGFuZHNoYWtlUHJvdG9jb2wiXTt0aGlzLmNvbm5lY3Rpb24ub25yZWNlaXZlPWZ1bmN0aW9uKGRhdGEpe3JldHVybiBfdGhpcy5wcm9jZXNzSW5jb21pbmdEYXRhKGRhdGEpfTt0aGlzLmNvbm5lY3Rpb24ub25jbG9zZT1mdW5jdGlvbihlcnJvcil7cmV0dXJuIF90aGlzLmNvbm5lY3Rpb25DbG9zZWQoZXJyb3IpfTt0aGlzLmNhbGxiYWNrcz17fTt0aGlzLm1ldGhvZHM9e307dGhpcy5jbG9zZWRDYWxsYmFja3M9W107dGhpcy5yZWNvbm5lY3RpbmdDYWxsYmFja3M9W107dGhpcy5yZWNvbm5lY3RlZENhbGxiYWNrcz1bXTt0aGlzLmludm9jYXRpb25JZD0wO3RoaXMucmVjZWl2ZWRIYW5kc2hha2VSZXNwb25zZT1mYWxzZTt0aGlzLmNvbm5lY3Rpb25TdGF0ZT1IdWJDb25uZWN0aW9uU3RhdGUuRGlzY29ubmVjdGVkO3RoaXMuY29ubmVjdGlvblN0YXJ0ZWQ9ZmFsc2U7dGhpcy5jYWNoZWRQaW5nTWVzc2FnZT10aGlzLnByb3RvY29sLndyaXRlTWVzc2FnZSh7dHlwZTpfSUh1YlByb3RvY29sX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIk1lc3NhZ2VUeXBlIl0uUGluZ30pfUh1YkNvbm5lY3Rpb24uY3JlYXRlPWZ1bmN0aW9uKGNvbm5lY3Rpb24sbG9nZ2VyLHByb3RvY29sLHJlY29ubmVjdFBvbGljeSl7cmV0dXJuIG5ldyBIdWJDb25uZWN0aW9uKGNvbm5lY3Rpb24sbG9nZ2VyLHByb3RvY29sLHJlY29ubmVjdFBvbGljeSl9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShIdWJDb25uZWN0aW9uLnByb3RvdHlwZSwic3RhdGUiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb25uZWN0aW9uU3RhdGV9LGVudW1lcmFibGU6dHJ1ZSxjb25maWd1cmFibGU6dHJ1ZX0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShIdWJDb25uZWN0aW9uLnByb3RvdHlwZSwiY29ubmVjdGlvbklkIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29ubmVjdGlvbj90aGlzLmNvbm5lY3Rpb24uY29ubmVjdGlvbklkfHxudWxsOm51bGx9LGVudW1lcmFibGU6dHJ1ZSxjb25maWd1cmFibGU6dHJ1ZX0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShIdWJDb25uZWN0aW9uLnByb3RvdHlwZSwiYmFzZVVybCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbm5lY3Rpb24uYmFzZVVybHx8IiJ9LHNldDpmdW5jdGlvbih1cmwpe2lmKHRoaXMuY29ubmVjdGlvblN0YXRlIT09SHViQ29ubmVjdGlvblN0YXRlLkRpc2Nvbm5lY3RlZCYmdGhpcy5jb25uZWN0aW9uU3RhdGUhPT1IdWJDb25uZWN0aW9uU3RhdGUuUmVjb25uZWN0aW5nKXt0aHJvdyBuZXcgRXJyb3IoIlRoZSBIdWJDb25uZWN0aW9uIG11c3QgYmUgaW4gdGhlIERpc2Nvbm5lY3RlZCBvciBSZWNvbm5lY3Rpbmcgc3RhdGUgdG8gY2hhbmdlIHRoZSB1cmwuIil9aWYoIXVybCl7dGhyb3cgbmV3IEVycm9yKCJUaGUgSHViQ29ubmVjdGlvbiB1cmwgbXVzdCBiZSBhIHZhbGlkIHVybC4iKX10aGlzLmNvbm5lY3Rpb24uYmFzZVVybD11cmx9LGVudW1lcmFibGU6dHJ1ZSxjb25maWd1cmFibGU6dHJ1ZX0pO0h1YkNvbm5lY3Rpb24ucHJvdG90eXBlLnN0YXJ0PWZ1bmN0aW9uKCl7dGhpcy5zdGFydFByb21pc2U9dGhpcy5zdGFydFdpdGhTdGF0ZVRyYW5zaXRpb25zKCk7cmV0dXJuIHRoaXMuc3RhcnRQcm9taXNlfTtIdWJDb25uZWN0aW9uLnByb3RvdHlwZS5zdGFydFdpdGhTdGF0ZVRyYW5zaXRpb25zPWZ1bmN0aW9uKCl7cmV0dXJuIF9fYXdhaXRlcih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24oKXt2YXIgZV8xO3JldHVybiBfX2dlbmVyYXRvcih0aGlzLGZ1bmN0aW9uKF9hKXtzd2l0Y2goX2EubGFiZWwpe2Nhc2UgMDppZih0aGlzLmNvbm5lY3Rpb25TdGF0ZSE9PUh1YkNvbm5lY3Rpb25TdGF0ZS5EaXNjb25uZWN0ZWQpe3JldHVyblsyLFByb21pc2UucmVqZWN0KG5ldyBFcnJvcigiQ2Fubm90IHN0YXJ0IGEgSHViQ29ubmVjdGlvbiB0aGF0IGlzIG5vdCBpbiB0aGUgJ0Rpc2Nvbm5lY3RlZCcgc3RhdGUuIikpXX10aGlzLmNvbm5lY3Rpb25TdGF0ZT1IdWJDb25uZWN0aW9uU3RhdGUuQ29ubmVjdGluZzt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siTG9nTGV2ZWwiXS5EZWJ1ZywiU3RhcnRpbmcgSHViQ29ubmVjdGlvbi4iKTtfYS5sYWJlbD0xO2Nhc2UgMTpfYS50cnlzLnB1c2goWzEsMywsNF0pO3JldHVybls0LHRoaXMuc3RhcnRJbnRlcm5hbCgpXTtjYXNlIDI6X2Euc2VudCgpO3RoaXMuY29ubmVjdGlvblN0YXRlPUh1YkNvbm5lY3Rpb25TdGF0ZS5Db25uZWN0ZWQ7dGhpcy5jb25uZWN0aW9uU3RhcnRlZD10cnVlO3RoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJMb2dMZXZlbCJdLkRlYnVnLCJIdWJDb25uZWN0aW9uIGNvbm5lY3RlZCBzdWNjZXNzZnVsbHkuIik7cmV0dXJuWzMsNF07Y2FzZSAzOmVfMT1fYS5zZW50KCk7dGhpcy5jb25uZWN0aW9uU3RhdGU9SHViQ29ubmVjdGlvblN0YXRlLkRpc2Nvbm5lY3RlZDt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siTG9nTGV2ZWwiXS5EZWJ1ZywiSHViQ29ubmVjdGlvbiBmYWlsZWQgdG8gc3RhcnQgc3VjY2Vzc2Z1bGx5IGJlY2F1c2Ugb2YgZXJyb3IgJyIrZV8xKyInLiIpO3JldHVyblsyLFByb21pc2UucmVqZWN0KGVfMSldO2Nhc2UgNDpyZXR1cm5bMl19fSl9KX07SHViQ29ubmVjdGlvbi5wcm90b3R5cGUuc3RhcnRJbnRlcm5hbD1mdW5jdGlvbigpe3JldHVybiBfX2F3YWl0ZXIodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKCl7dmFyIGhhbmRzaGFrZVByb21pc2UsaGFuZHNoYWtlUmVxdWVzdCxlXzI7dmFyIF90aGlzPXRoaXM7cmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsZnVuY3Rpb24oX2Epe3N3aXRjaChfYS5sYWJlbCl7Y2FzZSAwOnRoaXMuc3RvcER1cmluZ1N0YXJ0RXJyb3I9dW5kZWZpbmVkO3RoaXMucmVjZWl2ZWRIYW5kc2hha2VSZXNwb25zZT1mYWxzZTtoYW5kc2hha2VQcm9taXNlPW5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUscmVqZWN0KXtfdGhpcy5oYW5kc2hha2VSZXNvbHZlcj1yZXNvbHZlO190aGlzLmhhbmRzaGFrZVJlamVjdGVyPXJlamVjdH0pO3JldHVybls0LHRoaXMuY29ubmVjdGlvbi5zdGFydCh0aGlzLnByb3RvY29sLnRyYW5zZmVyRm9ybWF0KV07Y2FzZSAxOl9hLnNlbnQoKTtfYS5sYWJlbD0yO2Nhc2UgMjpfYS50cnlzLnB1c2goWzIsNSwsN10pO2hhbmRzaGFrZVJlcXVlc3Q9e3Byb3RvY29sOnRoaXMucHJvdG9jb2wubmFtZSx2ZXJzaW9uOnRoaXMucHJvdG9jb2wudmVyc2lvbn07dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIkxvZ0xldmVsIl0uRGVidWcsIlNlbmRpbmcgaGFuZHNoYWtlIHJlcXVlc3QuIik7cmV0dXJuWzQsdGhpcy5zZW5kTWVzc2FnZSh0aGlzLmhhbmRzaGFrZVByb3RvY29sLndyaXRlSGFuZHNoYWtlUmVxdWVzdChoYW5kc2hha2VSZXF1ZXN0KSldO2Nhc2UgMzpfYS5zZW50KCk7dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIkxvZ0xldmVsIl0uSW5mb3JtYXRpb24sIlVzaW5nIEh1YlByb3RvY29sICciK3RoaXMucHJvdG9jb2wubmFtZSsiJy4iKTt0aGlzLmNsZWFudXBUaW1lb3V0KCk7dGhpcy5yZXNldFRpbWVvdXRQZXJpb2QoKTt0aGlzLnJlc2V0S2VlcEFsaXZlSW50ZXJ2YWwoKTtyZXR1cm5bNCxoYW5kc2hha2VQcm9taXNlXTtjYXNlIDQ6X2Euc2VudCgpO2lmKHRoaXMuc3RvcER1cmluZ1N0YXJ0RXJyb3Ipe3Rocm93IHRoaXMuc3RvcER1cmluZ1N0YXJ0RXJyb3J9cmV0dXJuWzMsN107Y2FzZSA1OmVfMj1fYS5zZW50KCk7dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIkxvZ0xldmVsIl0uRGVidWcsIkh1YiBoYW5kc2hha2UgZmFpbGVkIHdpdGggZXJyb3IgJyIrZV8yKyInIGR1cmluZyBzdGFydCgpLiBTdG9wcGluZyBIdWJDb25uZWN0aW9uLiIpO3RoaXMuY2xlYW51cFRpbWVvdXQoKTt0aGlzLmNsZWFudXBQaW5nVGltZXIoKTtyZXR1cm5bNCx0aGlzLmNvbm5lY3Rpb24uc3RvcChlXzIpXTtjYXNlIDY6X2Euc2VudCgpO3Rocm93IGVfMjtjYXNlIDc6cmV0dXJuWzJdfX0pfSl9O0h1YkNvbm5lY3Rpb24ucHJvdG90eXBlLnN0b3A9ZnVuY3Rpb24oKXtyZXR1cm4gX19hd2FpdGVyKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbigpe3ZhciBzdGFydFByb21pc2UsZV8zO3JldHVybiBfX2dlbmVyYXRvcih0aGlzLGZ1bmN0aW9uKF9hKXtzd2l0Y2goX2EubGFiZWwpe2Nhc2UgMDpzdGFydFByb21pc2U9dGhpcy5zdGFydFByb21pc2U7dGhpcy5zdG9wUHJvbWlzZT10aGlzLnN0b3BJbnRlcm5hbCgpO3JldHVybls0LHRoaXMuc3RvcFByb21pc2VdO2Nhc2UgMTpfYS5zZW50KCk7X2EubGFiZWw9MjtjYXNlIDI6X2EudHJ5cy5wdXNoKFsyLDQsLDVdKTtyZXR1cm5bNCxzdGFydFByb21pc2VdO2Nhc2UgMzpfYS5zZW50KCk7cmV0dXJuWzMsNV07Y2FzZSA0OmVfMz1fYS5zZW50KCk7cmV0dXJuWzMsNV07Y2FzZSA1OnJldHVyblsyXX19KX0pfTtIdWJDb25uZWN0aW9uLnByb3RvdHlwZS5zdG9wSW50ZXJuYWw9ZnVuY3Rpb24oZXJyb3Ipe2lmKHRoaXMuY29ubmVjdGlvblN0YXRlPT09SHViQ29ubmVjdGlvblN0YXRlLkRpc2Nvbm5lY3RlZCl7dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIkxvZ0xldmVsIl0uRGVidWcsIkNhbGwgdG8gSHViQ29ubmVjdGlvbi5zdG9wKCIrZXJyb3IrIikgaWdub3JlZCBiZWNhdXNlIGl0IGlzIGFscmVhZHkgaW4gdGhlIGRpc2Nvbm5lY3RlZCBzdGF0ZS4iKTtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCl9aWYodGhpcy5jb25uZWN0aW9uU3RhdGU9PT1IdWJDb25uZWN0aW9uU3RhdGUuRGlzY29ubmVjdGluZyl7dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIkxvZ0xldmVsIl0uRGVidWcsIkNhbGwgdG8gSHR0cENvbm5lY3Rpb24uc3RvcCgiK2Vycm9yKyIpIGlnbm9yZWQgYmVjYXVzZSB0aGUgY29ubmVjdGlvbiBpcyBhbHJlYWR5IGluIHRoZSBkaXNjb25uZWN0aW5nIHN0YXRlLiIpO3JldHVybiB0aGlzLnN0b3BQcm9taXNlfXRoaXMuY29ubmVjdGlvblN0YXRlPUh1YkNvbm5lY3Rpb25TdGF0ZS5EaXNjb25uZWN0aW5nO3RoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJMb2dMZXZlbCJdLkRlYnVnLCJTdG9wcGluZyBIdWJDb25uZWN0aW9uLiIpO2lmKHRoaXMucmVjb25uZWN0RGVsYXlIYW5kbGUpe3RoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJMb2dMZXZlbCJdLkRlYnVnLCJDb25uZWN0aW9uIHN0b3BwZWQgZHVyaW5nIHJlY29ubmVjdCBkZWxheS4gRG9uZSByZWNvbm5lY3RpbmcuIik7Y2xlYXJUaW1lb3V0KHRoaXMucmVjb25uZWN0RGVsYXlIYW5kbGUpO3RoaXMucmVjb25uZWN0RGVsYXlIYW5kbGU9dW5kZWZpbmVkO3RoaXMuY29tcGxldGVDbG9zZSgpO3JldHVybiBQcm9taXNlLnJlc29sdmUoKX10aGlzLmNsZWFudXBUaW1lb3V0KCk7dGhpcy5jbGVhbnVwUGluZ1RpbWVyKCk7dGhpcy5zdG9wRHVyaW5nU3RhcnRFcnJvcj1lcnJvcnx8bmV3IEVycm9yKCJUaGUgY29ubmVjdGlvbiB3YXMgc3RvcHBlZCBiZWZvcmUgdGhlIGh1YiBoYW5kc2hha2UgY291bGQgY29tcGxldGUuIik7cmV0dXJuIHRoaXMuY29ubmVjdGlvbi5zdG9wKGVycm9yKX07SHViQ29ubmVjdGlvbi5wcm90b3R5cGUuc3RyZWFtPWZ1bmN0aW9uKG1ldGhvZE5hbWUpe3ZhciBfdGhpcz10aGlzO3ZhciBhcmdzPVtdO2Zvcih2YXIgX2k9MTtfaTxhcmd1bWVudHMubGVuZ3RoO19pKyspe2FyZ3NbX2ktMV09YXJndW1lbnRzW19pXX12YXIgX2E9dGhpcy5yZXBsYWNlU3RyZWFtaW5nUGFyYW1zKGFyZ3MpLHN0cmVhbXM9X2FbMF0sc3RyZWFtSWRzPV9hWzFdO3ZhciBpbnZvY2F0aW9uRGVzY3JpcHRvcj10aGlzLmNyZWF0ZVN0cmVhbUludm9jYXRpb24obWV0aG9kTmFtZSxhcmdzLHN0cmVhbUlkcyk7dmFyIHByb21pc2VRdWV1ZTt2YXIgc3ViamVjdD1uZXcgX1N1YmplY3RfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzNfX1siU3ViamVjdCJdO3N1YmplY3QuY2FuY2VsQ2FsbGJhY2s9ZnVuY3Rpb24oKXt2YXIgY2FuY2VsSW52b2NhdGlvbj1fdGhpcy5jcmVhdGVDYW5jZWxJbnZvY2F0aW9uKGludm9jYXRpb25EZXNjcmlwdG9yLmludm9jYXRpb25JZCk7ZGVsZXRlIF90aGlzLmNhbGxiYWNrc1tpbnZvY2F0aW9uRGVzY3JpcHRvci5pbnZvY2F0aW9uSWRdO3JldHVybiBwcm9taXNlUXVldWUudGhlbihmdW5jdGlvbigpe3JldHVybiBfdGhpcy5zZW5kV2l0aFByb3RvY29sKGNhbmNlbEludm9jYXRpb24pfSl9O3RoaXMuY2FsbGJhY2tzW2ludm9jYXRpb25EZXNjcmlwdG9yLmludm9jYXRpb25JZF09ZnVuY3Rpb24oaW52b2NhdGlvbkV2ZW50LGVycm9yKXtpZihlcnJvcil7c3ViamVjdC5lcnJvcihlcnJvcik7cmV0dXJufWVsc2UgaWYoaW52b2NhdGlvbkV2ZW50KXtpZihpbnZvY2F0aW9uRXZlbnQudHlwZT09PV9JSHViUHJvdG9jb2xfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siTWVzc2FnZVR5cGUiXS5Db21wbGV0aW9uKXtpZihpbnZvY2F0aW9uRXZlbnQuZXJyb3Ipe3N1YmplY3QuZXJyb3IobmV3IEVycm9yKGludm9jYXRpb25FdmVudC5lcnJvcikpfWVsc2V7c3ViamVjdC5jb21wbGV0ZSgpfX1lbHNle3N1YmplY3QubmV4dChpbnZvY2F0aW9uRXZlbnQuaXRlbSl9fX07cHJvbWlzZVF1ZXVlPXRoaXMuc2VuZFdpdGhQcm90b2NvbChpbnZvY2F0aW9uRGVzY3JpcHRvcikuY2F0Y2goZnVuY3Rpb24oZSl7c3ViamVjdC5lcnJvcihlKTtkZWxldGUgX3RoaXMuY2FsbGJhY2tzW2ludm9jYXRpb25EZXNjcmlwdG9yLmludm9jYXRpb25JZF19KTt0aGlzLmxhdW5jaFN0cmVhbXMoc3RyZWFtcyxwcm9taXNlUXVldWUpO3JldHVybiBzdWJqZWN0fTtIdWJDb25uZWN0aW9uLnByb3RvdHlwZS5zZW5kTWVzc2FnZT1mdW5jdGlvbihtZXNzYWdlKXt0aGlzLnJlc2V0S2VlcEFsaXZlSW50ZXJ2YWwoKTtyZXR1cm4gdGhpcy5jb25uZWN0aW9uLnNlbmQobWVzc2FnZSl9O0h1YkNvbm5lY3Rpb24ucHJvdG90eXBlLnNlbmRXaXRoUHJvdG9jb2w9ZnVuY3Rpb24obWVzc2FnZSl7cmV0dXJuIHRoaXMuc2VuZE1lc3NhZ2UodGhpcy5wcm90b2NvbC53cml0ZU1lc3NhZ2UobWVzc2FnZSkpfTtIdWJDb25uZWN0aW9uLnByb3RvdHlwZS5zZW5kPWZ1bmN0aW9uKG1ldGhvZE5hbWUpe3ZhciBhcmdzPVtdO2Zvcih2YXIgX2k9MTtfaTxhcmd1bWVudHMubGVuZ3RoO19pKyspe2FyZ3NbX2ktMV09YXJndW1lbnRzW19pXX12YXIgX2E9dGhpcy5yZXBsYWNlU3RyZWFtaW5nUGFyYW1zKGFyZ3MpLHN0cmVhbXM9X2FbMF0sc3RyZWFtSWRzPV9hWzFdO3ZhciBzZW5kUHJvbWlzZT10aGlzLnNlbmRXaXRoUHJvdG9jb2wodGhpcy5jcmVhdGVJbnZvY2F0aW9uKG1ldGhvZE5hbWUsYXJncyx0cnVlLHN0cmVhbUlkcykpO3RoaXMubGF1bmNoU3RyZWFtcyhzdHJlYW1zLHNlbmRQcm9taXNlKTtyZXR1cm4gc2VuZFByb21pc2V9O0h1YkNvbm5lY3Rpb24ucHJvdG90eXBlLmludm9rZT1mdW5jdGlvbihtZXRob2ROYW1lKXt2YXIgX3RoaXM9dGhpczt2YXIgYXJncz1bXTtmb3IodmFyIF9pPTE7X2k8YXJndW1lbnRzLmxlbmd0aDtfaSsrKXthcmdzW19pLTFdPWFyZ3VtZW50c1tfaV19dmFyIF9hPXRoaXMucmVwbGFjZVN0cmVhbWluZ1BhcmFtcyhhcmdzKSxzdHJlYW1zPV9hWzBdLHN0cmVhbUlkcz1fYVsxXTt2YXIgaW52b2NhdGlvbkRlc2NyaXB0b3I9dGhpcy5jcmVhdGVJbnZvY2F0aW9uKG1ldGhvZE5hbWUsYXJncyxmYWxzZSxzdHJlYW1JZHMpO3ZhciBwPW5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUscmVqZWN0KXtfdGhpcy5jYWxsYmFja3NbaW52b2NhdGlvbkRlc2NyaXB0b3IuaW52b2NhdGlvbklkXT1mdW5jdGlvbihpbnZvY2F0aW9uRXZlbnQsZXJyb3Ipe2lmKGVycm9yKXtyZWplY3QoZXJyb3IpO3JldHVybn1lbHNlIGlmKGludm9jYXRpb25FdmVudCl7aWYoaW52b2NhdGlvbkV2ZW50LnR5cGU9PT1fSUh1YlByb3RvY29sX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIk1lc3NhZ2VUeXBlIl0uQ29tcGxldGlvbil7aWYoaW52b2NhdGlvbkV2ZW50LmVycm9yKXtyZWplY3QobmV3IEVycm9yKGludm9jYXRpb25FdmVudC5lcnJvcikpfWVsc2V7cmVzb2x2ZShpbnZvY2F0aW9uRXZlbnQucmVzdWx0KX19ZWxzZXtyZWplY3QobmV3IEVycm9yKCJVbmV4cGVjdGVkIG1lc3NhZ2UgdHlwZTogIitpbnZvY2F0aW9uRXZlbnQudHlwZSkpfX19O3ZhciBwcm9taXNlUXVldWU9X3RoaXMuc2VuZFdpdGhQcm90b2NvbChpbnZvY2F0aW9uRGVzY3JpcHRvcikuY2F0Y2goZnVuY3Rpb24oZSl7cmVqZWN0KGUpO2RlbGV0ZSBfdGhpcy5jYWxsYmFja3NbaW52b2NhdGlvbkRlc2NyaXB0b3IuaW52b2NhdGlvbklkXX0pO190aGlzLmxhdW5jaFN0cmVhbXMoc3RyZWFtcyxwcm9taXNlUXVldWUpfSk7cmV0dXJuIHB9O0h1YkNvbm5lY3Rpb24ucHJvdG90eXBlLm9uPWZ1bmN0aW9uKG1ldGhvZE5hbWUsbmV3TWV0aG9kKXtpZighbWV0aG9kTmFtZXx8IW5ld01ldGhvZCl7cmV0dXJufW1ldGhvZE5hbWU9bWV0aG9kTmFtZS50b0xvd2VyQ2FzZSgpO2lmKCF0aGlzLm1ldGhvZHNbbWV0aG9kTmFtZV0pe3RoaXMubWV0aG9kc1ttZXRob2ROYW1lXT1bXX1pZih0aGlzLm1ldGhvZHNbbWV0aG9kTmFtZV0uaW5kZXhPZihuZXdNZXRob2QpIT09LTEpe3JldHVybn10aGlzLm1ldGhvZHNbbWV0aG9kTmFtZV0ucHVzaChuZXdNZXRob2QpfTtIdWJDb25uZWN0aW9uLnByb3RvdHlwZS5vZmY9ZnVuY3Rpb24obWV0aG9kTmFtZSxtZXRob2Qpe2lmKCFtZXRob2ROYW1lKXtyZXR1cm59bWV0aG9kTmFtZT1tZXRob2ROYW1lLnRvTG93ZXJDYXNlKCk7dmFyIGhhbmRsZXJzPXRoaXMubWV0aG9kc1ttZXRob2ROYW1lXTtpZighaGFuZGxlcnMpe3JldHVybn1pZihtZXRob2Qpe3ZhciByZW1vdmVJZHg9aGFuZGxlcnMuaW5kZXhPZihtZXRob2QpO2lmKHJlbW92ZUlkeCE9PS0xKXtoYW5kbGVycy5zcGxpY2UocmVtb3ZlSWR4LDEpO2lmKGhhbmRsZXJzLmxlbmd0aD09PTApe2RlbGV0ZSB0aGlzLm1ldGhvZHNbbWV0aG9kTmFtZV19fX1lbHNle2RlbGV0ZSB0aGlzLm1ldGhvZHNbbWV0aG9kTmFtZV19fTtIdWJDb25uZWN0aW9uLnByb3RvdHlwZS5vbmNsb3NlPWZ1bmN0aW9uKGNhbGxiYWNrKXtpZihjYWxsYmFjayl7dGhpcy5jbG9zZWRDYWxsYmFja3MucHVzaChjYWxsYmFjayl9fTtIdWJDb25uZWN0aW9uLnByb3RvdHlwZS5vbnJlY29ubmVjdGluZz1mdW5jdGlvbihjYWxsYmFjayl7aWYoY2FsbGJhY2spe3RoaXMucmVjb25uZWN0aW5nQ2FsbGJhY2tzLnB1c2goY2FsbGJhY2spfX07SHViQ29ubmVjdGlvbi5wcm90b3R5cGUub25yZWNvbm5lY3RlZD1mdW5jdGlvbihjYWxsYmFjayl7aWYoY2FsbGJhY2spe3RoaXMucmVjb25uZWN0ZWRDYWxsYmFja3MucHVzaChjYWxsYmFjayl9fTtIdWJDb25uZWN0aW9uLnByb3RvdHlwZS5wcm9jZXNzSW5jb21pbmdEYXRhPWZ1bmN0aW9uKGRhdGEpe3RoaXMuY2xlYW51cFRpbWVvdXQoKTtpZighdGhpcy5yZWNlaXZlZEhhbmRzaGFrZVJlc3BvbnNlKXtkYXRhPXRoaXMucHJvY2Vzc0hhbmRzaGFrZVJlc3BvbnNlKGRhdGEpO3RoaXMucmVjZWl2ZWRIYW5kc2hha2VSZXNwb25zZT10cnVlfWlmKGRhdGEpe3ZhciBtZXNzYWdlcz10aGlzLnByb3RvY29sLnBhcnNlTWVzc2FnZXMoZGF0YSx0aGlzLmxvZ2dlcik7Zm9yKHZhciBfaT0wLG1lc3NhZ2VzXzE9bWVzc2FnZXM7X2k8bWVzc2FnZXNfMS5sZW5ndGg7X2krKyl7dmFyIG1lc3NhZ2U9bWVzc2FnZXNfMVtfaV07c3dpdGNoKG1lc3NhZ2UudHlwZSl7Y2FzZSBfSUh1YlByb3RvY29sX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIk1lc3NhZ2VUeXBlIl0uSW52b2NhdGlvbjp0aGlzLmludm9rZUNsaWVudE1ldGhvZChtZXNzYWdlKTticmVhaztjYXNlIF9JSHViUHJvdG9jb2xfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siTWVzc2FnZVR5cGUiXS5TdHJlYW1JdGVtOmNhc2UgX0lIdWJQcm90b2NvbF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJNZXNzYWdlVHlwZSJdLkNvbXBsZXRpb246dmFyIGNhbGxiYWNrPXRoaXMuY2FsbGJhY2tzW21lc3NhZ2UuaW52b2NhdGlvbklkXTtpZihjYWxsYmFjayl7aWYobWVzc2FnZS50eXBlPT09X0lIdWJQcm90b2NvbF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJNZXNzYWdlVHlwZSJdLkNvbXBsZXRpb24pe2RlbGV0ZSB0aGlzLmNhbGxiYWNrc1ttZXNzYWdlLmludm9jYXRpb25JZF19Y2FsbGJhY2sobWVzc2FnZSl9YnJlYWs7Y2FzZSBfSUh1YlByb3RvY29sX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIk1lc3NhZ2VUeXBlIl0uUGluZzpicmVhaztjYXNlIF9JSHViUHJvdG9jb2xfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siTWVzc2FnZVR5cGUiXS5DbG9zZTp0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siTG9nTGV2ZWwiXS5JbmZvcm1hdGlvbiwiQ2xvc2UgbWVzc2FnZSByZWNlaXZlZCBmcm9tIHNlcnZlci4iKTt2YXIgZXJyb3I9bWVzc2FnZS5lcnJvcj9uZXcgRXJyb3IoIlNlcnZlciByZXR1cm5lZCBhbiBlcnJvciBvbiBjbG9zZTogIittZXNzYWdlLmVycm9yKTp1bmRlZmluZWQ7aWYobWVzc2FnZS5hbGxvd1JlY29ubmVjdD09PXRydWUpe3RoaXMuY29ubmVjdGlvbi5zdG9wKGVycm9yKX1lbHNle3RoaXMuc3RvcFByb21pc2U9dGhpcy5zdG9wSW50ZXJuYWwoZXJyb3IpfWJyZWFrO2RlZmF1bHQ6dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIkxvZ0xldmVsIl0uV2FybmluZywiSW52YWxpZCBtZXNzYWdlIHR5cGU6ICIrbWVzc2FnZS50eXBlKyIuIik7YnJlYWt9fX10aGlzLnJlc2V0VGltZW91dFBlcmlvZCgpfTtIdWJDb25uZWN0aW9uLnByb3RvdHlwZS5wcm9jZXNzSGFuZHNoYWtlUmVzcG9uc2U9ZnVuY3Rpb24oZGF0YSl7dmFyIF9hO3ZhciByZXNwb25zZU1lc3NhZ2U7dmFyIHJlbWFpbmluZ0RhdGE7dHJ5e19hPXRoaXMuaGFuZHNoYWtlUHJvdG9jb2wucGFyc2VIYW5kc2hha2VSZXNwb25zZShkYXRhKSxyZW1haW5pbmdEYXRhPV9hWzBdLHJlc3BvbnNlTWVzc2FnZT1fYVsxXX1jYXRjaChlKXt2YXIgbWVzc2FnZT0iRXJyb3IgcGFyc2luZyBoYW5kc2hha2UgcmVzcG9uc2U6ICIrZTt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siTG9nTGV2ZWwiXS5FcnJvcixtZXNzYWdlKTt2YXIgZXJyb3I9bmV3IEVycm9yKG1lc3NhZ2UpO3RoaXMuaGFuZHNoYWtlUmVqZWN0ZXIoZXJyb3IpO3Rocm93IGVycm9yfWlmKHJlc3BvbnNlTWVzc2FnZS5lcnJvcil7dmFyIG1lc3NhZ2U9IlNlcnZlciByZXR1cm5lZCBoYW5kc2hha2UgZXJyb3I6ICIrcmVzcG9uc2VNZXNzYWdlLmVycm9yO3RoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJMb2dMZXZlbCJdLkVycm9yLG1lc3NhZ2UpO3ZhciBlcnJvcj1uZXcgRXJyb3IobWVzc2FnZSk7dGhpcy5oYW5kc2hha2VSZWplY3RlcihlcnJvcik7dGhyb3cgZXJyb3J9ZWxzZXt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siTG9nTGV2ZWwiXS5EZWJ1ZywiU2VydmVyIGhhbmRzaGFrZSBjb21wbGV0ZS4iKX10aGlzLmhhbmRzaGFrZVJlc29sdmVyKCk7cmV0dXJuIHJlbWFpbmluZ0RhdGF9O0h1YkNvbm5lY3Rpb24ucHJvdG90eXBlLnJlc2V0S2VlcEFsaXZlSW50ZXJ2YWw9ZnVuY3Rpb24oKXt2YXIgX3RoaXM9dGhpcztpZih0aGlzLmNvbm5lY3Rpb24uZmVhdHVyZXMuaW5oZXJlbnRLZWVwQWxpdmUpe3JldHVybn10aGlzLmNsZWFudXBQaW5nVGltZXIoKTt0aGlzLnBpbmdTZXJ2ZXJIYW5kbGU9c2V0VGltZW91dChmdW5jdGlvbigpe3JldHVybiBfX2F3YWl0ZXIoX3RoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbigpe3ZhciBfYTtyZXR1cm4gX19nZW5lcmF0b3IodGhpcyxmdW5jdGlvbihfYil7c3dpdGNoKF9iLmxhYmVsKXtjYXNlIDA6aWYoISh0aGlzLmNvbm5lY3Rpb25TdGF0ZT09PUh1YkNvbm5lY3Rpb25TdGF0ZS5Db25uZWN0ZWQpKXJldHVyblszLDRdO19iLmxhYmVsPTE7Y2FzZSAxOl9iLnRyeXMucHVzaChbMSwzLCw0XSk7cmV0dXJuWzQsdGhpcy5zZW5kTWVzc2FnZSh0aGlzLmNhY2hlZFBpbmdNZXNzYWdlKV07Y2FzZSAyOl9iLnNlbnQoKTtyZXR1cm5bMyw0XTtjYXNlIDM6X2E9X2Iuc2VudCgpO3RoaXMuY2xlYW51cFBpbmdUaW1lcigpO3JldHVyblszLDRdO2Nhc2UgNDpyZXR1cm5bMl19fSl9KX0sdGhpcy5rZWVwQWxpdmVJbnRlcnZhbEluTWlsbGlzZWNvbmRzKX07SHViQ29ubmVjdGlvbi5wcm90b3R5cGUucmVzZXRUaW1lb3V0UGVyaW9kPWZ1bmN0aW9uKCl7dmFyIF90aGlzPXRoaXM7aWYoIXRoaXMuY29ubmVjdGlvbi5mZWF0dXJlc3x8IXRoaXMuY29ubmVjdGlvbi5mZWF0dXJlcy5pbmhlcmVudEtlZXBBbGl2ZSl7dGhpcy50aW1lb3V0SGFuZGxlPXNldFRpbWVvdXQoZnVuY3Rpb24oKXtyZXR1cm4gX3RoaXMuc2VydmVyVGltZW91dCgpfSx0aGlzLnNlcnZlclRpbWVvdXRJbk1pbGxpc2Vjb25kcyl9fTtIdWJDb25uZWN0aW9uLnByb3RvdHlwZS5zZXJ2ZXJUaW1lb3V0PWZ1bmN0aW9uKCl7dGhpcy5jb25uZWN0aW9uLnN0b3AobmV3IEVycm9yKCJTZXJ2ZXIgdGltZW91dCBlbGFwc2VkIHdpdGhvdXQgcmVjZWl2aW5nIGEgbWVzc2FnZSBmcm9tIHRoZSBzZXJ2ZXIuIikpfTtIdWJDb25uZWN0aW9uLnByb3RvdHlwZS5pbnZva2VDbGllbnRNZXRob2Q9ZnVuY3Rpb24oaW52b2NhdGlvbk1lc3NhZ2Upe3ZhciBfdGhpcz10aGlzO3ZhciBtZXRob2RzPXRoaXMubWV0aG9kc1tpbnZvY2F0aW9uTWVzc2FnZS50YXJnZXQudG9Mb3dlckNhc2UoKV07aWYobWV0aG9kcyl7dHJ5e21ldGhvZHMuZm9yRWFjaChmdW5jdGlvbihtKXtyZXR1cm4gbS5hcHBseShfdGhpcyxpbnZvY2F0aW9uTWVzc2FnZS5hcmd1bWVudHMpfSl9Y2F0Y2goZSl7dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIkxvZ0xldmVsIl0uRXJyb3IsIkEgY2FsbGJhY2sgZm9yIHRoZSBtZXRob2QgIitpbnZvY2F0aW9uTWVzc2FnZS50YXJnZXQudG9Mb3dlckNhc2UoKSsiIHRocmV3IGVycm9yICciK2UrIicuIil9aWYoaW52b2NhdGlvbk1lc3NhZ2UuaW52b2NhdGlvbklkKXt2YXIgbWVzc2FnZT0iU2VydmVyIHJlcXVlc3RlZCBhIHJlc3BvbnNlLCB3aGljaCBpcyBub3Qgc3VwcG9ydGVkIGluIHRoaXMgdmVyc2lvbiBvZiB0aGUgY2xpZW50LiI7dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIkxvZ0xldmVsIl0uRXJyb3IsbWVzc2FnZSk7dGhpcy5zdG9wUHJvbWlzZT10aGlzLnN0b3BJbnRlcm5hbChuZXcgRXJyb3IobWVzc2FnZSkpfX1lbHNle3RoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJMb2dMZXZlbCJdLldhcm5pbmcsIk5vIGNsaWVudCBtZXRob2Qgd2l0aCB0aGUgbmFtZSAnIitpbnZvY2F0aW9uTWVzc2FnZS50YXJnZXQrIicgZm91bmQuIil9fTtIdWJDb25uZWN0aW9uLnByb3RvdHlwZS5jb25uZWN0aW9uQ2xvc2VkPWZ1bmN0aW9uKGVycm9yKXt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siTG9nTGV2ZWwiXS5EZWJ1ZywiSHViQ29ubmVjdGlvbi5jb25uZWN0aW9uQ2xvc2VkKCIrZXJyb3IrIikgY2FsbGVkIHdoaWxlIGluIHN0YXRlICIrdGhpcy5jb25uZWN0aW9uU3RhdGUrIi4iKTt0aGlzLnN0b3BEdXJpbmdTdGFydEVycm9yPXRoaXMuc3RvcER1cmluZ1N0YXJ0RXJyb3J8fGVycm9yfHxuZXcgRXJyb3IoIlRoZSB1bmRlcmx5aW5nIGNvbm5lY3Rpb24gd2FzIGNsb3NlZCBiZWZvcmUgdGhlIGh1YiBoYW5kc2hha2UgY291bGQgY29tcGxldGUuIik7aWYodGhpcy5oYW5kc2hha2VSZXNvbHZlcil7dGhpcy5oYW5kc2hha2VSZXNvbHZlcigpfXRoaXMuY2FuY2VsQ2FsbGJhY2tzV2l0aEVycm9yKGVycm9yfHxuZXcgRXJyb3IoIkludm9jYXRpb24gY2FuY2VsZWQgZHVlIHRvIHRoZSB1bmRlcmx5aW5nIGNvbm5lY3Rpb24gYmVpbmcgY2xvc2VkLiIpKTt0aGlzLmNsZWFudXBUaW1lb3V0KCk7dGhpcy5jbGVhbnVwUGluZ1RpbWVyKCk7aWYodGhpcy5jb25uZWN0aW9uU3RhdGU9PT1IdWJDb25uZWN0aW9uU3RhdGUuRGlzY29ubmVjdGluZyl7dGhpcy5jb21wbGV0ZUNsb3NlKGVycm9yKX1lbHNlIGlmKHRoaXMuY29ubmVjdGlvblN0YXRlPT09SHViQ29ubmVjdGlvblN0YXRlLkNvbm5lY3RlZCYmdGhpcy5yZWNvbm5lY3RQb2xpY3kpe3RoaXMucmVjb25uZWN0KGVycm9yKX1lbHNlIGlmKHRoaXMuY29ubmVjdGlvblN0YXRlPT09SHViQ29ubmVjdGlvblN0YXRlLkNvbm5lY3RlZCl7dGhpcy5jb21wbGV0ZUNsb3NlKGVycm9yKX19O0h1YkNvbm5lY3Rpb24ucHJvdG90eXBlLmNvbXBsZXRlQ2xvc2U9ZnVuY3Rpb24oZXJyb3Ipe3ZhciBfdGhpcz10aGlzO2lmKHRoaXMuY29ubmVjdGlvblN0YXJ0ZWQpe3RoaXMuY29ubmVjdGlvblN0YXRlPUh1YkNvbm5lY3Rpb25TdGF0ZS5EaXNjb25uZWN0ZWQ7dGhpcy5jb25uZWN0aW9uU3RhcnRlZD1mYWxzZTt0cnl7dGhpcy5jbG9zZWRDYWxsYmFja3MuZm9yRWFjaChmdW5jdGlvbihjKXtyZXR1cm4gYy5hcHBseShfdGhpcyxbZXJyb3JdKX0pfWNhdGNoKGUpe3RoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJMb2dMZXZlbCJdLkVycm9yLCJBbiBvbmNsb3NlIGNhbGxiYWNrIGNhbGxlZCB3aXRoIGVycm9yICciK2Vycm9yKyInIHRocmV3IGVycm9yICciK2UrIicuIil9fX07SHViQ29ubmVjdGlvbi5wcm90b3R5cGUucmVjb25uZWN0PWZ1bmN0aW9uKGVycm9yKXtyZXR1cm4gX19hd2FpdGVyKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbigpe3ZhciByZWNvbm5lY3RTdGFydFRpbWUscHJldmlvdXNSZWNvbm5lY3RBdHRlbXB0cyxyZXRyeUVycm9yLG5leHRSZXRyeURlbGF5LGVfNDt2YXIgX3RoaXM9dGhpcztyZXR1cm4gX19nZW5lcmF0b3IodGhpcyxmdW5jdGlvbihfYSl7c3dpdGNoKF9hLmxhYmVsKXtjYXNlIDA6cmVjb25uZWN0U3RhcnRUaW1lPURhdGUubm93KCk7cHJldmlvdXNSZWNvbm5lY3RBdHRlbXB0cz0wO3JldHJ5RXJyb3I9ZXJyb3IhPT11bmRlZmluZWQ/ZXJyb3I6bmV3IEVycm9yKCJBdHRlbXB0aW5nIHRvIHJlY29ubmVjdCBkdWUgdG8gYSB1bmtub3duIGVycm9yLiIpO25leHRSZXRyeURlbGF5PXRoaXMuZ2V0TmV4dFJldHJ5RGVsYXkocHJldmlvdXNSZWNvbm5lY3RBdHRlbXB0cysrLDAscmV0cnlFcnJvcik7aWYobmV4dFJldHJ5RGVsYXk9PT1udWxsKXt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siTG9nTGV2ZWwiXS5EZWJ1ZywiQ29ubmVjdGlvbiBub3QgcmVjb25uZWN0aW5nIGJlY2F1c2UgdGhlIElSZXRyeVBvbGljeSByZXR1cm5lZCBudWxsIG9uIHRoZSBmaXJzdCByZWNvbm5lY3QgYXR0ZW1wdC4iKTt0aGlzLmNvbXBsZXRlQ2xvc2UoZXJyb3IpO3JldHVyblsyXX10aGlzLmNvbm5lY3Rpb25TdGF0ZT1IdWJDb25uZWN0aW9uU3RhdGUuUmVjb25uZWN0aW5nO2lmKGVycm9yKXt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siTG9nTGV2ZWwiXS5JbmZvcm1hdGlvbiwiQ29ubmVjdGlvbiByZWNvbm5lY3RpbmcgYmVjYXVzZSBvZiBlcnJvciAnIitlcnJvcisiJy4iKX1lbHNle3RoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJMb2dMZXZlbCJdLkluZm9ybWF0aW9uLCJDb25uZWN0aW9uIHJlY29ubmVjdGluZy4iKX1pZih0aGlzLm9ucmVjb25uZWN0aW5nKXt0cnl7dGhpcy5yZWNvbm5lY3RpbmdDYWxsYmFja3MuZm9yRWFjaChmdW5jdGlvbihjKXtyZXR1cm4gYy5hcHBseShfdGhpcyxbZXJyb3JdKX0pfWNhdGNoKGUpe3RoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJMb2dMZXZlbCJdLkVycm9yLCJBbiBvbnJlY29ubmVjdGluZyBjYWxsYmFjayBjYWxsZWQgd2l0aCBlcnJvciAnIitlcnJvcisiJyB0aHJldyBlcnJvciAnIitlKyInLiIpfWlmKHRoaXMuY29ubmVjdGlvblN0YXRlIT09SHViQ29ubmVjdGlvblN0YXRlLlJlY29ubmVjdGluZyl7dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIkxvZ0xldmVsIl0uRGVidWcsIkNvbm5lY3Rpb24gbGVmdCB0aGUgcmVjb25uZWN0aW5nIHN0YXRlIGluIG9ucmVjb25uZWN0aW5nIGNhbGxiYWNrLiBEb25lIHJlY29ubmVjdGluZy4iKTtyZXR1cm5bMl19fV9hLmxhYmVsPTE7Y2FzZSAxOmlmKCEobmV4dFJldHJ5RGVsYXkhPT1udWxsKSlyZXR1cm5bMyw3XTt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siTG9nTGV2ZWwiXS5JbmZvcm1hdGlvbiwiUmVjb25uZWN0IGF0dGVtcHQgbnVtYmVyICIrcHJldmlvdXNSZWNvbm5lY3RBdHRlbXB0cysiIHdpbGwgc3RhcnQgaW4gIituZXh0UmV0cnlEZWxheSsiIG1zLiIpO3JldHVybls0LG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUpe190aGlzLnJlY29ubmVjdERlbGF5SGFuZGxlPXNldFRpbWVvdXQocmVzb2x2ZSxuZXh0UmV0cnlEZWxheSl9KV07Y2FzZSAyOl9hLnNlbnQoKTt0aGlzLnJlY29ubmVjdERlbGF5SGFuZGxlPXVuZGVmaW5lZDtpZih0aGlzLmNvbm5lY3Rpb25TdGF0ZSE9PUh1YkNvbm5lY3Rpb25TdGF0ZS5SZWNvbm5lY3Rpbmcpe3RoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJMb2dMZXZlbCJdLkRlYnVnLCJDb25uZWN0aW9uIGxlZnQgdGhlIHJlY29ubmVjdGluZyBzdGF0ZSBkdXJpbmcgcmVjb25uZWN0IGRlbGF5LiBEb25lIHJlY29ubmVjdGluZy4iKTtyZXR1cm5bMl19X2EubGFiZWw9MztjYXNlIDM6X2EudHJ5cy5wdXNoKFszLDUsLDZdKTtyZXR1cm5bNCx0aGlzLnN0YXJ0SW50ZXJuYWwoKV07Y2FzZSA0Ol9hLnNlbnQoKTt0aGlzLmNvbm5lY3Rpb25TdGF0ZT1IdWJDb25uZWN0aW9uU3RhdGUuQ29ubmVjdGVkO3RoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJMb2dMZXZlbCJdLkluZm9ybWF0aW9uLCJIdWJDb25uZWN0aW9uIHJlY29ubmVjdGVkIHN1Y2Nlc3NmdWxseS4iKTtpZih0aGlzLm9ucmVjb25uZWN0ZWQpe3RyeXt0aGlzLnJlY29ubmVjdGVkQ2FsbGJhY2tzLmZvckVhY2goZnVuY3Rpb24oYyl7cmV0dXJuIGMuYXBwbHkoX3RoaXMsW190aGlzLmNvbm5lY3Rpb24uY29ubmVjdGlvbklkXSl9KX1jYXRjaChlKXt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siTG9nTGV2ZWwiXS5FcnJvciwiQW4gb25yZWNvbm5lY3RlZCBjYWxsYmFjayBjYWxsZWQgd2l0aCBjb25uZWN0aW9uSWQgJyIrdGhpcy5jb25uZWN0aW9uLmNvbm5lY3Rpb25JZCsiOyB0aHJldyBlcnJvciAnIitlKyInLiIpfX1yZXR1cm5bMl07Y2FzZSA1OmVfND1fYS5zZW50KCk7dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIkxvZ0xldmVsIl0uSW5mb3JtYXRpb24sIlJlY29ubmVjdCBhdHRlbXB0IGZhaWxlZCBiZWNhdXNlIG9mIGVycm9yICciK2VfNCsiJy4iKTtpZih0aGlzLmNvbm5lY3Rpb25TdGF0ZSE9PUh1YkNvbm5lY3Rpb25TdGF0ZS5SZWNvbm5lY3Rpbmcpe3RoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJMb2dMZXZlbCJdLkRlYnVnLCJDb25uZWN0aW9uIGxlZnQgdGhlIHJlY29ubmVjdGluZyBzdGF0ZSBkdXJpbmcgcmVjb25uZWN0IGF0dGVtcHQuIERvbmUgcmVjb25uZWN0aW5nLiIpO3JldHVyblsyXX1yZXRyeUVycm9yPWVfNCBpbnN0YW5jZW9mIEVycm9yP2VfNDpuZXcgRXJyb3IoZV80LnRvU3RyaW5nKCkpO25leHRSZXRyeURlbGF5PXRoaXMuZ2V0TmV4dFJldHJ5RGVsYXkocHJldmlvdXNSZWNvbm5lY3RBdHRlbXB0cysrLERhdGUubm93KCktcmVjb25uZWN0U3RhcnRUaW1lLHJldHJ5RXJyb3IpO3JldHVyblszLDZdO2Nhc2UgNjpyZXR1cm5bMywxXTtjYXNlIDc6dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIkxvZ0xldmVsIl0uSW5mb3JtYXRpb24sIlJlY29ubmVjdCByZXRyaWVzIGhhdmUgYmVlbiBleGhhdXN0ZWQgYWZ0ZXIgIisoRGF0ZS5ub3coKS1yZWNvbm5lY3RTdGFydFRpbWUpKyIgbXMgYW5kICIrcHJldmlvdXNSZWNvbm5lY3RBdHRlbXB0cysiIGZhaWxlZCBhdHRlbXB0cy4gQ29ubmVjdGlvbiBkaXNjb25uZWN0aW5nLiIpO3RoaXMuY29tcGxldGVDbG9zZSgpO3JldHVyblsyXX19KX0pfTtIdWJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXROZXh0UmV0cnlEZWxheT1mdW5jdGlvbihwcmV2aW91c1JldHJ5Q291bnQsZWxhcHNlZE1pbGxpc2Vjb25kcyxyZXRyeVJlYXNvbil7dHJ5e3JldHVybiB0aGlzLnJlY29ubmVjdFBvbGljeS5uZXh0UmV0cnlEZWxheUluTWlsbGlzZWNvbmRzKHtlbGFwc2VkTWlsbGlzZWNvbmRzOmVsYXBzZWRNaWxsaXNlY29uZHMscHJldmlvdXNSZXRyeUNvdW50OnByZXZpb3VzUmV0cnlDb3VudCxyZXRyeVJlYXNvbjpyZXRyeVJlYXNvbn0pfWNhdGNoKGUpe3RoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJMb2dMZXZlbCJdLkVycm9yLCJJUmV0cnlQb2xpY3kubmV4dFJldHJ5RGVsYXlJbk1pbGxpc2Vjb25kcygiK3ByZXZpb3VzUmV0cnlDb3VudCsiLCAiK2VsYXBzZWRNaWxsaXNlY29uZHMrIikgdGhyZXcgZXJyb3IgJyIrZSsiJy4iKTtyZXR1cm4gbnVsbH19O0h1YkNvbm5lY3Rpb24ucHJvdG90eXBlLmNhbmNlbENhbGxiYWNrc1dpdGhFcnJvcj1mdW5jdGlvbihlcnJvcil7dmFyIGNhbGxiYWNrcz10aGlzLmNhbGxiYWNrczt0aGlzLmNhbGxiYWNrcz17fTtPYmplY3Qua2V5cyhjYWxsYmFja3MpLmZvckVhY2goZnVuY3Rpb24oa2V5KXt2YXIgY2FsbGJhY2s9Y2FsbGJhY2tzW2tleV07Y2FsbGJhY2sobnVsbCxlcnJvcil9KX07SHViQ29ubmVjdGlvbi5wcm90b3R5cGUuY2xlYW51cFBpbmdUaW1lcj1mdW5jdGlvbigpe2lmKHRoaXMucGluZ1NlcnZlckhhbmRsZSl7Y2xlYXJUaW1lb3V0KHRoaXMucGluZ1NlcnZlckhhbmRsZSl9fTtIdWJDb25uZWN0aW9uLnByb3RvdHlwZS5jbGVhbnVwVGltZW91dD1mdW5jdGlvbigpe2lmKHRoaXMudGltZW91dEhhbmRsZSl7Y2xlYXJUaW1lb3V0KHRoaXMudGltZW91dEhhbmRsZSl9fTtIdWJDb25uZWN0aW9uLnByb3RvdHlwZS5jcmVhdGVJbnZvY2F0aW9uPWZ1bmN0aW9uKG1ldGhvZE5hbWUsYXJncyxub25ibG9ja2luZyxzdHJlYW1JZHMpe2lmKG5vbmJsb2NraW5nKXtpZihzdHJlYW1JZHMubGVuZ3RoIT09MCl7cmV0dXJue2FyZ3VtZW50czphcmdzLHN0cmVhbUlkczpzdHJlYW1JZHMsdGFyZ2V0Om1ldGhvZE5hbWUsdHlwZTpfSUh1YlByb3RvY29sX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIk1lc3NhZ2VUeXBlIl0uSW52b2NhdGlvbn19ZWxzZXtyZXR1cm57YXJndW1lbnRzOmFyZ3MsdGFyZ2V0Om1ldGhvZE5hbWUsdHlwZTpfSUh1YlByb3RvY29sX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIk1lc3NhZ2VUeXBlIl0uSW52b2NhdGlvbn19fWVsc2V7dmFyIGludm9jYXRpb25JZD10aGlzLmludm9jYXRpb25JZDt0aGlzLmludm9jYXRpb25JZCsrO2lmKHN0cmVhbUlkcy5sZW5ndGghPT0wKXtyZXR1cm57YXJndW1lbnRzOmFyZ3MsaW52b2NhdGlvbklkOmludm9jYXRpb25JZC50b1N0cmluZygpLHN0cmVhbUlkczpzdHJlYW1JZHMsdGFyZ2V0Om1ldGhvZE5hbWUsdHlwZTpfSUh1YlByb3RvY29sX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIk1lc3NhZ2VUeXBlIl0uSW52b2NhdGlvbn19ZWxzZXtyZXR1cm57YXJndW1lbnRzOmFyZ3MsaW52b2NhdGlvbklkOmludm9jYXRpb25JZC50b1N0cmluZygpLHRhcmdldDptZXRob2ROYW1lLHR5cGU6X0lIdWJQcm90b2NvbF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJNZXNzYWdlVHlwZSJdLkludm9jYXRpb259fX19O0h1YkNvbm5lY3Rpb24ucHJvdG90eXBlLmxhdW5jaFN0cmVhbXM9ZnVuY3Rpb24oc3RyZWFtcyxwcm9taXNlUXVldWUpe3ZhciBfdGhpcz10aGlzO2lmKHN0cmVhbXMubGVuZ3RoPT09MCl7cmV0dXJufWlmKCFwcm9taXNlUXVldWUpe3Byb21pc2VRdWV1ZT1Qcm9taXNlLnJlc29sdmUoKX12YXIgX2xvb3BfMT1mdW5jdGlvbihzdHJlYW1JZCl7c3RyZWFtc1tzdHJlYW1JZF0uc3Vic2NyaWJlKHtjb21wbGV0ZTpmdW5jdGlvbigpe3Byb21pc2VRdWV1ZT1wcm9taXNlUXVldWUudGhlbihmdW5jdGlvbigpe3JldHVybiBfdGhpcy5zZW5kV2l0aFByb3RvY29sKF90aGlzLmNyZWF0ZUNvbXBsZXRpb25NZXNzYWdlKHN0cmVhbUlkKSl9KX0sZXJyb3I6ZnVuY3Rpb24oZXJyKXt2YXIgbWVzc2FnZTtpZihlcnIgaW5zdGFuY2VvZiBFcnJvcil7bWVzc2FnZT1lcnIubWVzc2FnZX1lbHNlIGlmKGVyciYmZXJyLnRvU3RyaW5nKXttZXNzYWdlPWVyci50b1N0cmluZygpfWVsc2V7bWVzc2FnZT0iVW5rbm93biBlcnJvciJ9cHJvbWlzZVF1ZXVlPXByb21pc2VRdWV1ZS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIF90aGlzLnNlbmRXaXRoUHJvdG9jb2woX3RoaXMuY3JlYXRlQ29tcGxldGlvbk1lc3NhZ2Uoc3RyZWFtSWQsbWVzc2FnZSkpfSl9LG5leHQ6ZnVuY3Rpb24oaXRlbSl7cHJvbWlzZVF1ZXVlPXByb21pc2VRdWV1ZS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIF90aGlzLnNlbmRXaXRoUHJvdG9jb2woX3RoaXMuY3JlYXRlU3RyZWFtSXRlbU1lc3NhZ2Uoc3RyZWFtSWQsaXRlbSkpfSl9fSl9O2Zvcih2YXIgc3RyZWFtSWQgaW4gc3RyZWFtcyl7X2xvb3BfMShzdHJlYW1JZCl9fTtIdWJDb25uZWN0aW9uLnByb3RvdHlwZS5yZXBsYWNlU3RyZWFtaW5nUGFyYW1zPWZ1bmN0aW9uKGFyZ3Mpe3ZhciBzdHJlYW1zPVtdO3ZhciBzdHJlYW1JZHM9W107Zm9yKHZhciBpPTA7aTxhcmdzLmxlbmd0aDtpKyspe3ZhciBhcmd1bWVudD1hcmdzW2ldO2lmKHRoaXMuaXNPYnNlcnZhYmxlKGFyZ3VtZW50KSl7dmFyIHN0cmVhbUlkPXRoaXMuaW52b2NhdGlvbklkO3RoaXMuaW52b2NhdGlvbklkKys7c3RyZWFtc1tzdHJlYW1JZF09YXJndW1lbnQ7c3RyZWFtSWRzLnB1c2goc3RyZWFtSWQudG9TdHJpbmcoKSk7YXJncy5zcGxpY2UoaSwxKX19cmV0dXJuW3N0cmVhbXMsc3RyZWFtSWRzXX07SHViQ29ubmVjdGlvbi5wcm90b3R5cGUuaXNPYnNlcnZhYmxlPWZ1bmN0aW9uKGFyZyl7cmV0dXJuIGFyZyYmYXJnLnN1YnNjcmliZSYmdHlwZW9mIGFyZy5zdWJzY3JpYmU9PT0iZnVuY3Rpb24ifTtIdWJDb25uZWN0aW9uLnByb3RvdHlwZS5jcmVhdGVTdHJlYW1JbnZvY2F0aW9uPWZ1bmN0aW9uKG1ldGhvZE5hbWUsYXJncyxzdHJlYW1JZHMpe3ZhciBpbnZvY2F0aW9uSWQ9dGhpcy5pbnZvY2F0aW9uSWQ7dGhpcy5pbnZvY2F0aW9uSWQrKztpZihzdHJlYW1JZHMubGVuZ3RoIT09MCl7cmV0dXJue2FyZ3VtZW50czphcmdzLGludm9jYXRpb25JZDppbnZvY2F0aW9uSWQudG9TdHJpbmcoKSxzdHJlYW1JZHM6c3RyZWFtSWRzLHRhcmdldDptZXRob2ROYW1lLHR5cGU6X0lIdWJQcm90b2NvbF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJNZXNzYWdlVHlwZSJdLlN0cmVhbUludm9jYXRpb259fWVsc2V7cmV0dXJue2FyZ3VtZW50czphcmdzLGludm9jYXRpb25JZDppbnZvY2F0aW9uSWQudG9TdHJpbmcoKSx0YXJnZXQ6bWV0aG9kTmFtZSx0eXBlOl9JSHViUHJvdG9jb2xfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siTWVzc2FnZVR5cGUiXS5TdHJlYW1JbnZvY2F0aW9ufX19O0h1YkNvbm5lY3Rpb24ucHJvdG90eXBlLmNyZWF0ZUNhbmNlbEludm9jYXRpb249ZnVuY3Rpb24oaWQpe3JldHVybntpbnZvY2F0aW9uSWQ6aWQsdHlwZTpfSUh1YlByb3RvY29sX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIk1lc3NhZ2VUeXBlIl0uQ2FuY2VsSW52b2NhdGlvbn19O0h1YkNvbm5lY3Rpb24ucHJvdG90eXBlLmNyZWF0ZVN0cmVhbUl0ZW1NZXNzYWdlPWZ1bmN0aW9uKGlkLGl0ZW0pe3JldHVybntpbnZvY2F0aW9uSWQ6aWQsaXRlbTppdGVtLHR5cGU6X0lIdWJQcm90b2NvbF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJNZXNzYWdlVHlwZSJdLlN0cmVhbUl0ZW19fTtIdWJDb25uZWN0aW9uLnByb3RvdHlwZS5jcmVhdGVDb21wbGV0aW9uTWVzc2FnZT1mdW5jdGlvbihpZCxlcnJvcixyZXN1bHQpe2lmKGVycm9yKXtyZXR1cm57ZXJyb3I6ZXJyb3IsaW52b2NhdGlvbklkOmlkLHR5cGU6X0lIdWJQcm90b2NvbF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJNZXNzYWdlVHlwZSJdLkNvbXBsZXRpb259fXJldHVybntpbnZvY2F0aW9uSWQ6aWQscmVzdWx0OnJlc3VsdCx0eXBlOl9JSHViUHJvdG9jb2xfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siTWVzc2FnZVR5cGUiXS5Db21wbGV0aW9ufX07cmV0dXJuIEh1YkNvbm5lY3Rpb259KCl9LGZ1bmN0aW9uKG1vZHVsZSxfX3dlYnBhY2tfZXhwb3J0c19fLF9fd2VicGFja19yZXF1aXJlX18peyJ1c2Ugc3RyaWN0IjtfX3dlYnBhY2tfcmVxdWlyZV9fLnIoX193ZWJwYWNrX2V4cG9ydHNfXyk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIkhhbmRzaGFrZVByb3RvY29sIixmdW5jdGlvbigpe3JldHVybiBIYW5kc2hha2VQcm90b2NvbH0pO3ZhciBfVGV4dE1lc3NhZ2VGb3JtYXRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfXz1fX3dlYnBhY2tfcmVxdWlyZV9fKDE0KTt2YXIgX1V0aWxzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX189X193ZWJwYWNrX3JlcXVpcmVfXyg5KTt2YXIgSGFuZHNoYWtlUHJvdG9jb2w9ZnVuY3Rpb24oKXtmdW5jdGlvbiBIYW5kc2hha2VQcm90b2NvbCgpe31IYW5kc2hha2VQcm90b2NvbC5wcm90b3R5cGUud3JpdGVIYW5kc2hha2VSZXF1ZXN0PWZ1bmN0aW9uKGhhbmRzaGFrZVJlcXVlc3Qpe3JldHVybiBfVGV4dE1lc3NhZ2VGb3JtYXRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX1siVGV4dE1lc3NhZ2VGb3JtYXQiXS53cml0ZShKU09OLnN0cmluZ2lmeShoYW5kc2hha2VSZXF1ZXN0KSl9O0hhbmRzaGFrZVByb3RvY29sLnByb3RvdHlwZS5wYXJzZUhhbmRzaGFrZVJlc3BvbnNlPWZ1bmN0aW9uKGRhdGEpe3ZhciByZXNwb25zZU1lc3NhZ2U7dmFyIG1lc3NhZ2VEYXRhO3ZhciByZW1haW5pbmdEYXRhO2lmKE9iamVjdChfVXRpbHNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siaXNBcnJheUJ1ZmZlciJdKShkYXRhKXx8dHlwZW9mIEJ1ZmZlciE9PSJ1bmRlZmluZWQiJiZkYXRhIGluc3RhbmNlb2YgQnVmZmVyKXt2YXIgYmluYXJ5RGF0YT1uZXcgVWludDhBcnJheShkYXRhKTt2YXIgc2VwYXJhdG9ySW5kZXg9YmluYXJ5RGF0YS5pbmRleE9mKF9UZXh0TWVzc2FnZUZvcm1hdF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fWyJUZXh0TWVzc2FnZUZvcm1hdCJdLlJlY29yZFNlcGFyYXRvckNvZGUpO2lmKHNlcGFyYXRvckluZGV4PT09LTEpe3Rocm93IG5ldyBFcnJvcigiTWVzc2FnZSBpcyBpbmNvbXBsZXRlLiIpfXZhciByZXNwb25zZUxlbmd0aD1zZXBhcmF0b3JJbmRleCsxO21lc3NhZ2VEYXRhPVN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCxiaW5hcnlEYXRhLnNsaWNlKDAscmVzcG9uc2VMZW5ndGgpKTtyZW1haW5pbmdEYXRhPWJpbmFyeURhdGEuYnl0ZUxlbmd0aD5yZXNwb25zZUxlbmd0aD9iaW5hcnlEYXRhLnNsaWNlKHJlc3BvbnNlTGVuZ3RoKS5idWZmZXI6bnVsbH1lbHNle3ZhciB0ZXh0RGF0YT1kYXRhO3ZhciBzZXBhcmF0b3JJbmRleD10ZXh0RGF0YS5pbmRleE9mKF9UZXh0TWVzc2FnZUZvcm1hdF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fWyJUZXh0TWVzc2FnZUZvcm1hdCJdLlJlY29yZFNlcGFyYXRvcik7aWYoc2VwYXJhdG9ySW5kZXg9PT0tMSl7dGhyb3cgbmV3IEVycm9yKCJNZXNzYWdlIGlzIGluY29tcGxldGUuIil9dmFyIHJlc3BvbnNlTGVuZ3RoPXNlcGFyYXRvckluZGV4KzE7bWVzc2FnZURhdGE9dGV4dERhdGEuc3Vic3RyaW5nKDAscmVzcG9uc2VMZW5ndGgpO3JlbWFpbmluZ0RhdGE9dGV4dERhdGEubGVuZ3RoPnJlc3BvbnNlTGVuZ3RoP3RleHREYXRhLnN1YnN0cmluZyhyZXNwb25zZUxlbmd0aCk6bnVsbH12YXIgbWVzc2FnZXM9X1RleHRNZXNzYWdlRm9ybWF0X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19bIlRleHRNZXNzYWdlRm9ybWF0Il0ucGFyc2UobWVzc2FnZURhdGEpO3ZhciByZXNwb25zZT1KU09OLnBhcnNlKG1lc3NhZ2VzWzBdKTtpZihyZXNwb25zZS50eXBlKXt0aHJvdyBuZXcgRXJyb3IoIkV4cGVjdGVkIGEgaGFuZHNoYWtlIHJlc3BvbnNlIGZyb20gdGhlIHNlcnZlci4iKX1yZXNwb25zZU1lc3NhZ2U9cmVzcG9uc2U7cmV0dXJuW3JlbWFpbmluZ0RhdGEscmVzcG9uc2VNZXNzYWdlXX07cmV0dXJuIEhhbmRzaGFrZVByb3RvY29sfSgpfSxmdW5jdGlvbihtb2R1bGUsX193ZWJwYWNrX2V4cG9ydHNfXyxfX3dlYnBhY2tfcmVxdWlyZV9fKXsidXNlIHN0cmljdCI7X193ZWJwYWNrX3JlcXVpcmVfXy5yKF9fd2VicGFja19leHBvcnRzX18pO19fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCJUZXh0TWVzc2FnZUZvcm1hdCIsZnVuY3Rpb24oKXtyZXR1cm4gVGV4dE1lc3NhZ2VGb3JtYXR9KTt2YXIgVGV4dE1lc3NhZ2VGb3JtYXQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBUZXh0TWVzc2FnZUZvcm1hdCgpe31UZXh0TWVzc2FnZUZvcm1hdC53cml0ZT1mdW5jdGlvbihvdXRwdXQpe3JldHVybiIiK291dHB1dCtUZXh0TWVzc2FnZUZvcm1hdC5SZWNvcmRTZXBhcmF0b3J9O1RleHRNZXNzYWdlRm9ybWF0LnBhcnNlPWZ1bmN0aW9uKGlucHV0KXtpZihpbnB1dFtpbnB1dC5sZW5ndGgtMV0hPT1UZXh0TWVzc2FnZUZvcm1hdC5SZWNvcmRTZXBhcmF0b3Ipe3Rocm93IG5ldyBFcnJvcigiTWVzc2FnZSBpcyBpbmNvbXBsZXRlLiIpfXZhciBtZXNzYWdlcz1pbnB1dC5zcGxpdChUZXh0TWVzc2FnZUZvcm1hdC5SZWNvcmRTZXBhcmF0b3IpO21lc3NhZ2VzLnBvcCgpO3JldHVybiBtZXNzYWdlc307VGV4dE1lc3NhZ2VGb3JtYXQuUmVjb3JkU2VwYXJhdG9yQ29kZT0zMDtUZXh0TWVzc2FnZUZvcm1hdC5SZWNvcmRTZXBhcmF0b3I9U3RyaW5nLmZyb21DaGFyQ29kZShUZXh0TWVzc2FnZUZvcm1hdC5SZWNvcmRTZXBhcmF0b3JDb2RlKTtyZXR1cm4gVGV4dE1lc3NhZ2VGb3JtYXR9KCl9LGZ1bmN0aW9uKG1vZHVsZSxfX3dlYnBhY2tfZXhwb3J0c19fLF9fd2VicGFja19yZXF1aXJlX18peyJ1c2Ugc3RyaWN0IjtfX3dlYnBhY2tfcmVxdWlyZV9fLnIoX193ZWJwYWNrX2V4cG9ydHNfXyk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIk1lc3NhZ2VUeXBlIixmdW5jdGlvbigpe3JldHVybiBNZXNzYWdlVHlwZX0pO3ZhciBNZXNzYWdlVHlwZTsoZnVuY3Rpb24oTWVzc2FnZVR5cGUpe01lc3NhZ2VUeXBlW01lc3NhZ2VUeXBlWyJJbnZvY2F0aW9uIl09MV09Ikludm9jYXRpb24iO01lc3NhZ2VUeXBlW01lc3NhZ2VUeXBlWyJTdHJlYW1JdGVtIl09Ml09IlN0cmVhbUl0ZW0iO01lc3NhZ2VUeXBlW01lc3NhZ2VUeXBlWyJDb21wbGV0aW9uIl09M109IkNvbXBsZXRpb24iO01lc3NhZ2VUeXBlW01lc3NhZ2VUeXBlWyJTdHJlYW1JbnZvY2F0aW9uIl09NF09IlN0cmVhbUludm9jYXRpb24iO01lc3NhZ2VUeXBlW01lc3NhZ2VUeXBlWyJDYW5jZWxJbnZvY2F0aW9uIl09NV09IkNhbmNlbEludm9jYXRpb24iO01lc3NhZ2VUeXBlW01lc3NhZ2VUeXBlWyJQaW5nIl09Nl09IlBpbmciO01lc3NhZ2VUeXBlW01lc3NhZ2VUeXBlWyJDbG9zZSJdPTddPSJDbG9zZSJ9KShNZXNzYWdlVHlwZXx8KE1lc3NhZ2VUeXBlPXt9KSl9LGZ1bmN0aW9uKG1vZHVsZSxfX3dlYnBhY2tfZXhwb3J0c19fLF9fd2VicGFja19yZXF1aXJlX18peyJ1c2Ugc3RyaWN0IjtfX3dlYnBhY2tfcmVxdWlyZV9fLnIoX193ZWJwYWNrX2V4cG9ydHNfXyk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIlN1YmplY3QiLGZ1bmN0aW9uKCl7cmV0dXJuIFN1YmplY3R9KTt2YXIgX1V0aWxzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX189X193ZWJwYWNrX3JlcXVpcmVfXyg5KTt2YXIgU3ViamVjdD1mdW5jdGlvbigpe2Z1bmN0aW9uIFN1YmplY3QoKXt0aGlzLm9ic2VydmVycz1bXX1TdWJqZWN0LnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKGl0ZW0pe2Zvcih2YXIgX2k9MCxfYT10aGlzLm9ic2VydmVycztfaTxfYS5sZW5ndGg7X2krKyl7dmFyIG9ic2VydmVyPV9hW19pXTtvYnNlcnZlci5uZXh0KGl0ZW0pfX07U3ViamVjdC5wcm90b3R5cGUuZXJyb3I9ZnVuY3Rpb24oZXJyKXtmb3IodmFyIF9pPTAsX2E9dGhpcy5vYnNlcnZlcnM7X2k8X2EubGVuZ3RoO19pKyspe3ZhciBvYnNlcnZlcj1fYVtfaV07aWYob2JzZXJ2ZXIuZXJyb3Ipe29ic2VydmVyLmVycm9yKGVycil9fX07U3ViamVjdC5wcm90b3R5cGUuY29tcGxldGU9ZnVuY3Rpb24oKXtmb3IodmFyIF9pPTAsX2E9dGhpcy5vYnNlcnZlcnM7X2k8X2EubGVuZ3RoO19pKyspe3ZhciBvYnNlcnZlcj1fYVtfaV07aWYob2JzZXJ2ZXIuY29tcGxldGUpe29ic2VydmVyLmNvbXBsZXRlKCl9fX07U3ViamVjdC5wcm90b3R5cGUuc3Vic2NyaWJlPWZ1bmN0aW9uKG9ic2VydmVyKXt0aGlzLm9ic2VydmVycy5wdXNoKG9ic2VydmVyKTtyZXR1cm4gbmV3IF9VdGlsc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fWyJTdWJqZWN0U3Vic2NyaXB0aW9uIl0odGhpcyxvYnNlcnZlcil9O3JldHVybiBTdWJqZWN0fSgpfSxmdW5jdGlvbihtb2R1bGUsX193ZWJwYWNrX2V4cG9ydHNfXyxfX3dlYnBhY2tfcmVxdWlyZV9fKXsidXNlIHN0cmljdCI7X193ZWJwYWNrX3JlcXVpcmVfXy5yKF9fd2VicGFja19leHBvcnRzX18pO19fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCJIdWJDb25uZWN0aW9uQnVpbGRlciIsZnVuY3Rpb24oKXtyZXR1cm4gSHViQ29ubmVjdGlvbkJ1aWxkZXJ9KTt2YXIgX0RlZmF1bHRSZWNvbm5lY3RQb2xpY3lfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfXz1fX3dlYnBhY2tfcmVxdWlyZV9fKDE4KTt2YXIgX0h0dHBDb25uZWN0aW9uX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX189X193ZWJwYWNrX3JlcXVpcmVfXygxOSk7dmFyIF9IdWJDb25uZWN0aW9uX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX189X193ZWJwYWNrX3JlcXVpcmVfXygxMik7dmFyIF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8zX189X193ZWJwYWNrX3JlcXVpcmVfXyg4KTt2YXIgX0pzb25IdWJQcm90b2NvbF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfNF9fPV9fd2VicGFja19yZXF1aXJlX18oMjUpO3ZhciBfTG9nZ2Vyc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfNV9fPV9fd2VicGFja19yZXF1aXJlX18oMTApO3ZhciBfVXRpbHNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzZfXz1fX3dlYnBhY2tfcmVxdWlyZV9fKDkpO3ZhciBfX2Fzc2lnbj11bmRlZmluZWQmJnVuZGVmaW5lZC5fX2Fzc2lnbnx8T2JqZWN0LmFzc2lnbnx8ZnVuY3Rpb24odCl7Zm9yKHZhciBzLGk9MSxuPWFyZ3VtZW50cy5sZW5ndGg7aTxuO2krKyl7cz1hcmd1bWVudHNbaV07Zm9yKHZhciBwIGluIHMpaWYoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMscCkpdFtwXT1zW3BdfXJldHVybiB0fTt2YXIgTG9nTGV2ZWxOYW1lTWFwcGluZz17dHJhY2U6X0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzNfX1siTG9nTGV2ZWwiXS5UcmFjZSxkZWJ1ZzpfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfM19fWyJMb2dMZXZlbCJdLkRlYnVnLGluZm86X0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzNfX1siTG9nTGV2ZWwiXS5JbmZvcm1hdGlvbixpbmZvcm1hdGlvbjpfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfM19fWyJMb2dMZXZlbCJdLkluZm9ybWF0aW9uLHdhcm46X0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzNfX1siTG9nTGV2ZWwiXS5XYXJuaW5nLHdhcm5pbmc6X0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzNfX1siTG9nTGV2ZWwiXS5XYXJuaW5nLGVycm9yOl9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8zX19bIkxvZ0xldmVsIl0uRXJyb3IsY3JpdGljYWw6X0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzNfX1siTG9nTGV2ZWwiXS5Dcml0aWNhbCxub25lOl9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8zX19bIkxvZ0xldmVsIl0uTm9uZX07ZnVuY3Rpb24gcGFyc2VMb2dMZXZlbChuYW1lKXt2YXIgbWFwcGluZz1Mb2dMZXZlbE5hbWVNYXBwaW5nW25hbWUudG9Mb3dlckNhc2UoKV07aWYodHlwZW9mIG1hcHBpbmchPT0idW5kZWZpbmVkIil7cmV0dXJuIG1hcHBpbmd9ZWxzZXt0aHJvdyBuZXcgRXJyb3IoIlVua25vd24gbG9nIGxldmVsOiAiK25hbWUpfX12YXIgSHViQ29ubmVjdGlvbkJ1aWxkZXI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBIdWJDb25uZWN0aW9uQnVpbGRlcigpe31IdWJDb25uZWN0aW9uQnVpbGRlci5wcm90b3R5cGUuY29uZmlndXJlTG9nZ2luZz1mdW5jdGlvbihsb2dnaW5nKXtfVXRpbHNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzZfX1siQXJnIl0uaXNSZXF1aXJlZChsb2dnaW5nLCJsb2dnaW5nIik7aWYoaXNMb2dnZXIobG9nZ2luZykpe3RoaXMubG9nZ2VyPWxvZ2dpbmd9ZWxzZSBpZih0eXBlb2YgbG9nZ2luZz09PSJzdHJpbmciKXt2YXIgbG9nTGV2ZWw9cGFyc2VMb2dMZXZlbChsb2dnaW5nKTt0aGlzLmxvZ2dlcj1uZXcgX1V0aWxzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV82X19bIkNvbnNvbGVMb2dnZXIiXShsb2dMZXZlbCl9ZWxzZXt0aGlzLmxvZ2dlcj1uZXcgX1V0aWxzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV82X19bIkNvbnNvbGVMb2dnZXIiXShsb2dnaW5nKX1yZXR1cm4gdGhpc307SHViQ29ubmVjdGlvbkJ1aWxkZXIucHJvdG90eXBlLndpdGhVcmw9ZnVuY3Rpb24odXJsLHRyYW5zcG9ydFR5cGVPck9wdGlvbnMpe19VdGlsc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfNl9fWyJBcmciXS5pc1JlcXVpcmVkKHVybCwidXJsIik7X1V0aWxzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV82X19bIkFyZyJdLmlzTm90RW1wdHkodXJsLCJ1cmwiKTt0aGlzLnVybD11cmw7aWYodHlwZW9mIHRyYW5zcG9ydFR5cGVPck9wdGlvbnM9PT0ib2JqZWN0Iil7dGhpcy5odHRwQ29ubmVjdGlvbk9wdGlvbnM9X19hc3NpZ24oe30sdGhpcy5odHRwQ29ubmVjdGlvbk9wdGlvbnMsdHJhbnNwb3J0VHlwZU9yT3B0aW9ucyl9ZWxzZXt0aGlzLmh0dHBDb25uZWN0aW9uT3B0aW9ucz1fX2Fzc2lnbih7fSx0aGlzLmh0dHBDb25uZWN0aW9uT3B0aW9ucyx7dHJhbnNwb3J0OnRyYW5zcG9ydFR5cGVPck9wdGlvbnN9KX1yZXR1cm4gdGhpc307SHViQ29ubmVjdGlvbkJ1aWxkZXIucHJvdG90eXBlLndpdGhIdWJQcm90b2NvbD1mdW5jdGlvbihwcm90b2NvbCl7X1V0aWxzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV82X19bIkFyZyJdLmlzUmVxdWlyZWQocHJvdG9jb2wsInByb3RvY29sIik7dGhpcy5wcm90b2NvbD1wcm90b2NvbDtyZXR1cm4gdGhpc307SHViQ29ubmVjdGlvbkJ1aWxkZXIucHJvdG90eXBlLndpdGhBdXRvbWF0aWNSZWNvbm5lY3Q9ZnVuY3Rpb24ocmV0cnlEZWxheXNPclJlY29ubmVjdFBvbGljeSl7aWYodGhpcy5yZWNvbm5lY3RQb2xpY3kpe3Rocm93IG5ldyBFcnJvcigiQSByZWNvbm5lY3RQb2xpY3kgaGFzIGFscmVhZHkgYmVlbiBzZXQuIil9aWYoIXJldHJ5RGVsYXlzT3JSZWNvbm5lY3RQb2xpY3kpe3RoaXMucmVjb25uZWN0UG9saWN5PW5ldyBfRGVmYXVsdFJlY29ubmVjdFBvbGljeV9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fWyJEZWZhdWx0UmVjb25uZWN0UG9saWN5Il19ZWxzZSBpZihBcnJheS5pc0FycmF5KHJldHJ5RGVsYXlzT3JSZWNvbm5lY3RQb2xpY3kpKXt0aGlzLnJlY29ubmVjdFBvbGljeT1uZXcgX0RlZmF1bHRSZWNvbm5lY3RQb2xpY3lfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX1siRGVmYXVsdFJlY29ubmVjdFBvbGljeSJdKHJldHJ5RGVsYXlzT3JSZWNvbm5lY3RQb2xpY3kpfWVsc2V7dGhpcy5yZWNvbm5lY3RQb2xpY3k9cmV0cnlEZWxheXNPclJlY29ubmVjdFBvbGljeX1yZXR1cm4gdGhpc307SHViQ29ubmVjdGlvbkJ1aWxkZXIucHJvdG90eXBlLmJ1aWxkPWZ1bmN0aW9uKCl7dmFyIGh0dHBDb25uZWN0aW9uT3B0aW9ucz10aGlzLmh0dHBDb25uZWN0aW9uT3B0aW9uc3x8e307aWYoaHR0cENvbm5lY3Rpb25PcHRpb25zLmxvZ2dlcj09PXVuZGVmaW5lZCl7aHR0cENvbm5lY3Rpb25PcHRpb25zLmxvZ2dlcj10aGlzLmxvZ2dlcn1pZighdGhpcy51cmwpe3Rocm93IG5ldyBFcnJvcigiVGhlICdIdWJDb25uZWN0aW9uQnVpbGRlci53aXRoVXJsJyBtZXRob2QgbXVzdCBiZSBjYWxsZWQgYmVmb3JlIGJ1aWxkaW5nIHRoZSBjb25uZWN0aW9uLiIpfXZhciBjb25uZWN0aW9uPW5ldyBfSHR0cENvbm5lY3Rpb25fX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siSHR0cENvbm5lY3Rpb24iXSh0aGlzLnVybCxodHRwQ29ubmVjdGlvbk9wdGlvbnMpO3JldHVybiBfSHViQ29ubmVjdGlvbl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJIdWJDb25uZWN0aW9uIl0uY3JlYXRlKGNvbm5lY3Rpb24sdGhpcy5sb2dnZXJ8fF9Mb2dnZXJzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV81X19bIk51bGxMb2dnZXIiXS5pbnN0YW5jZSx0aGlzLnByb3RvY29sfHxuZXcgX0pzb25IdWJQcm90b2NvbF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfNF9fWyJKc29uSHViUHJvdG9jb2wiXSx0aGlzLnJlY29ubmVjdFBvbGljeSl9O3JldHVybiBIdWJDb25uZWN0aW9uQnVpbGRlcn0oKTtmdW5jdGlvbiBpc0xvZ2dlcihsb2dnZXIpe3JldHVybiBsb2dnZXIubG9nIT09dW5kZWZpbmVkfX0sZnVuY3Rpb24obW9kdWxlLF9fd2VicGFja19leHBvcnRzX18sX193ZWJwYWNrX3JlcXVpcmVfXyl7InVzZSBzdHJpY3QiO19fd2VicGFja19yZXF1aXJlX18ucihfX3dlYnBhY2tfZXhwb3J0c19fKTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiRGVmYXVsdFJlY29ubmVjdFBvbGljeSIsZnVuY3Rpb24oKXtyZXR1cm4gRGVmYXVsdFJlY29ubmVjdFBvbGljeX0pO3ZhciBERUZBVUxUX1JFVFJZX0RFTEFZU19JTl9NSUxMSVNFQ09ORFM9WzAsMmUzLDFlNCwzZTQsbnVsbF07dmFyIERlZmF1bHRSZWNvbm5lY3RQb2xpY3k9ZnVuY3Rpb24oKXtmdW5jdGlvbiBEZWZhdWx0UmVjb25uZWN0UG9saWN5KHJldHJ5RGVsYXlzKXt0aGlzLnJldHJ5RGVsYXlzPXJldHJ5RGVsYXlzIT09dW5kZWZpbmVkP3JldHJ5RGVsYXlzLmNvbmNhdChbbnVsbF0pOkRFRkFVTFRfUkVUUllfREVMQVlTX0lOX01JTExJU0VDT05EU31EZWZhdWx0UmVjb25uZWN0UG9saWN5LnByb3RvdHlwZS5uZXh0UmV0cnlEZWxheUluTWlsbGlzZWNvbmRzPWZ1bmN0aW9uKHJldHJ5Q29udGV4dCl7cmV0dXJuIHRoaXMucmV0cnlEZWxheXNbcmV0cnlDb250ZXh0LnByZXZpb3VzUmV0cnlDb3VudF19O3JldHVybiBEZWZhdWx0UmVjb25uZWN0UG9saWN5fSgpfSxmdW5jdGlvbihtb2R1bGUsX193ZWJwYWNrX2V4cG9ydHNfXyxfX3dlYnBhY2tfcmVxdWlyZV9fKXsidXNlIHN0cmljdCI7X193ZWJwYWNrX3JlcXVpcmVfXy5yKF9fd2VicGFja19leHBvcnRzX18pO19fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCJIdHRwQ29ubmVjdGlvbiIsZnVuY3Rpb24oKXtyZXR1cm4gSHR0cENvbm5lY3Rpb259KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiVHJhbnNwb3J0U2VuZFF1ZXVlIixmdW5jdGlvbigpe3JldHVybiBUcmFuc3BvcnRTZW5kUXVldWV9KTt2YXIgX0RlZmF1bHRIdHRwQ2xpZW50X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX189X193ZWJwYWNrX3JlcXVpcmVfXyg2KTt2YXIgX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfXz1fX3dlYnBhY2tfcmVxdWlyZV9fKDgpO3ZhciBfSVRyYW5zcG9ydF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fPV9fd2VicGFja19yZXF1aXJlX18oMjApO3ZhciBfTG9uZ1BvbGxpbmdUcmFuc3BvcnRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzNfXz1fX3dlYnBhY2tfcmVxdWlyZV9fKDIxKTt2YXIgX1NlcnZlclNlbnRFdmVudHNUcmFuc3BvcnRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzRfXz1fX3dlYnBhY2tfcmVxdWlyZV9fKDIzKTt2YXIgX1V0aWxzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV81X189X193ZWJwYWNrX3JlcXVpcmVfXyg5KTt2YXIgX1dlYlNvY2tldFRyYW5zcG9ydF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfNl9fPV9fd2VicGFja19yZXF1aXJlX18oMjQpO3ZhciBfX2Fzc2lnbj11bmRlZmluZWQmJnVuZGVmaW5lZC5fX2Fzc2lnbnx8T2JqZWN0LmFzc2lnbnx8ZnVuY3Rpb24odCl7Zm9yKHZhciBzLGk9MSxuPWFyZ3VtZW50cy5sZW5ndGg7aTxuO2krKyl7cz1hcmd1bWVudHNbaV07Zm9yKHZhciBwIGluIHMpaWYoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMscCkpdFtwXT1zW3BdfXJldHVybiB0fTt2YXIgX19hd2FpdGVyPXVuZGVmaW5lZCYmdW5kZWZpbmVkLl9fYXdhaXRlcnx8ZnVuY3Rpb24odGhpc0FyZyxfYXJndW1lbnRzLFAsZ2VuZXJhdG9yKXtyZXR1cm4gbmV3KFB8fChQPVByb21pc2UpKShmdW5jdGlvbihyZXNvbHZlLHJlamVjdCl7ZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKXt0cnl7c3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpfWNhdGNoKGUpe3JlamVjdChlKX19ZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpe3RyeXtzdGVwKGdlbmVyYXRvclsidGhyb3ciXSh2YWx1ZSkpfWNhdGNoKGUpe3JlamVjdChlKX19ZnVuY3Rpb24gc3RlcChyZXN1bHQpe3Jlc3VsdC5kb25lP3Jlc29sdmUocmVzdWx0LnZhbHVlKTpuZXcgUChmdW5jdGlvbihyZXNvbHZlKXtyZXNvbHZlKHJlc3VsdC52YWx1ZSl9KS50aGVuKGZ1bGZpbGxlZCxyZWplY3RlZCl9c3RlcCgoZ2VuZXJhdG9yPWdlbmVyYXRvci5hcHBseSh0aGlzQXJnLF9hcmd1bWVudHN8fFtdKSkubmV4dCgpKX0pfTt2YXIgX19nZW5lcmF0b3I9dW5kZWZpbmVkJiZ1bmRlZmluZWQuX19nZW5lcmF0b3J8fGZ1bmN0aW9uKHRoaXNBcmcsYm9keSl7dmFyIF89e2xhYmVsOjAsc2VudDpmdW5jdGlvbigpe2lmKHRbMF0mMSl0aHJvdyB0WzFdO3JldHVybiB0WzFdfSx0cnlzOltdLG9wczpbXX0sZix5LHQsZztyZXR1cm4gZz17bmV4dDp2ZXJiKDApLHRocm93OnZlcmIoMSkscmV0dXJuOnZlcmIoMil9LHR5cGVvZiBTeW1ib2w9PT0iZnVuY3Rpb24iJiYoZ1tTeW1ib2wuaXRlcmF0b3JdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KSxnO2Z1bmN0aW9uIHZlcmIobil7cmV0dXJuIGZ1bmN0aW9uKHYpe3JldHVybiBzdGVwKFtuLHZdKX19ZnVuY3Rpb24gc3RlcChvcCl7aWYoZil0aHJvdyBuZXcgVHlwZUVycm9yKCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuIik7d2hpbGUoXyl0cnl7aWYoZj0xLHkmJih0PW9wWzBdJjI/eVsicmV0dXJuIl06b3BbMF0/eVsidGhyb3ciXXx8KCh0PXlbInJldHVybiJdKSYmdC5jYWxsKHkpLDApOnkubmV4dCkmJiEodD10LmNhbGwoeSxvcFsxXSkpLmRvbmUpcmV0dXJuIHQ7aWYoeT0wLHQpb3A9W29wWzBdJjIsdC52YWx1ZV07c3dpdGNoKG9wWzBdKXtjYXNlIDA6Y2FzZSAxOnQ9b3A7YnJlYWs7Y2FzZSA0Ol8ubGFiZWwrKztyZXR1cm57dmFsdWU6b3BbMV0sZG9uZTpmYWxzZX07Y2FzZSA1Ol8ubGFiZWwrKzt5PW9wWzFdO29wPVswXTtjb250aW51ZTtjYXNlIDc6b3A9Xy5vcHMucG9wKCk7Xy50cnlzLnBvcCgpO2NvbnRpbnVlO2RlZmF1bHQ6aWYoISh0PV8udHJ5cyx0PXQubGVuZ3RoPjAmJnRbdC5sZW5ndGgtMV0pJiYob3BbMF09PT02fHxvcFswXT09PTIpKXtfPTA7Y29udGludWV9aWYob3BbMF09PT0zJiYoIXR8fG9wWzFdPnRbMF0mJm9wWzFdPHRbM10pKXtfLmxhYmVsPW9wWzFdO2JyZWFrfWlmKG9wWzBdPT09NiYmXy5sYWJlbDx0WzFdKXtfLmxhYmVsPXRbMV07dD1vcDticmVha31pZih0JiZfLmxhYmVsPHRbMl0pe18ubGFiZWw9dFsyXTtfLm9wcy5wdXNoKG9wKTticmVha31pZih0WzJdKV8ub3BzLnBvcCgpO18udHJ5cy5wb3AoKTtjb250aW51ZX1vcD1ib2R5LmNhbGwodGhpc0FyZyxfKX1jYXRjaChlKXtvcD1bNixlXTt5PTB9ZmluYWxseXtmPXQ9MH1pZihvcFswXSY1KXRocm93IG9wWzFdO3JldHVybnt2YWx1ZTpvcFswXT9vcFsxXTp2b2lkIDAsZG9uZTp0cnVlfX19O3ZhciBNQVhfUkVESVJFQ1RTPTEwMDt2YXIgSHR0cENvbm5lY3Rpb249ZnVuY3Rpb24oKXtmdW5jdGlvbiBIdHRwQ29ubmVjdGlvbih1cmwsb3B0aW9ucyl7aWYob3B0aW9ucz09PXZvaWQgMCl7b3B0aW9ucz17fX10aGlzLmZlYXR1cmVzPXt9O3RoaXMubmVnb3RpYXRlVmVyc2lvbj0xO19VdGlsc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfNV9fWyJBcmciXS5pc1JlcXVpcmVkKHVybCwidXJsIik7dGhpcy5sb2dnZXI9T2JqZWN0KF9VdGlsc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfNV9fWyJjcmVhdGVMb2dnZXIiXSkob3B0aW9ucy5sb2dnZXIpO3RoaXMuYmFzZVVybD10aGlzLnJlc29sdmVVcmwodXJsKTtvcHRpb25zPW9wdGlvbnN8fHt9O29wdGlvbnMubG9nTWVzc2FnZUNvbnRlbnQ9b3B0aW9ucy5sb2dNZXNzYWdlQ29udGVudD09PXVuZGVmaW5lZD9mYWxzZTpvcHRpb25zLmxvZ01lc3NhZ2VDb250ZW50O2lmKHR5cGVvZiBvcHRpb25zLndpdGhDcmVkZW50aWFscz09PSJib29sZWFuInx8b3B0aW9ucy53aXRoQ3JlZGVudGlhbHM9PT11bmRlZmluZWQpe29wdGlvbnMud2l0aENyZWRlbnRpYWxzPW9wdGlvbnMud2l0aENyZWRlbnRpYWxzPT09dW5kZWZpbmVkP3RydWU6b3B0aW9ucy53aXRoQ3JlZGVudGlhbHN9ZWxzZXt0aHJvdyBuZXcgRXJyb3IoIndpdGhDcmVkZW50aWFscyBvcHRpb24gd2FzIG5vdCBhICdib29sZWFuJyBvciAndW5kZWZpbmVkJyB2YWx1ZSIpfXZhciB3ZWJTb2NrZXRNb2R1bGU9bnVsbDt2YXIgZXZlbnRTb3VyY2VNb2R1bGU9bnVsbDtpZihfVXRpbHNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzVfX1siUGxhdGZvcm0iXS5pc05vZGUmJiJmdW5jdGlvbiIhPT0idW5kZWZpbmVkIil7dmFyIHJlcXVpcmVGdW5jPXRydWU/cmVxdWlyZTp1bmRlZmluZWQ7d2ViU29ja2V0TW9kdWxlPXJlcXVpcmVGdW5jKCJ3cyIpO2V2ZW50U291cmNlTW9kdWxlPXJlcXVpcmVGdW5jKCJldmVudHNvdXJjZSIpfWlmKCFfVXRpbHNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzVfX1siUGxhdGZvcm0iXS5pc05vZGUmJnR5cGVvZiBXZWJTb2NrZXQhPT0idW5kZWZpbmVkIiYmIW9wdGlvbnMuV2ViU29ja2V0KXtvcHRpb25zLldlYlNvY2tldD1XZWJTb2NrZXR9ZWxzZSBpZihfVXRpbHNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzVfX1siUGxhdGZvcm0iXS5pc05vZGUmJiFvcHRpb25zLldlYlNvY2tldCl7aWYod2ViU29ja2V0TW9kdWxlKXtvcHRpb25zLldlYlNvY2tldD13ZWJTb2NrZXRNb2R1bGV9fWlmKCFfVXRpbHNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzVfX1siUGxhdGZvcm0iXS5pc05vZGUmJnR5cGVvZiBFdmVudFNvdXJjZSE9PSJ1bmRlZmluZWQiJiYhb3B0aW9ucy5FdmVudFNvdXJjZSl7b3B0aW9ucy5FdmVudFNvdXJjZT1FdmVudFNvdXJjZX1lbHNlIGlmKF9VdGlsc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfNV9fWyJQbGF0Zm9ybSJdLmlzTm9kZSYmIW9wdGlvbnMuRXZlbnRTb3VyY2Upe2lmKHR5cGVvZiBldmVudFNvdXJjZU1vZHVsZSE9PSJ1bmRlZmluZWQiKXtvcHRpb25zLkV2ZW50U291cmNlPWV2ZW50U291cmNlTW9kdWxlfX10aGlzLmh0dHBDbGllbnQ9b3B0aW9ucy5odHRwQ2xpZW50fHxuZXcgX0RlZmF1bHRIdHRwQ2xpZW50X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19bIkRlZmF1bHRIdHRwQ2xpZW50Il0odGhpcy5sb2dnZXIpO3RoaXMuY29ubmVjdGlvblN0YXRlPSJEaXNjb25uZWN0ZWQiO3RoaXMuY29ubmVjdGlvblN0YXJ0ZWQ9ZmFsc2U7dGhpcy5vcHRpb25zPW9wdGlvbnM7dGhpcy5vbnJlY2VpdmU9bnVsbDt0aGlzLm9uY2xvc2U9bnVsbH1IdHRwQ29ubmVjdGlvbi5wcm90b3R5cGUuc3RhcnQ9ZnVuY3Rpb24odHJhbnNmZXJGb3JtYXQpe3JldHVybiBfX2F3YWl0ZXIodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKCl7dmFyIG1lc3NhZ2UsbWVzc2FnZTtyZXR1cm4gX19nZW5lcmF0b3IodGhpcyxmdW5jdGlvbihfYSl7c3dpdGNoKF9hLmxhYmVsKXtjYXNlIDA6dHJhbnNmZXJGb3JtYXQ9dHJhbnNmZXJGb3JtYXR8fF9JVHJhbnNwb3J0X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIlRyYW5zZmVyRm9ybWF0Il0uQmluYXJ5O19VdGlsc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfNV9fWyJBcmciXS5pc0luKHRyYW5zZmVyRm9ybWF0LF9JVHJhbnNwb3J0X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIlRyYW5zZmVyRm9ybWF0Il0sInRyYW5zZmVyRm9ybWF0Iik7dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIkxvZ0xldmVsIl0uRGVidWcsIlN0YXJ0aW5nIGNvbm5lY3Rpb24gd2l0aCB0cmFuc2ZlciBmb3JtYXQgJyIrX0lUcmFuc3BvcnRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siVHJhbnNmZXJGb3JtYXQiXVt0cmFuc2ZlckZvcm1hdF0rIicuIik7aWYodGhpcy5jb25uZWN0aW9uU3RhdGUhPT0iRGlzY29ubmVjdGVkIil7cmV0dXJuWzIsUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCJDYW5ub3Qgc3RhcnQgYW4gSHR0cENvbm5lY3Rpb24gdGhhdCBpcyBub3QgaW4gdGhlICdEaXNjb25uZWN0ZWQnIHN0YXRlLiIpKV19dGhpcy5jb25uZWN0aW9uU3RhdGU9IkNvbm5lY3RpbmciO3RoaXMuc3RhcnRJbnRlcm5hbFByb21pc2U9dGhpcy5zdGFydEludGVybmFsKHRyYW5zZmVyRm9ybWF0KTtyZXR1cm5bNCx0aGlzLnN0YXJ0SW50ZXJuYWxQcm9taXNlXTtjYXNlIDE6X2Euc2VudCgpO2lmKCEodGhpcy5jb25uZWN0aW9uU3RhdGU9PT0iRGlzY29ubmVjdGluZyIpKXJldHVyblszLDNdO21lc3NhZ2U9IkZhaWxlZCB0byBzdGFydCB0aGUgSHR0cENvbm5lY3Rpb24gYmVmb3JlIHN0b3AoKSB3YXMgY2FsbGVkLiI7dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIkxvZ0xldmVsIl0uRXJyb3IsbWVzc2FnZSk7cmV0dXJuWzQsdGhpcy5zdG9wUHJvbWlzZV07Y2FzZSAyOl9hLnNlbnQoKTtyZXR1cm5bMixQcm9taXNlLnJlamVjdChuZXcgRXJyb3IobWVzc2FnZSkpXTtjYXNlIDM6aWYodGhpcy5jb25uZWN0aW9uU3RhdGUhPT0iQ29ubmVjdGVkIil7bWVzc2FnZT0iSHR0cENvbm5lY3Rpb24uc3RhcnRJbnRlcm5hbCBjb21wbGV0ZWQgZ3JhY2VmdWxseSBidXQgZGlkbid0IGVudGVyIHRoZSBjb25uZWN0aW9uIGludG8gdGhlIGNvbm5lY3RlZCBzdGF0ZSEiO3RoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJMb2dMZXZlbCJdLkVycm9yLG1lc3NhZ2UpO3JldHVyblsyLFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihtZXNzYWdlKSldfV9hLmxhYmVsPTQ7Y2FzZSA0OnRoaXMuY29ubmVjdGlvblN0YXJ0ZWQ9dHJ1ZTtyZXR1cm5bMl19fSl9KX07SHR0cENvbm5lY3Rpb24ucHJvdG90eXBlLnNlbmQ9ZnVuY3Rpb24oZGF0YSl7aWYodGhpcy5jb25uZWN0aW9uU3RhdGUhPT0iQ29ubmVjdGVkIil7cmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcigiQ2Fubm90IHNlbmQgZGF0YSBpZiB0aGUgY29ubmVjdGlvbiBpcyBub3QgaW4gdGhlICdDb25uZWN0ZWQnIFN0YXRlLiIpKX1pZighdGhpcy5zZW5kUXVldWUpe3RoaXMuc2VuZFF1ZXVlPW5ldyBUcmFuc3BvcnRTZW5kUXVldWUodGhpcy50cmFuc3BvcnQpfXJldHVybiB0aGlzLnNlbmRRdWV1ZS5zZW5kKGRhdGEpfTtIdHRwQ29ubmVjdGlvbi5wcm90b3R5cGUuc3RvcD1mdW5jdGlvbihlcnJvcil7cmV0dXJuIF9fYXdhaXRlcih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24oKXt2YXIgX3RoaXM9dGhpcztyZXR1cm4gX19nZW5lcmF0b3IodGhpcyxmdW5jdGlvbihfYSl7c3dpdGNoKF9hLmxhYmVsKXtjYXNlIDA6aWYodGhpcy5jb25uZWN0aW9uU3RhdGU9PT0iRGlzY29ubmVjdGVkIil7dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIkxvZ0xldmVsIl0uRGVidWcsIkNhbGwgdG8gSHR0cENvbm5lY3Rpb24uc3RvcCgiK2Vycm9yKyIpIGlnbm9yZWQgYmVjYXVzZSB0aGUgY29ubmVjdGlvbiBpcyBhbHJlYWR5IGluIHRoZSBkaXNjb25uZWN0ZWQgc3RhdGUuIik7cmV0dXJuWzIsUHJvbWlzZS5yZXNvbHZlKCldfWlmKHRoaXMuY29ubmVjdGlvblN0YXRlPT09IkRpc2Nvbm5lY3RpbmciKXt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siTG9nTGV2ZWwiXS5EZWJ1ZywiQ2FsbCB0byBIdHRwQ29ubmVjdGlvbi5zdG9wKCIrZXJyb3IrIikgaWdub3JlZCBiZWNhdXNlIHRoZSBjb25uZWN0aW9uIGlzIGFscmVhZHkgaW4gdGhlIGRpc2Nvbm5lY3Rpbmcgc3RhdGUuIik7cmV0dXJuWzIsdGhpcy5zdG9wUHJvbWlzZV19dGhpcy5jb25uZWN0aW9uU3RhdGU9IkRpc2Nvbm5lY3RpbmciO3RoaXMuc3RvcFByb21pc2U9bmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSl7X3RoaXMuc3RvcFByb21pc2VSZXNvbHZlcj1yZXNvbHZlfSk7cmV0dXJuWzQsdGhpcy5zdG9wSW50ZXJuYWwoZXJyb3IpXTtjYXNlIDE6X2Euc2VudCgpO3JldHVybls0LHRoaXMuc3RvcFByb21pc2VdO2Nhc2UgMjpfYS5zZW50KCk7cmV0dXJuWzJdfX0pfSl9O0h0dHBDb25uZWN0aW9uLnByb3RvdHlwZS5zdG9wSW50ZXJuYWw9ZnVuY3Rpb24oZXJyb3Ipe3JldHVybiBfX2F3YWl0ZXIodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKCl7dmFyIGVfMSxlXzI7cmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsZnVuY3Rpb24oX2Epe3N3aXRjaChfYS5sYWJlbCl7Y2FzZSAwOnRoaXMuc3RvcEVycm9yPWVycm9yO19hLmxhYmVsPTE7Y2FzZSAxOl9hLnRyeXMucHVzaChbMSwzLCw0XSk7cmV0dXJuWzQsdGhpcy5zdGFydEludGVybmFsUHJvbWlzZV07Y2FzZSAyOl9hLnNlbnQoKTtyZXR1cm5bMyw0XTtjYXNlIDM6ZV8xPV9hLnNlbnQoKTtyZXR1cm5bMyw0XTtjYXNlIDQ6aWYoIXRoaXMudHJhbnNwb3J0KXJldHVyblszLDldO19hLmxhYmVsPTU7Y2FzZSA1Ol9hLnRyeXMucHVzaChbNSw3LCw4XSk7cmV0dXJuWzQsdGhpcy50cmFuc3BvcnQuc3RvcCgpXTtjYXNlIDY6X2Euc2VudCgpO3JldHVyblszLDhdO2Nhc2UgNzplXzI9X2Euc2VudCgpO3RoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJMb2dMZXZlbCJdLkVycm9yLCJIdHRwQ29ubmVjdGlvbi50cmFuc3BvcnQuc3RvcCgpIHRocmV3IGVycm9yICciK2VfMisiJy4iKTt0aGlzLnN0b3BDb25uZWN0aW9uKCk7cmV0dXJuWzMsOF07Y2FzZSA4OnRoaXMudHJhbnNwb3J0PXVuZGVmaW5lZDtyZXR1cm5bMywxMF07Y2FzZSA5OnRoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJMb2dMZXZlbCJdLkRlYnVnLCJIdHRwQ29ubmVjdGlvbi50cmFuc3BvcnQgaXMgdW5kZWZpbmVkIGluIEh0dHBDb25uZWN0aW9uLnN0b3AoKSBiZWNhdXNlIHN0YXJ0KCkgZmFpbGVkLiIpO3RoaXMuc3RvcENvbm5lY3Rpb24oKTtfYS5sYWJlbD0xMDtjYXNlIDEwOnJldHVyblsyXX19KX0pfTtIdHRwQ29ubmVjdGlvbi5wcm90b3R5cGUuc3RhcnRJbnRlcm5hbD1mdW5jdGlvbih0cmFuc2ZlckZvcm1hdCl7cmV0dXJuIF9fYXdhaXRlcih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24oKXt2YXIgdXJsLG5lZ290aWF0ZVJlc3BvbnNlLHJlZGlyZWN0cyxfbG9vcF8xLHRoaXNfMSxlXzM7cmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsZnVuY3Rpb24oX2Epe3N3aXRjaChfYS5sYWJlbCl7Y2FzZSAwOnVybD10aGlzLmJhc2VVcmw7dGhpcy5hY2Nlc3NUb2tlbkZhY3Rvcnk9dGhpcy5vcHRpb25zLmFjY2Vzc1Rva2VuRmFjdG9yeTtfYS5sYWJlbD0xO2Nhc2UgMTpfYS50cnlzLnB1c2goWzEsMTIsLDEzXSk7aWYoIXRoaXMub3B0aW9ucy5za2lwTmVnb3RpYXRpb24pcmV0dXJuWzMsNV07aWYoISh0aGlzLm9wdGlvbnMudHJhbnNwb3J0PT09X0lUcmFuc3BvcnRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siSHR0cFRyYW5zcG9ydFR5cGUiXS5XZWJTb2NrZXRzKSlyZXR1cm5bMywzXTt0aGlzLnRyYW5zcG9ydD10aGlzLmNvbnN0cnVjdFRyYW5zcG9ydChfSVRyYW5zcG9ydF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJIdHRwVHJhbnNwb3J0VHlwZSJdLldlYlNvY2tldHMpO3JldHVybls0LHRoaXMuc3RhcnRUcmFuc3BvcnQodXJsLHRyYW5zZmVyRm9ybWF0KV07Y2FzZSAyOl9hLnNlbnQoKTtyZXR1cm5bMyw0XTtjYXNlIDM6dGhyb3cgbmV3IEVycm9yKCJOZWdvdGlhdGlvbiBjYW4gb25seSBiZSBza2lwcGVkIHdoZW4gdXNpbmcgdGhlIFdlYlNvY2tldCB0cmFuc3BvcnQgZGlyZWN0bHkuIik7Y2FzZSA0OnJldHVyblszLDExXTtjYXNlIDU6bmVnb3RpYXRlUmVzcG9uc2U9bnVsbDtyZWRpcmVjdHM9MDtfbG9vcF8xPWZ1bmN0aW9uKCl7dmFyIGFjY2Vzc1Rva2VuXzE7cmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsZnVuY3Rpb24oX2Epe3N3aXRjaChfYS5sYWJlbCl7Y2FzZSAwOnJldHVybls0LHRoaXNfMS5nZXROZWdvdGlhdGlvblJlc3BvbnNlKHVybCldO2Nhc2UgMTpuZWdvdGlhdGVSZXNwb25zZT1fYS5zZW50KCk7aWYodGhpc18xLmNvbm5lY3Rpb25TdGF0ZT09PSJEaXNjb25uZWN0aW5nInx8dGhpc18xLmNvbm5lY3Rpb25TdGF0ZT09PSJEaXNjb25uZWN0ZWQiKXt0aHJvdyBuZXcgRXJyb3IoIlRoZSBjb25uZWN0aW9uIHdhcyBzdG9wcGVkIGR1cmluZyBuZWdvdGlhdGlvbi4iKX1pZihuZWdvdGlhdGVSZXNwb25zZS5lcnJvcil7dGhyb3cgbmV3IEVycm9yKG5lZ290aWF0ZVJlc3BvbnNlLmVycm9yKX1pZihuZWdvdGlhdGVSZXNwb25zZS5Qcm90b2NvbFZlcnNpb24pe3Rocm93IG5ldyBFcnJvcigiRGV0ZWN0ZWQgYSBjb25uZWN0aW9uIGF0dGVtcHQgdG8gYW4gQVNQLk5FVCBTaWduYWxSIFNlcnZlci4gVGhpcyBjbGllbnQgb25seSBzdXBwb3J0cyBjb25uZWN0aW5nIHRvIGFuIEFTUC5ORVQgQ29yZSBTaWduYWxSIFNlcnZlci4gU2VlIGh0dHBzOi8vYWthLm1zL3NpZ25hbHItY29yZS1kaWZmZXJlbmNlcyBmb3IgZGV0YWlscy4iKX1pZihuZWdvdGlhdGVSZXNwb25zZS51cmwpe3VybD1uZWdvdGlhdGVSZXNwb25zZS51cmx9aWYobmVnb3RpYXRlUmVzcG9uc2UuYWNjZXNzVG9rZW4pe2FjY2Vzc1Rva2VuXzE9bmVnb3RpYXRlUmVzcG9uc2UuYWNjZXNzVG9rZW47dGhpc18xLmFjY2Vzc1Rva2VuRmFjdG9yeT1mdW5jdGlvbigpe3JldHVybiBhY2Nlc3NUb2tlbl8xfX1yZWRpcmVjdHMrKztyZXR1cm5bMl19fSl9O3RoaXNfMT10aGlzO19hLmxhYmVsPTY7Y2FzZSA2OnJldHVybls1LF9sb29wXzEoKV07Y2FzZSA3Ol9hLnNlbnQoKTtfYS5sYWJlbD04O2Nhc2UgODppZihuZWdvdGlhdGVSZXNwb25zZS51cmwmJnJlZGlyZWN0czxNQVhfUkVESVJFQ1RTKXJldHVyblszLDZdO19hLmxhYmVsPTk7Y2FzZSA5OmlmKHJlZGlyZWN0cz09PU1BWF9SRURJUkVDVFMmJm5lZ290aWF0ZVJlc3BvbnNlLnVybCl7dGhyb3cgbmV3IEVycm9yKCJOZWdvdGlhdGUgcmVkaXJlY3Rpb24gbGltaXQgZXhjZWVkZWQuIil9cmV0dXJuWzQsdGhpcy5jcmVhdGVUcmFuc3BvcnQodXJsLHRoaXMub3B0aW9ucy50cmFuc3BvcnQsbmVnb3RpYXRlUmVzcG9uc2UsdHJhbnNmZXJGb3JtYXQpXTtjYXNlIDEwOl9hLnNlbnQoKTtfYS5sYWJlbD0xMTtjYXNlIDExOmlmKHRoaXMudHJhbnNwb3J0IGluc3RhbmNlb2YgX0xvbmdQb2xsaW5nVHJhbnNwb3J0X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8zX19bIkxvbmdQb2xsaW5nVHJhbnNwb3J0Il0pe3RoaXMuZmVhdHVyZXMuaW5oZXJlbnRLZWVwQWxpdmU9dHJ1ZX1pZih0aGlzLmNvbm5lY3Rpb25TdGF0ZT09PSJDb25uZWN0aW5nIil7dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIkxvZ0xldmVsIl0uRGVidWcsIlRoZSBIdHRwQ29ubmVjdGlvbiBjb25uZWN0ZWQgc3VjY2Vzc2Z1bGx5LiIpO3RoaXMuY29ubmVjdGlvblN0YXRlPSJDb25uZWN0ZWQifXJldHVyblszLDEzXTtjYXNlIDEyOmVfMz1fYS5zZW50KCk7dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIkxvZ0xldmVsIl0uRXJyb3IsIkZhaWxlZCB0byBzdGFydCB0aGUgY29ubmVjdGlvbjogIitlXzMpO3RoaXMuY29ubmVjdGlvblN0YXRlPSJEaXNjb25uZWN0ZWQiO3RoaXMudHJhbnNwb3J0PXVuZGVmaW5lZDtyZXR1cm5bMixQcm9taXNlLnJlamVjdChlXzMpXTtjYXNlIDEzOnJldHVyblsyXX19KX0pfTtIdHRwQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0TmVnb3RpYXRpb25SZXNwb25zZT1mdW5jdGlvbih1cmwpe3JldHVybiBfX2F3YWl0ZXIodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKCl7dmFyIGhlYWRlcnMsdG9rZW4sX2EsbmFtZSx2YWx1ZSxuZWdvdGlhdGVVcmwscmVzcG9uc2UsbmVnb3RpYXRlUmVzcG9uc2UsZV80O3JldHVybiBfX2dlbmVyYXRvcih0aGlzLGZ1bmN0aW9uKF9iKXtzd2l0Y2goX2IubGFiZWwpe2Nhc2UgMDpoZWFkZXJzPXt9O2lmKCF0aGlzLmFjY2Vzc1Rva2VuRmFjdG9yeSlyZXR1cm5bMywyXTtyZXR1cm5bNCx0aGlzLmFjY2Vzc1Rva2VuRmFjdG9yeSgpXTtjYXNlIDE6dG9rZW49X2Iuc2VudCgpO2lmKHRva2VuKXtoZWFkZXJzWyJBdXRob3JpemF0aW9uIl09IkJlYXJlciAiK3Rva2VufV9iLmxhYmVsPTI7Y2FzZSAyOl9hPU9iamVjdChfVXRpbHNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzVfX1siZ2V0VXNlckFnZW50SGVhZGVyIl0pKCksbmFtZT1fYVswXSx2YWx1ZT1fYVsxXTtoZWFkZXJzW25hbWVdPXZhbHVlO25lZ290aWF0ZVVybD10aGlzLnJlc29sdmVOZWdvdGlhdGVVcmwodXJsKTt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siTG9nTGV2ZWwiXS5EZWJ1ZywiU2VuZGluZyBuZWdvdGlhdGlvbiByZXF1ZXN0OiAiK25lZ290aWF0ZVVybCsiLiIpO19iLmxhYmVsPTM7Y2FzZSAzOl9iLnRyeXMucHVzaChbMyw1LCw2XSk7cmV0dXJuWzQsdGhpcy5odHRwQ2xpZW50LnBvc3QobmVnb3RpYXRlVXJsLHtjb250ZW50OiIiLGhlYWRlcnM6X19hc3NpZ24oe30saGVhZGVycyx0aGlzLm9wdGlvbnMuaGVhZGVycyksd2l0aENyZWRlbnRpYWxzOnRoaXMub3B0aW9ucy53aXRoQ3JlZGVudGlhbHN9KV07Y2FzZSA0OnJlc3BvbnNlPV9iLnNlbnQoKTtpZihyZXNwb25zZS5zdGF0dXNDb2RlIT09MjAwKXtyZXR1cm5bMixQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoIlVuZXhwZWN0ZWQgc3RhdHVzIGNvZGUgcmV0dXJuZWQgZnJvbSBuZWdvdGlhdGUgJyIrcmVzcG9uc2Uuc3RhdHVzQ29kZSsiJyIpKV19bmVnb3RpYXRlUmVzcG9uc2U9SlNPTi5wYXJzZShyZXNwb25zZS5jb250ZW50KTtpZighbmVnb3RpYXRlUmVzcG9uc2UubmVnb3RpYXRlVmVyc2lvbnx8bmVnb3RpYXRlUmVzcG9uc2UubmVnb3RpYXRlVmVyc2lvbjwxKXtuZWdvdGlhdGVSZXNwb25zZS5jb25uZWN0aW9uVG9rZW49bmVnb3RpYXRlUmVzcG9uc2UuY29ubmVjdGlvbklkfXJldHVyblsyLG5lZ290aWF0ZVJlc3BvbnNlXTtjYXNlIDU6ZV80PV9iLnNlbnQoKTt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siTG9nTGV2ZWwiXS5FcnJvciwiRmFpbGVkIHRvIGNvbXBsZXRlIG5lZ290aWF0aW9uIHdpdGggdGhlIHNlcnZlcjogIitlXzQpO3JldHVyblsyLFByb21pc2UucmVqZWN0KGVfNCldO2Nhc2UgNjpyZXR1cm5bMl19fSl9KX07SHR0cENvbm5lY3Rpb24ucHJvdG90eXBlLmNyZWF0ZUNvbm5lY3RVcmw9ZnVuY3Rpb24odXJsLGNvbm5lY3Rpb25Ub2tlbil7aWYoIWNvbm5lY3Rpb25Ub2tlbil7cmV0dXJuIHVybH1yZXR1cm4gdXJsKyh1cmwuaW5kZXhPZigiPyIpPT09LTE/Ij8iOiImIikrKCJpZD0iK2Nvbm5lY3Rpb25Ub2tlbil9O0h0dHBDb25uZWN0aW9uLnByb3RvdHlwZS5jcmVhdGVUcmFuc3BvcnQ9ZnVuY3Rpb24odXJsLHJlcXVlc3RlZFRyYW5zcG9ydCxuZWdvdGlhdGVSZXNwb25zZSxyZXF1ZXN0ZWRUcmFuc2ZlckZvcm1hdCl7cmV0dXJuIF9fYXdhaXRlcih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24oKXt2YXIgY29ubmVjdFVybCx0cmFuc3BvcnRFeGNlcHRpb25zLHRyYW5zcG9ydHMsbmVnb3RpYXRlLF9pLHRyYW5zcG9ydHNfMSxlbmRwb2ludCx0cmFuc3BvcnRPckVycm9yLGV4XzEsZXhfMixtZXNzYWdlO3JldHVybiBfX2dlbmVyYXRvcih0aGlzLGZ1bmN0aW9uKF9hKXtzd2l0Y2goX2EubGFiZWwpe2Nhc2UgMDpjb25uZWN0VXJsPXRoaXMuY3JlYXRlQ29ubmVjdFVybCh1cmwsbmVnb3RpYXRlUmVzcG9uc2UuY29ubmVjdGlvblRva2VuKTtpZighdGhpcy5pc0lUcmFuc3BvcnQocmVxdWVzdGVkVHJhbnNwb3J0KSlyZXR1cm5bMywyXTt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siTG9nTGV2ZWwiXS5EZWJ1ZywiQ29ubmVjdGlvbiB3YXMgcHJvdmlkZWQgYW4gaW5zdGFuY2Ugb2YgSVRyYW5zcG9ydCwgdXNpbmcgdGhhdCBkaXJlY3RseS4iKTt0aGlzLnRyYW5zcG9ydD1yZXF1ZXN0ZWRUcmFuc3BvcnQ7cmV0dXJuWzQsdGhpcy5zdGFydFRyYW5zcG9ydChjb25uZWN0VXJsLHJlcXVlc3RlZFRyYW5zZmVyRm9ybWF0KV07Y2FzZSAxOl9hLnNlbnQoKTt0aGlzLmNvbm5lY3Rpb25JZD1uZWdvdGlhdGVSZXNwb25zZS5jb25uZWN0aW9uSWQ7cmV0dXJuWzJdO2Nhc2UgMjp0cmFuc3BvcnRFeGNlcHRpb25zPVtdO3RyYW5zcG9ydHM9bmVnb3RpYXRlUmVzcG9uc2UuYXZhaWxhYmxlVHJhbnNwb3J0c3x8W107bmVnb3RpYXRlPW5lZ290aWF0ZVJlc3BvbnNlO19pPTAsdHJhbnNwb3J0c18xPXRyYW5zcG9ydHM7X2EubGFiZWw9MztjYXNlIDM6aWYoIShfaTx0cmFuc3BvcnRzXzEubGVuZ3RoKSlyZXR1cm5bMywxM107ZW5kcG9pbnQ9dHJhbnNwb3J0c18xW19pXTt0cmFuc3BvcnRPckVycm9yPXRoaXMucmVzb2x2ZVRyYW5zcG9ydE9yRXJyb3IoZW5kcG9pbnQscmVxdWVzdGVkVHJhbnNwb3J0LHJlcXVlc3RlZFRyYW5zZmVyRm9ybWF0KTtpZighKHRyYW5zcG9ydE9yRXJyb3IgaW5zdGFuY2VvZiBFcnJvcikpcmV0dXJuWzMsNF07dHJhbnNwb3J0RXhjZXB0aW9ucy5wdXNoKGVuZHBvaW50LnRyYW5zcG9ydCsiIGZhaWxlZDogIit0cmFuc3BvcnRPckVycm9yKTtyZXR1cm5bMywxMl07Y2FzZSA0OmlmKCF0aGlzLmlzSVRyYW5zcG9ydCh0cmFuc3BvcnRPckVycm9yKSlyZXR1cm5bMywxMl07dGhpcy50cmFuc3BvcnQ9dHJhbnNwb3J0T3JFcnJvcjtpZighIW5lZ290aWF0ZSlyZXR1cm5bMyw5XTtfYS5sYWJlbD01O2Nhc2UgNTpfYS50cnlzLnB1c2goWzUsNywsOF0pO3JldHVybls0LHRoaXMuZ2V0TmVnb3RpYXRpb25SZXNwb25zZSh1cmwpXTtjYXNlIDY6bmVnb3RpYXRlPV9hLnNlbnQoKTtyZXR1cm5bMyw4XTtjYXNlIDc6ZXhfMT1fYS5zZW50KCk7cmV0dXJuWzIsUHJvbWlzZS5yZWplY3QoZXhfMSldO2Nhc2UgODpjb25uZWN0VXJsPXRoaXMuY3JlYXRlQ29ubmVjdFVybCh1cmwsbmVnb3RpYXRlLmNvbm5lY3Rpb25Ub2tlbik7X2EubGFiZWw9OTtjYXNlIDk6X2EudHJ5cy5wdXNoKFs5LDExLCwxMl0pO3JldHVybls0LHRoaXMuc3RhcnRUcmFuc3BvcnQoY29ubmVjdFVybCxyZXF1ZXN0ZWRUcmFuc2ZlckZvcm1hdCldO2Nhc2UgMTA6X2Euc2VudCgpO3RoaXMuY29ubmVjdGlvbklkPW5lZ290aWF0ZS5jb25uZWN0aW9uSWQ7cmV0dXJuWzJdO2Nhc2UgMTE6ZXhfMj1fYS5zZW50KCk7dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIkxvZ0xldmVsIl0uRXJyb3IsIkZhaWxlZCB0byBzdGFydCB0aGUgdHJhbnNwb3J0ICciK2VuZHBvaW50LnRyYW5zcG9ydCsiJzogIitleF8yKTtuZWdvdGlhdGU9dW5kZWZpbmVkO3RyYW5zcG9ydEV4Y2VwdGlvbnMucHVzaChlbmRwb2ludC50cmFuc3BvcnQrIiBmYWlsZWQ6ICIrZXhfMik7aWYodGhpcy5jb25uZWN0aW9uU3RhdGUhPT0iQ29ubmVjdGluZyIpe21lc3NhZ2U9IkZhaWxlZCB0byBzZWxlY3QgdHJhbnNwb3J0IGJlZm9yZSBzdG9wKCkgd2FzIGNhbGxlZC4iO3RoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJMb2dMZXZlbCJdLkRlYnVnLG1lc3NhZ2UpO3JldHVyblsyLFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihtZXNzYWdlKSldfXJldHVyblszLDEyXTtjYXNlIDEyOl9pKys7cmV0dXJuWzMsM107Y2FzZSAxMzppZih0cmFuc3BvcnRFeGNlcHRpb25zLmxlbmd0aD4wKXtyZXR1cm5bMixQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoIlVuYWJsZSB0byBjb25uZWN0IHRvIHRoZSBzZXJ2ZXIgd2l0aCBhbnkgb2YgdGhlIGF2YWlsYWJsZSB0cmFuc3BvcnRzLiAiK3RyYW5zcG9ydEV4Y2VwdGlvbnMuam9pbigiICIpKSldfXJldHVyblsyLFByb21pc2UucmVqZWN0KG5ldyBFcnJvcigiTm9uZSBvZiB0aGUgdHJhbnNwb3J0cyBzdXBwb3J0ZWQgYnkgdGhlIGNsaWVudCBhcmUgc3VwcG9ydGVkIGJ5IHRoZSBzZXJ2ZXIuIikpXX19KX0pfTtIdHRwQ29ubmVjdGlvbi5wcm90b3R5cGUuY29uc3RydWN0VHJhbnNwb3J0PWZ1bmN0aW9uKHRyYW5zcG9ydCl7c3dpdGNoKHRyYW5zcG9ydCl7Y2FzZSBfSVRyYW5zcG9ydF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJIdHRwVHJhbnNwb3J0VHlwZSJdLldlYlNvY2tldHM6aWYoIXRoaXMub3B0aW9ucy5XZWJTb2NrZXQpe3Rocm93IG5ldyBFcnJvcigiJ1dlYlNvY2tldCcgaXMgbm90IHN1cHBvcnRlZCBpbiB5b3VyIGVudmlyb25tZW50LiIpfXJldHVybiBuZXcgX1dlYlNvY2tldFRyYW5zcG9ydF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfNl9fWyJXZWJTb2NrZXRUcmFuc3BvcnQiXSh0aGlzLmh0dHBDbGllbnQsdGhpcy5hY2Nlc3NUb2tlbkZhY3RvcnksdGhpcy5sb2dnZXIsdGhpcy5vcHRpb25zLmxvZ01lc3NhZ2VDb250ZW50fHxmYWxzZSx0aGlzLm9wdGlvbnMuV2ViU29ja2V0LHRoaXMub3B0aW9ucy5oZWFkZXJzfHx7fSk7Y2FzZSBfSVRyYW5zcG9ydF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJIdHRwVHJhbnNwb3J0VHlwZSJdLlNlcnZlclNlbnRFdmVudHM6aWYoIXRoaXMub3B0aW9ucy5FdmVudFNvdXJjZSl7dGhyb3cgbmV3IEVycm9yKCInRXZlbnRTb3VyY2UnIGlzIG5vdCBzdXBwb3J0ZWQgaW4geW91ciBlbnZpcm9ubWVudC4iKX1yZXR1cm4gbmV3IF9TZXJ2ZXJTZW50RXZlbnRzVHJhbnNwb3J0X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV80X19bIlNlcnZlclNlbnRFdmVudHNUcmFuc3BvcnQiXSh0aGlzLmh0dHBDbGllbnQsdGhpcy5hY2Nlc3NUb2tlbkZhY3RvcnksdGhpcy5sb2dnZXIsdGhpcy5vcHRpb25zLmxvZ01lc3NhZ2VDb250ZW50fHxmYWxzZSx0aGlzLm9wdGlvbnMuRXZlbnRTb3VyY2UsdGhpcy5vcHRpb25zLndpdGhDcmVkZW50aWFscyx0aGlzLm9wdGlvbnMuaGVhZGVyc3x8e30pO2Nhc2UgX0lUcmFuc3BvcnRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siSHR0cFRyYW5zcG9ydFR5cGUiXS5Mb25nUG9sbGluZzpyZXR1cm4gbmV3IF9Mb25nUG9sbGluZ1RyYW5zcG9ydF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfM19fWyJMb25nUG9sbGluZ1RyYW5zcG9ydCJdKHRoaXMuaHR0cENsaWVudCx0aGlzLmFjY2Vzc1Rva2VuRmFjdG9yeSx0aGlzLmxvZ2dlcix0aGlzLm9wdGlvbnMubG9nTWVzc2FnZUNvbnRlbnR8fGZhbHNlLHRoaXMub3B0aW9ucy53aXRoQ3JlZGVudGlhbHMsdGhpcy5vcHRpb25zLmhlYWRlcnN8fHt9KTtkZWZhdWx0OnRocm93IG5ldyBFcnJvcigiVW5rbm93biB0cmFuc3BvcnQ6ICIrdHJhbnNwb3J0KyIuIil9fTtIdHRwQ29ubmVjdGlvbi5wcm90b3R5cGUuc3RhcnRUcmFuc3BvcnQ9ZnVuY3Rpb24odXJsLHRyYW5zZmVyRm9ybWF0KXt2YXIgX3RoaXM9dGhpczt0aGlzLnRyYW5zcG9ydC5vbnJlY2VpdmU9dGhpcy5vbnJlY2VpdmU7dGhpcy50cmFuc3BvcnQub25jbG9zZT1mdW5jdGlvbihlKXtyZXR1cm4gX3RoaXMuc3RvcENvbm5lY3Rpb24oZSl9O3JldHVybiB0aGlzLnRyYW5zcG9ydC5jb25uZWN0KHVybCx0cmFuc2ZlckZvcm1hdCl9O0h0dHBDb25uZWN0aW9uLnByb3RvdHlwZS5yZXNvbHZlVHJhbnNwb3J0T3JFcnJvcj1mdW5jdGlvbihlbmRwb2ludCxyZXF1ZXN0ZWRUcmFuc3BvcnQscmVxdWVzdGVkVHJhbnNmZXJGb3JtYXQpe3ZhciB0cmFuc3BvcnQ9X0lUcmFuc3BvcnRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siSHR0cFRyYW5zcG9ydFR5cGUiXVtlbmRwb2ludC50cmFuc3BvcnRdO2lmKHRyYW5zcG9ydD09PW51bGx8fHRyYW5zcG9ydD09PXVuZGVmaW5lZCl7dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIkxvZ0xldmVsIl0uRGVidWcsIlNraXBwaW5nIHRyYW5zcG9ydCAnIitlbmRwb2ludC50cmFuc3BvcnQrIicgYmVjYXVzZSBpdCBpcyBub3Qgc3VwcG9ydGVkIGJ5IHRoaXMgY2xpZW50LiIpO3JldHVybiBuZXcgRXJyb3IoIlNraXBwaW5nIHRyYW5zcG9ydCAnIitlbmRwb2ludC50cmFuc3BvcnQrIicgYmVjYXVzZSBpdCBpcyBub3Qgc3VwcG9ydGVkIGJ5IHRoaXMgY2xpZW50LiIpfWVsc2V7aWYodHJhbnNwb3J0TWF0Y2hlcyhyZXF1ZXN0ZWRUcmFuc3BvcnQsdHJhbnNwb3J0KSl7dmFyIHRyYW5zZmVyRm9ybWF0cz1lbmRwb2ludC50cmFuc2ZlckZvcm1hdHMubWFwKGZ1bmN0aW9uKHMpe3JldHVybiBfSVRyYW5zcG9ydF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJUcmFuc2ZlckZvcm1hdCJdW3NdfSk7aWYodHJhbnNmZXJGb3JtYXRzLmluZGV4T2YocmVxdWVzdGVkVHJhbnNmZXJGb3JtYXQpPj0wKXtpZih0cmFuc3BvcnQ9PT1fSVRyYW5zcG9ydF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJIdHRwVHJhbnNwb3J0VHlwZSJdLldlYlNvY2tldHMmJiF0aGlzLm9wdGlvbnMuV2ViU29ja2V0fHx0cmFuc3BvcnQ9PT1fSVRyYW5zcG9ydF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJIdHRwVHJhbnNwb3J0VHlwZSJdLlNlcnZlclNlbnRFdmVudHMmJiF0aGlzLm9wdGlvbnMuRXZlbnRTb3VyY2Upe3RoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJMb2dMZXZlbCJdLkRlYnVnLCJTa2lwcGluZyB0cmFuc3BvcnQgJyIrX0lUcmFuc3BvcnRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siSHR0cFRyYW5zcG9ydFR5cGUiXVt0cmFuc3BvcnRdKyInIGJlY2F1c2UgaXQgaXMgbm90IHN1cHBvcnRlZCBpbiB5b3VyIGVudmlyb25tZW50LiciKTtyZXR1cm4gbmV3IEVycm9yKCInIitfSVRyYW5zcG9ydF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJIdHRwVHJhbnNwb3J0VHlwZSJdW3RyYW5zcG9ydF0rIicgaXMgbm90IHN1cHBvcnRlZCBpbiB5b3VyIGVudmlyb25tZW50LiIpfWVsc2V7dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIkxvZ0xldmVsIl0uRGVidWcsIlNlbGVjdGluZyB0cmFuc3BvcnQgJyIrX0lUcmFuc3BvcnRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siSHR0cFRyYW5zcG9ydFR5cGUiXVt0cmFuc3BvcnRdKyInLiIpO3RyeXtyZXR1cm4gdGhpcy5jb25zdHJ1Y3RUcmFuc3BvcnQodHJhbnNwb3J0KX1jYXRjaChleCl7cmV0dXJuIGV4fX19ZWxzZXt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siTG9nTGV2ZWwiXS5EZWJ1ZywiU2tpcHBpbmcgdHJhbnNwb3J0ICciK19JVHJhbnNwb3J0X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIkh0dHBUcmFuc3BvcnRUeXBlIl1bdHJhbnNwb3J0XSsiJyBiZWNhdXNlIGl0IGRvZXMgbm90IHN1cHBvcnQgdGhlIHJlcXVlc3RlZCB0cmFuc2ZlciBmb3JtYXQgJyIrX0lUcmFuc3BvcnRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siVHJhbnNmZXJGb3JtYXQiXVtyZXF1ZXN0ZWRUcmFuc2ZlckZvcm1hdF0rIicuIik7cmV0dXJuIG5ldyBFcnJvcigiJyIrX0lUcmFuc3BvcnRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siSHR0cFRyYW5zcG9ydFR5cGUiXVt0cmFuc3BvcnRdKyInIGRvZXMgbm90IHN1cHBvcnQgIitfSVRyYW5zcG9ydF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJUcmFuc2ZlckZvcm1hdCJdW3JlcXVlc3RlZFRyYW5zZmVyRm9ybWF0XSsiLiIpfX1lbHNle3RoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJMb2dMZXZlbCJdLkRlYnVnLCJTa2lwcGluZyB0cmFuc3BvcnQgJyIrX0lUcmFuc3BvcnRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siSHR0cFRyYW5zcG9ydFR5cGUiXVt0cmFuc3BvcnRdKyInIGJlY2F1c2UgaXQgd2FzIGRpc2FibGVkIGJ5IHRoZSBjbGllbnQuIik7cmV0dXJuIG5ldyBFcnJvcigiJyIrX0lUcmFuc3BvcnRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siSHR0cFRyYW5zcG9ydFR5cGUiXVt0cmFuc3BvcnRdKyInIGlzIGRpc2FibGVkIGJ5IHRoZSBjbGllbnQuIil9fX07SHR0cENvbm5lY3Rpb24ucHJvdG90eXBlLmlzSVRyYW5zcG9ydD1mdW5jdGlvbih0cmFuc3BvcnQpe3JldHVybiB0cmFuc3BvcnQmJnR5cGVvZiB0cmFuc3BvcnQ9PT0ib2JqZWN0IiYmImNvbm5lY3QiaW4gdHJhbnNwb3J0fTtIdHRwQ29ubmVjdGlvbi5wcm90b3R5cGUuc3RvcENvbm5lY3Rpb249ZnVuY3Rpb24oZXJyb3Ipe3ZhciBfdGhpcz10aGlzO3RoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJMb2dMZXZlbCJdLkRlYnVnLCJIdHRwQ29ubmVjdGlvbi5zdG9wQ29ubmVjdGlvbigiK2Vycm9yKyIpIGNhbGxlZCB3aGlsZSBpbiBzdGF0ZSAiK3RoaXMuY29ubmVjdGlvblN0YXRlKyIuIik7dGhpcy50cmFuc3BvcnQ9dW5kZWZpbmVkO2Vycm9yPXRoaXMuc3RvcEVycm9yfHxlcnJvcjt0aGlzLnN0b3BFcnJvcj11bmRlZmluZWQ7aWYodGhpcy5jb25uZWN0aW9uU3RhdGU9PT0iRGlzY29ubmVjdGVkIil7dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIkxvZ0xldmVsIl0uRGVidWcsIkNhbGwgdG8gSHR0cENvbm5lY3Rpb24uc3RvcENvbm5lY3Rpb24oIitlcnJvcisiKSB3YXMgaWdub3JlZCBiZWNhdXNlIHRoZSBjb25uZWN0aW9uIGlzIGFscmVhZHkgaW4gdGhlIGRpc2Nvbm5lY3RlZCBzdGF0ZS4iKTtyZXR1cm59aWYodGhpcy5jb25uZWN0aW9uU3RhdGU9PT0iQ29ubmVjdGluZyIpe3RoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJMb2dMZXZlbCJdLldhcm5pbmcsIkNhbGwgdG8gSHR0cENvbm5lY3Rpb24uc3RvcENvbm5lY3Rpb24oIitlcnJvcisiKSB3YXMgaWdub3JlZCBiZWNhdXNlIHRoZSBjb25uZWN0aW9uIGlzIHN0aWxsIGluIHRoZSBjb25uZWN0aW5nIHN0YXRlLiIpO3Rocm93IG5ldyBFcnJvcigiSHR0cENvbm5lY3Rpb24uc3RvcENvbm5lY3Rpb24oIitlcnJvcisiKSB3YXMgY2FsbGVkIHdoaWxlIHRoZSBjb25uZWN0aW9uIGlzIHN0aWxsIGluIHRoZSBjb25uZWN0aW5nIHN0YXRlLiIpfWlmKHRoaXMuY29ubmVjdGlvblN0YXRlPT09IkRpc2Nvbm5lY3RpbmciKXt0aGlzLnN0b3BQcm9taXNlUmVzb2x2ZXIoKX1pZihlcnJvcil7dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIkxvZ0xldmVsIl0uRXJyb3IsIkNvbm5lY3Rpb24gZGlzY29ubmVjdGVkIHdpdGggZXJyb3IgJyIrZXJyb3IrIicuIil9ZWxzZXt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siTG9nTGV2ZWwiXS5JbmZvcm1hdGlvbiwiQ29ubmVjdGlvbiBkaXNjb25uZWN0ZWQuIil9aWYodGhpcy5zZW5kUXVldWUpe3RoaXMuc2VuZFF1ZXVlLnN0b3AoKS5jYXRjaChmdW5jdGlvbihlKXtfdGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIkxvZ0xldmVsIl0uRXJyb3IsIlRyYW5zcG9ydFNlbmRRdWV1ZS5zdG9wKCkgdGhyZXcgZXJyb3IgJyIrZSsiJy4iKX0pO3RoaXMuc2VuZFF1ZXVlPXVuZGVmaW5lZH10aGlzLmNvbm5lY3Rpb25JZD11bmRlZmluZWQ7dGhpcy5jb25uZWN0aW9uU3RhdGU9IkRpc2Nvbm5lY3RlZCI7aWYodGhpcy5jb25uZWN0aW9uU3RhcnRlZCl7dGhpcy5jb25uZWN0aW9uU3RhcnRlZD1mYWxzZTt0cnl7aWYodGhpcy5vbmNsb3NlKXt0aGlzLm9uY2xvc2UoZXJyb3IpfX1jYXRjaChlKXt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siTG9nTGV2ZWwiXS5FcnJvciwiSHR0cENvbm5lY3Rpb24ub25jbG9zZSgiK2Vycm9yKyIpIHRocmV3IGVycm9yICciK2UrIicuIil9fX07SHR0cENvbm5lY3Rpb24ucHJvdG90eXBlLnJlc29sdmVVcmw9ZnVuY3Rpb24odXJsKXtpZih1cmwubGFzdEluZGV4T2YoImh0dHBzOi8vIiwwKT09PTB8fHVybC5sYXN0SW5kZXhPZigiaHR0cDovLyIsMCk9PT0wKXtyZXR1cm4gdXJsfWlmKCFfVXRpbHNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzVfX1siUGxhdGZvcm0iXS5pc0Jyb3dzZXJ8fCF3aW5kb3cuZG9jdW1lbnQpe3Rocm93IG5ldyBFcnJvcigiQ2Fubm90IHJlc29sdmUgJyIrdXJsKyInLiIpfXZhciBhVGFnPXdpbmRvdy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7YVRhZy5ocmVmPXVybDt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siTG9nTGV2ZWwiXS5JbmZvcm1hdGlvbiwiTm9ybWFsaXppbmcgJyIrdXJsKyInIHRvICciK2FUYWcuaHJlZisiJy4iKTtyZXR1cm4gYVRhZy5ocmVmfTtIdHRwQ29ubmVjdGlvbi5wcm90b3R5cGUucmVzb2x2ZU5lZ290aWF0ZVVybD1mdW5jdGlvbih1cmwpe3ZhciBpbmRleD11cmwuaW5kZXhPZigiPyIpO3ZhciBuZWdvdGlhdGVVcmw9dXJsLnN1YnN0cmluZygwLGluZGV4PT09LTE/dXJsLmxlbmd0aDppbmRleCk7aWYobmVnb3RpYXRlVXJsW25lZ290aWF0ZVVybC5sZW5ndGgtMV0hPT0iLyIpe25lZ290aWF0ZVVybCs9Ii8ifW5lZ290aWF0ZVVybCs9Im5lZ290aWF0ZSI7bmVnb3RpYXRlVXJsKz1pbmRleD09PS0xPyIiOnVybC5zdWJzdHJpbmcoaW5kZXgpO2lmKG5lZ290aWF0ZVVybC5pbmRleE9mKCJuZWdvdGlhdGVWZXJzaW9uIik9PT0tMSl7bmVnb3RpYXRlVXJsKz1pbmRleD09PS0xPyI/IjoiJiI7bmVnb3RpYXRlVXJsKz0ibmVnb3RpYXRlVmVyc2lvbj0iK3RoaXMubmVnb3RpYXRlVmVyc2lvbn1yZXR1cm4gbmVnb3RpYXRlVXJsfTtyZXR1cm4gSHR0cENvbm5lY3Rpb259KCk7ZnVuY3Rpb24gdHJhbnNwb3J0TWF0Y2hlcyhyZXF1ZXN0ZWRUcmFuc3BvcnQsYWN0dWFsVHJhbnNwb3J0KXtyZXR1cm4hcmVxdWVzdGVkVHJhbnNwb3J0fHwoYWN0dWFsVHJhbnNwb3J0JnJlcXVlc3RlZFRyYW5zcG9ydCkhPT0wfXZhciBUcmFuc3BvcnRTZW5kUXVldWU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBUcmFuc3BvcnRTZW5kUXVldWUodHJhbnNwb3J0KXt0aGlzLnRyYW5zcG9ydD10cmFuc3BvcnQ7dGhpcy5idWZmZXI9W107dGhpcy5leGVjdXRpbmc9dHJ1ZTt0aGlzLnNlbmRCdWZmZXJlZERhdGE9bmV3IFByb21pc2VTb3VyY2U7dGhpcy50cmFuc3BvcnRSZXN1bHQ9bmV3IFByb21pc2VTb3VyY2U7dGhpcy5zZW5kTG9vcFByb21pc2U9dGhpcy5zZW5kTG9vcCgpfVRyYW5zcG9ydFNlbmRRdWV1ZS5wcm90b3R5cGUuc2VuZD1mdW5jdGlvbihkYXRhKXt0aGlzLmJ1ZmZlckRhdGEoZGF0YSk7aWYoIXRoaXMudHJhbnNwb3J0UmVzdWx0KXt0aGlzLnRyYW5zcG9ydFJlc3VsdD1uZXcgUHJvbWlzZVNvdXJjZX1yZXR1cm4gdGhpcy50cmFuc3BvcnRSZXN1bHQucHJvbWlzZX07VHJhbnNwb3J0U2VuZFF1ZXVlLnByb3RvdHlwZS5zdG9wPWZ1bmN0aW9uKCl7dGhpcy5leGVjdXRpbmc9ZmFsc2U7dGhpcy5zZW5kQnVmZmVyZWREYXRhLnJlc29sdmUoKTtyZXR1cm4gdGhpcy5zZW5kTG9vcFByb21pc2V9O1RyYW5zcG9ydFNlbmRRdWV1ZS5wcm90b3R5cGUuYnVmZmVyRGF0YT1mdW5jdGlvbihkYXRhKXtpZih0aGlzLmJ1ZmZlci5sZW5ndGgmJnR5cGVvZiB0aGlzLmJ1ZmZlclswXSE9PXR5cGVvZiBkYXRhKXt0aHJvdyBuZXcgRXJyb3IoIkV4cGVjdGVkIGRhdGEgdG8gYmUgb2YgdHlwZSAiK3R5cGVvZiB0aGlzLmJ1ZmZlcisiIGJ1dCB3YXMgb2YgdHlwZSAiK3R5cGVvZiBkYXRhKX10aGlzLmJ1ZmZlci5wdXNoKGRhdGEpO3RoaXMuc2VuZEJ1ZmZlcmVkRGF0YS5yZXNvbHZlKCl9O1RyYW5zcG9ydFNlbmRRdWV1ZS5wcm90b3R5cGUuc2VuZExvb3A9ZnVuY3Rpb24oKXtyZXR1cm4gX19hd2FpdGVyKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbigpe3ZhciB0cmFuc3BvcnRSZXN1bHQsZGF0YSxlcnJvcl8xO3JldHVybiBfX2dlbmVyYXRvcih0aGlzLGZ1bmN0aW9uKF9hKXtzd2l0Y2goX2EubGFiZWwpe2Nhc2UgMDppZihmYWxzZSl7fXJldHVybls0LHRoaXMuc2VuZEJ1ZmZlcmVkRGF0YS5wcm9taXNlXTtjYXNlIDE6X2Euc2VudCgpO2lmKCF0aGlzLmV4ZWN1dGluZyl7aWYodGhpcy50cmFuc3BvcnRSZXN1bHQpe3RoaXMudHJhbnNwb3J0UmVzdWx0LnJlamVjdCgiQ29ubmVjdGlvbiBzdG9wcGVkLiIpfXJldHVyblszLDZdfXRoaXMuc2VuZEJ1ZmZlcmVkRGF0YT1uZXcgUHJvbWlzZVNvdXJjZTt0cmFuc3BvcnRSZXN1bHQ9dGhpcy50cmFuc3BvcnRSZXN1bHQ7dGhpcy50cmFuc3BvcnRSZXN1bHQ9dW5kZWZpbmVkO2RhdGE9dHlwZW9mIHRoaXMuYnVmZmVyWzBdPT09InN0cmluZyI/dGhpcy5idWZmZXIuam9pbigiIik6VHJhbnNwb3J0U2VuZFF1ZXVlLmNvbmNhdEJ1ZmZlcnModGhpcy5idWZmZXIpO3RoaXMuYnVmZmVyLmxlbmd0aD0wO19hLmxhYmVsPTI7Y2FzZSAyOl9hLnRyeXMucHVzaChbMiw0LCw1XSk7cmV0dXJuWzQsdGhpcy50cmFuc3BvcnQuc2VuZChkYXRhKV07Y2FzZSAzOl9hLnNlbnQoKTt0cmFuc3BvcnRSZXN1bHQucmVzb2x2ZSgpO3JldHVyblszLDVdO2Nhc2UgNDplcnJvcl8xPV9hLnNlbnQoKTt0cmFuc3BvcnRSZXN1bHQucmVqZWN0KGVycm9yXzEpO3JldHVyblszLDVdO2Nhc2UgNTpyZXR1cm5bMywwXTtjYXNlIDY6cmV0dXJuWzJdfX0pfSl9O1RyYW5zcG9ydFNlbmRRdWV1ZS5jb25jYXRCdWZmZXJzPWZ1bmN0aW9uKGFycmF5QnVmZmVycyl7dmFyIHRvdGFsTGVuZ3RoPWFycmF5QnVmZmVycy5tYXAoZnVuY3Rpb24oYil7cmV0dXJuIGIuYnl0ZUxlbmd0aH0pLnJlZHVjZShmdW5jdGlvbihhLGIpe3JldHVybiBhK2J9KTt2YXIgcmVzdWx0PW5ldyBVaW50OEFycmF5KHRvdGFsTGVuZ3RoKTt2YXIgb2Zmc2V0PTA7Zm9yKHZhciBfaT0wLGFycmF5QnVmZmVyc18xPWFycmF5QnVmZmVycztfaTxhcnJheUJ1ZmZlcnNfMS5sZW5ndGg7X2krKyl7dmFyIGl0ZW09YXJyYXlCdWZmZXJzXzFbX2ldO3Jlc3VsdC5zZXQobmV3IFVpbnQ4QXJyYXkoaXRlbSksb2Zmc2V0KTtvZmZzZXQrPWl0ZW0uYnl0ZUxlbmd0aH1yZXR1cm4gcmVzdWx0LmJ1ZmZlcn07cmV0dXJuIFRyYW5zcG9ydFNlbmRRdWV1ZX0oKTt2YXIgUHJvbWlzZVNvdXJjZT1mdW5jdGlvbigpe2Z1bmN0aW9uIFByb21pc2VTb3VyY2UoKXt2YXIgX3RoaXM9dGhpczt0aGlzLnByb21pc2U9bmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSxyZWplY3Qpe3ZhciBfYTtyZXR1cm4gX2E9W3Jlc29sdmUscmVqZWN0XSxfdGhpcy5yZXNvbHZlcj1fYVswXSxfdGhpcy5yZWplY3Rlcj1fYVsxXSxfYX0pfVByb21pc2VTb3VyY2UucHJvdG90eXBlLnJlc29sdmU9ZnVuY3Rpb24oKXt0aGlzLnJlc29sdmVyKCl9O1Byb21pc2VTb3VyY2UucHJvdG90eXBlLnJlamVjdD1mdW5jdGlvbihyZWFzb24pe3RoaXMucmVqZWN0ZXIocmVhc29uKX07cmV0dXJuIFByb21pc2VTb3VyY2V9KCl9LGZ1bmN0aW9uKG1vZHVsZSxfX3dlYnBhY2tfZXhwb3J0c19fLF9fd2VicGFja19yZXF1aXJlX18peyJ1c2Ugc3RyaWN0IjtfX3dlYnBhY2tfcmVxdWlyZV9fLnIoX193ZWJwYWNrX2V4cG9ydHNfXyk7X193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIkh0dHBUcmFuc3BvcnRUeXBlIixmdW5jdGlvbigpe3JldHVybiBIdHRwVHJhbnNwb3J0VHlwZX0pO19fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCJUcmFuc2ZlckZvcm1hdCIsZnVuY3Rpb24oKXtyZXR1cm4gVHJhbnNmZXJGb3JtYXR9KTt2YXIgSHR0cFRyYW5zcG9ydFR5cGU7KGZ1bmN0aW9uKEh0dHBUcmFuc3BvcnRUeXBlKXtIdHRwVHJhbnNwb3J0VHlwZVtIdHRwVHJhbnNwb3J0VHlwZVsiTm9uZSJdPTBdPSJOb25lIjtIdHRwVHJhbnNwb3J0VHlwZVtIdHRwVHJhbnNwb3J0VHlwZVsiV2ViU29ja2V0cyJdPTFdPSJXZWJTb2NrZXRzIjtIdHRwVHJhbnNwb3J0VHlwZVtIdHRwVHJhbnNwb3J0VHlwZVsiU2VydmVyU2VudEV2ZW50cyJdPTJdPSJTZXJ2ZXJTZW50RXZlbnRzIjtIdHRwVHJhbnNwb3J0VHlwZVtIdHRwVHJhbnNwb3J0VHlwZVsiTG9uZ1BvbGxpbmciXT00XT0iTG9uZ1BvbGxpbmcifSkoSHR0cFRyYW5zcG9ydFR5cGV8fChIdHRwVHJhbnNwb3J0VHlwZT17fSkpO3ZhciBUcmFuc2ZlckZvcm1hdDsoZnVuY3Rpb24oVHJhbnNmZXJGb3JtYXQpe1RyYW5zZmVyRm9ybWF0W1RyYW5zZmVyRm9ybWF0WyJUZXh0Il09MV09IlRleHQiO1RyYW5zZmVyRm9ybWF0W1RyYW5zZmVyRm9ybWF0WyJCaW5hcnkiXT0yXT0iQmluYXJ5In0pKFRyYW5zZmVyRm9ybWF0fHwoVHJhbnNmZXJGb3JtYXQ9e30pKX0sZnVuY3Rpb24obW9kdWxlLF9fd2VicGFja19leHBvcnRzX18sX193ZWJwYWNrX3JlcXVpcmVfXyl7InVzZSBzdHJpY3QiO19fd2VicGFja19yZXF1aXJlX18ucihfX3dlYnBhY2tfZXhwb3J0c19fKTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiTG9uZ1BvbGxpbmdUcmFuc3BvcnQiLGZ1bmN0aW9uKCl7cmV0dXJuIExvbmdQb2xsaW5nVHJhbnNwb3J0fSk7dmFyIF9BYm9ydENvbnRyb2xsZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfXz1fX3dlYnBhY2tfcmVxdWlyZV9fKDIyKTt2YXIgX0Vycm9yc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fPV9fd2VicGFja19yZXF1aXJlX18oNCk7dmFyIF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX189X193ZWJwYWNrX3JlcXVpcmVfXyg4KTt2YXIgX0lUcmFuc3BvcnRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzNfXz1fX3dlYnBhY2tfcmVxdWlyZV9fKDIwKTt2YXIgX1V0aWxzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV80X189X193ZWJwYWNrX3JlcXVpcmVfXyg5KTt2YXIgX19hc3NpZ249dW5kZWZpbmVkJiZ1bmRlZmluZWQuX19hc3NpZ258fE9iamVjdC5hc3NpZ258fGZ1bmN0aW9uKHQpe2Zvcih2YXIgcyxpPTEsbj1hcmd1bWVudHMubGVuZ3RoO2k8bjtpKyspe3M9YXJndW1lbnRzW2ldO2Zvcih2YXIgcCBpbiBzKWlmKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLHApKXRbcF09c1twXX1yZXR1cm4gdH07dmFyIF9fYXdhaXRlcj11bmRlZmluZWQmJnVuZGVmaW5lZC5fX2F3YWl0ZXJ8fGZ1bmN0aW9uKHRoaXNBcmcsX2FyZ3VtZW50cyxQLGdlbmVyYXRvcil7cmV0dXJuIG5ldyhQfHwoUD1Qcm9taXNlKSkoZnVuY3Rpb24ocmVzb2x2ZSxyZWplY3Qpe2Z1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSl7dHJ5e3N0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKX1jYXRjaChlKXtyZWplY3QoZSl9fWZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKXt0cnl7c3RlcChnZW5lcmF0b3JbInRocm93Il0odmFsdWUpKX1jYXRjaChlKXtyZWplY3QoZSl9fWZ1bmN0aW9uIHN0ZXAocmVzdWx0KXtyZXN1bHQuZG9uZT9yZXNvbHZlKHJlc3VsdC52YWx1ZSk6bmV3IFAoZnVuY3Rpb24ocmVzb2x2ZSl7cmVzb2x2ZShyZXN1bHQudmFsdWUpfSkudGhlbihmdWxmaWxsZWQscmVqZWN0ZWQpfXN0ZXAoKGdlbmVyYXRvcj1nZW5lcmF0b3IuYXBwbHkodGhpc0FyZyxfYXJndW1lbnRzfHxbXSkpLm5leHQoKSl9KX07dmFyIF9fZ2VuZXJhdG9yPXVuZGVmaW5lZCYmdW5kZWZpbmVkLl9fZ2VuZXJhdG9yfHxmdW5jdGlvbih0aGlzQXJnLGJvZHkpe3ZhciBfPXtsYWJlbDowLHNlbnQ6ZnVuY3Rpb24oKXtpZih0WzBdJjEpdGhyb3cgdFsxXTtyZXR1cm4gdFsxXX0sdHJ5czpbXSxvcHM6W119LGYseSx0LGc7cmV0dXJuIGc9e25leHQ6dmVyYigwKSx0aHJvdzp2ZXJiKDEpLHJldHVybjp2ZXJiKDIpfSx0eXBlb2YgU3ltYm9sPT09ImZ1bmN0aW9uIiYmKGdbU3ltYm9sLml0ZXJhdG9yXT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSksZztmdW5jdGlvbiB2ZXJiKG4pe3JldHVybiBmdW5jdGlvbih2KXtyZXR1cm4gc3RlcChbbix2XSl9fWZ1bmN0aW9uIHN0ZXAob3Ape2lmKGYpdGhyb3cgbmV3IFR5cGVFcnJvcigiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLiIpO3doaWxlKF8pdHJ5e2lmKGY9MSx5JiYodD1vcFswXSYyP3lbInJldHVybiJdOm9wWzBdP3lbInRocm93Il18fCgodD15WyJyZXR1cm4iXSkmJnQuY2FsbCh5KSwwKTp5Lm5leHQpJiYhKHQ9dC5jYWxsKHksb3BbMV0pKS5kb25lKXJldHVybiB0O2lmKHk9MCx0KW9wPVtvcFswXSYyLHQudmFsdWVdO3N3aXRjaChvcFswXSl7Y2FzZSAwOmNhc2UgMTp0PW9wO2JyZWFrO2Nhc2UgNDpfLmxhYmVsKys7cmV0dXJue3ZhbHVlOm9wWzFdLGRvbmU6ZmFsc2V9O2Nhc2UgNTpfLmxhYmVsKys7eT1vcFsxXTtvcD1bMF07Y29udGludWU7Y2FzZSA3Om9wPV8ub3BzLnBvcCgpO18udHJ5cy5wb3AoKTtjb250aW51ZTtkZWZhdWx0OmlmKCEodD1fLnRyeXMsdD10Lmxlbmd0aD4wJiZ0W3QubGVuZ3RoLTFdKSYmKG9wWzBdPT09Nnx8b3BbMF09PT0yKSl7Xz0wO2NvbnRpbnVlfWlmKG9wWzBdPT09MyYmKCF0fHxvcFsxXT50WzBdJiZvcFsxXTx0WzNdKSl7Xy5sYWJlbD1vcFsxXTticmVha31pZihvcFswXT09PTYmJl8ubGFiZWw8dFsxXSl7Xy5sYWJlbD10WzFdO3Q9b3A7YnJlYWt9aWYodCYmXy5sYWJlbDx0WzJdKXtfLmxhYmVsPXRbMl07Xy5vcHMucHVzaChvcCk7YnJlYWt9aWYodFsyXSlfLm9wcy5wb3AoKTtfLnRyeXMucG9wKCk7Y29udGludWV9b3A9Ym9keS5jYWxsKHRoaXNBcmcsXyl9Y2F0Y2goZSl7b3A9WzYsZV07eT0wfWZpbmFsbHl7Zj10PTB9aWYob3BbMF0mNSl0aHJvdyBvcFsxXTtyZXR1cm57dmFsdWU6b3BbMF0/b3BbMV06dm9pZCAwLGRvbmU6dHJ1ZX19fTt2YXIgTG9uZ1BvbGxpbmdUcmFuc3BvcnQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBMb25nUG9sbGluZ1RyYW5zcG9ydChodHRwQ2xpZW50LGFjY2Vzc1Rva2VuRmFjdG9yeSxsb2dnZXIsbG9nTWVzc2FnZUNvbnRlbnQsd2l0aENyZWRlbnRpYWxzLGhlYWRlcnMpe3RoaXMuaHR0cENsaWVudD1odHRwQ2xpZW50O3RoaXMuYWNjZXNzVG9rZW5GYWN0b3J5PWFjY2Vzc1Rva2VuRmFjdG9yeTt0aGlzLmxvZ2dlcj1sb2dnZXI7dGhpcy5wb2xsQWJvcnQ9bmV3IF9BYm9ydENvbnRyb2xsZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX1siQWJvcnRDb250cm9sbGVyIl07dGhpcy5sb2dNZXNzYWdlQ29udGVudD1sb2dNZXNzYWdlQ29udGVudDt0aGlzLndpdGhDcmVkZW50aWFscz13aXRoQ3JlZGVudGlhbHM7dGhpcy5oZWFkZXJzPWhlYWRlcnM7dGhpcy5ydW5uaW5nPWZhbHNlO3RoaXMub25yZWNlaXZlPW51bGw7dGhpcy5vbmNsb3NlPW51bGx9T2JqZWN0LmRlZmluZVByb3BlcnR5KExvbmdQb2xsaW5nVHJhbnNwb3J0LnByb3RvdHlwZSwicG9sbEFib3J0ZWQiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wb2xsQWJvcnQuYWJvcnRlZH0sZW51bWVyYWJsZTp0cnVlLGNvbmZpZ3VyYWJsZTp0cnVlfSk7TG9uZ1BvbGxpbmdUcmFuc3BvcnQucHJvdG90eXBlLmNvbm5lY3Q9ZnVuY3Rpb24odXJsLHRyYW5zZmVyRm9ybWF0KXtyZXR1cm4gX19hd2FpdGVyKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbigpe3ZhciBfYSxfYixuYW1lLHZhbHVlLGhlYWRlcnMscG9sbE9wdGlvbnMsdG9rZW4scG9sbFVybCxyZXNwb25zZTtyZXR1cm4gX19nZW5lcmF0b3IodGhpcyxmdW5jdGlvbihfYyl7c3dpdGNoKF9jLmxhYmVsKXtjYXNlIDA6X1V0aWxzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV80X19bIkFyZyJdLmlzUmVxdWlyZWQodXJsLCJ1cmwiKTtfVXRpbHNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzRfX1siQXJnIl0uaXNSZXF1aXJlZCh0cmFuc2ZlckZvcm1hdCwidHJhbnNmZXJGb3JtYXQiKTtfVXRpbHNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzRfX1siQXJnIl0uaXNJbih0cmFuc2ZlckZvcm1hdCxfSVRyYW5zcG9ydF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfM19fWyJUcmFuc2ZlckZvcm1hdCJdLCJ0cmFuc2ZlckZvcm1hdCIpO3RoaXMudXJsPXVybDt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siTG9nTGV2ZWwiXS5UcmFjZSwiKExvbmdQb2xsaW5nIHRyYW5zcG9ydCkgQ29ubmVjdGluZy4iKTtpZih0cmFuc2ZlckZvcm1hdD09PV9JVHJhbnNwb3J0X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8zX19bIlRyYW5zZmVyRm9ybWF0Il0uQmluYXJ5JiYodHlwZW9mIFhNTEh0dHBSZXF1ZXN0IT09InVuZGVmaW5lZCImJnR5cGVvZihuZXcgWE1MSHR0cFJlcXVlc3QpLnJlc3BvbnNlVHlwZSE9PSJzdHJpbmciKSl7dGhyb3cgbmV3IEVycm9yKCJCaW5hcnkgcHJvdG9jb2xzIG92ZXIgWG1sSHR0cFJlcXVlc3Qgbm90IGltcGxlbWVudGluZyBhZHZhbmNlZCBmZWF0dXJlcyBhcmUgbm90IHN1cHBvcnRlZC4iKX1fYj1PYmplY3QoX1V0aWxzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV80X19bImdldFVzZXJBZ2VudEhlYWRlciJdKSgpLG5hbWU9X2JbMF0sdmFsdWU9X2JbMV07aGVhZGVycz1fX2Fzc2lnbigoX2E9e30sX2FbbmFtZV09dmFsdWUsX2EpLHRoaXMuaGVhZGVycyk7cG9sbE9wdGlvbnM9e2Fib3J0U2lnbmFsOnRoaXMucG9sbEFib3J0LnNpZ25hbCxoZWFkZXJzOmhlYWRlcnMsdGltZW91dDoxZTUsd2l0aENyZWRlbnRpYWxzOnRoaXMud2l0aENyZWRlbnRpYWxzfTtpZih0cmFuc2ZlckZvcm1hdD09PV9JVHJhbnNwb3J0X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8zX19bIlRyYW5zZmVyRm9ybWF0Il0uQmluYXJ5KXtwb2xsT3B0aW9ucy5yZXNwb25zZVR5cGU9ImFycmF5YnVmZmVyIn1yZXR1cm5bNCx0aGlzLmdldEFjY2Vzc1Rva2VuKCldO2Nhc2UgMTp0b2tlbj1fYy5zZW50KCk7dGhpcy51cGRhdGVIZWFkZXJUb2tlbihwb2xsT3B0aW9ucyx0b2tlbik7cG9sbFVybD11cmwrIiZfPSIrRGF0ZS5ub3coKTt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siTG9nTGV2ZWwiXS5UcmFjZSwiKExvbmdQb2xsaW5nIHRyYW5zcG9ydCkgcG9sbGluZzogIitwb2xsVXJsKyIuIik7cmV0dXJuWzQsdGhpcy5odHRwQ2xpZW50LmdldChwb2xsVXJsLHBvbGxPcHRpb25zKV07Y2FzZSAyOnJlc3BvbnNlPV9jLnNlbnQoKTtpZihyZXNwb25zZS5zdGF0dXNDb2RlIT09MjAwKXt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siTG9nTGV2ZWwiXS5FcnJvciwiKExvbmdQb2xsaW5nIHRyYW5zcG9ydCkgVW5leHBlY3RlZCByZXNwb25zZSBjb2RlOiAiK3Jlc3BvbnNlLnN0YXR1c0NvZGUrIi4iKTt0aGlzLmNsb3NlRXJyb3I9bmV3IF9FcnJvcnNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siSHR0cEVycm9yIl0ocmVzcG9uc2Uuc3RhdHVzVGV4dHx8IiIscmVzcG9uc2Uuc3RhdHVzQ29kZSk7dGhpcy5ydW5uaW5nPWZhbHNlfWVsc2V7dGhpcy5ydW5uaW5nPXRydWV9dGhpcy5yZWNlaXZpbmc9dGhpcy5wb2xsKHRoaXMudXJsLHBvbGxPcHRpb25zKTtyZXR1cm5bMl19fSl9KX07TG9uZ1BvbGxpbmdUcmFuc3BvcnQucHJvdG90eXBlLmdldEFjY2Vzc1Rva2VuPWZ1bmN0aW9uKCl7cmV0dXJuIF9fYXdhaXRlcih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24oKXtyZXR1cm4gX19nZW5lcmF0b3IodGhpcyxmdW5jdGlvbihfYSl7c3dpdGNoKF9hLmxhYmVsKXtjYXNlIDA6aWYoIXRoaXMuYWNjZXNzVG9rZW5GYWN0b3J5KXJldHVyblszLDJdO3JldHVybls0LHRoaXMuYWNjZXNzVG9rZW5GYWN0b3J5KCldO2Nhc2UgMTpyZXR1cm5bMixfYS5zZW50KCldO2Nhc2UgMjpyZXR1cm5bMixudWxsXX19KX0pfTtMb25nUG9sbGluZ1RyYW5zcG9ydC5wcm90b3R5cGUudXBkYXRlSGVhZGVyVG9rZW49ZnVuY3Rpb24ocmVxdWVzdCx0b2tlbil7aWYoIXJlcXVlc3QuaGVhZGVycyl7cmVxdWVzdC5oZWFkZXJzPXt9fWlmKHRva2VuKXtyZXF1ZXN0LmhlYWRlcnNbIkF1dGhvcml6YXRpb24iXT0iQmVhcmVyICIrdG9rZW47cmV0dXJufWlmKHJlcXVlc3QuaGVhZGVyc1siQXV0aG9yaXphdGlvbiJdKXtkZWxldGUgcmVxdWVzdC5oZWFkZXJzWyJBdXRob3JpemF0aW9uIl19fTtMb25nUG9sbGluZ1RyYW5zcG9ydC5wcm90b3R5cGUucG9sbD1mdW5jdGlvbih1cmwscG9sbE9wdGlvbnMpe3JldHVybiBfX2F3YWl0ZXIodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKCl7dmFyIHRva2VuLHBvbGxVcmwscmVzcG9uc2UsZV8xO3JldHVybiBfX2dlbmVyYXRvcih0aGlzLGZ1bmN0aW9uKF9hKXtzd2l0Y2goX2EubGFiZWwpe2Nhc2UgMDpfYS50cnlzLnB1c2goWzAsLDgsOV0pO19hLmxhYmVsPTE7Y2FzZSAxOmlmKCF0aGlzLnJ1bm5pbmcpcmV0dXJuWzMsN107cmV0dXJuWzQsdGhpcy5nZXRBY2Nlc3NUb2tlbigpXTtjYXNlIDI6dG9rZW49X2Euc2VudCgpO3RoaXMudXBkYXRlSGVhZGVyVG9rZW4ocG9sbE9wdGlvbnMsdG9rZW4pO19hLmxhYmVsPTM7Y2FzZSAzOl9hLnRyeXMucHVzaChbMyw1LCw2XSk7cG9sbFVybD11cmwrIiZfPSIrRGF0ZS5ub3coKTt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siTG9nTGV2ZWwiXS5UcmFjZSwiKExvbmdQb2xsaW5nIHRyYW5zcG9ydCkgcG9sbGluZzogIitwb2xsVXJsKyIuIik7cmV0dXJuWzQsdGhpcy5odHRwQ2xpZW50LmdldChwb2xsVXJsLHBvbGxPcHRpb25zKV07Y2FzZSA0OnJlc3BvbnNlPV9hLnNlbnQoKTtpZihyZXNwb25zZS5zdGF0dXNDb2RlPT09MjA0KXt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siTG9nTGV2ZWwiXS5JbmZvcm1hdGlvbiwiKExvbmdQb2xsaW5nIHRyYW5zcG9ydCkgUG9sbCB0ZXJtaW5hdGVkIGJ5IHNlcnZlci4iKTt0aGlzLnJ1bm5pbmc9ZmFsc2V9ZWxzZSBpZihyZXNwb25zZS5zdGF0dXNDb2RlIT09MjAwKXt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siTG9nTGV2ZWwiXS5FcnJvciwiKExvbmdQb2xsaW5nIHRyYW5zcG9ydCkgVW5leHBlY3RlZCByZXNwb25zZSBjb2RlOiAiK3Jlc3BvbnNlLnN0YXR1c0NvZGUrIi4iKTt0aGlzLmNsb3NlRXJyb3I9bmV3IF9FcnJvcnNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siSHR0cEVycm9yIl0ocmVzcG9uc2Uuc3RhdHVzVGV4dHx8IiIscmVzcG9uc2Uuc3RhdHVzQ29kZSk7dGhpcy5ydW5uaW5nPWZhbHNlfWVsc2V7aWYocmVzcG9uc2UuY29udGVudCl7dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIkxvZ0xldmVsIl0uVHJhY2UsIihMb25nUG9sbGluZyB0cmFuc3BvcnQpIGRhdGEgcmVjZWl2ZWQuICIrT2JqZWN0KF9VdGlsc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfNF9fWyJnZXREYXRhRGV0YWlsIl0pKHJlc3BvbnNlLmNvbnRlbnQsdGhpcy5sb2dNZXNzYWdlQ29udGVudCkrIi4iKTtpZih0aGlzLm9ucmVjZWl2ZSl7dGhpcy5vbnJlY2VpdmUocmVzcG9uc2UuY29udGVudCl9fWVsc2V7dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIkxvZ0xldmVsIl0uVHJhY2UsIihMb25nUG9sbGluZyB0cmFuc3BvcnQpIFBvbGwgdGltZWQgb3V0LCByZWlzc3VpbmcuIil9fXJldHVyblszLDZdO2Nhc2UgNTplXzE9X2Euc2VudCgpO2lmKCF0aGlzLnJ1bm5pbmcpe3RoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJMb2dMZXZlbCJdLlRyYWNlLCIoTG9uZ1BvbGxpbmcgdHJhbnNwb3J0KSBQb2xsIGVycm9yZWQgYWZ0ZXIgc2h1dGRvd246ICIrZV8xLm1lc3NhZ2UpfWVsc2V7aWYoZV8xIGluc3RhbmNlb2YgX0Vycm9yc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJUaW1lb3V0RXJyb3IiXSl7dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIkxvZ0xldmVsIl0uVHJhY2UsIihMb25nUG9sbGluZyB0cmFuc3BvcnQpIFBvbGwgdGltZWQgb3V0LCByZWlzc3VpbmcuIil9ZWxzZXt0aGlzLmNsb3NlRXJyb3I9ZV8xO3RoaXMucnVubmluZz1mYWxzZX19cmV0dXJuWzMsNl07Y2FzZSA2OnJldHVyblszLDFdO2Nhc2UgNzpyZXR1cm5bMyw5XTtjYXNlIDg6dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIkxvZ0xldmVsIl0uVHJhY2UsIihMb25nUG9sbGluZyB0cmFuc3BvcnQpIFBvbGxpbmcgY29tcGxldGUuIik7aWYoIXRoaXMucG9sbEFib3J0ZWQpe3RoaXMucmFpc2VPbkNsb3NlKCl9cmV0dXJuWzddO2Nhc2UgOTpyZXR1cm5bMl19fSl9KX07TG9uZ1BvbGxpbmdUcmFuc3BvcnQucHJvdG90eXBlLnNlbmQ9ZnVuY3Rpb24oZGF0YSl7cmV0dXJuIF9fYXdhaXRlcih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24oKXtyZXR1cm4gX19nZW5lcmF0b3IodGhpcyxmdW5jdGlvbihfYSl7aWYoIXRoaXMucnVubmluZyl7cmV0dXJuWzIsUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCJDYW5ub3Qgc2VuZCB1bnRpbCB0aGUgdHJhbnNwb3J0IGlzIGNvbm5lY3RlZCIpKV19cmV0dXJuWzIsT2JqZWN0KF9VdGlsc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfNF9fWyJzZW5kTWVzc2FnZSJdKSh0aGlzLmxvZ2dlciwiTG9uZ1BvbGxpbmciLHRoaXMuaHR0cENsaWVudCx0aGlzLnVybCx0aGlzLmFjY2Vzc1Rva2VuRmFjdG9yeSxkYXRhLHRoaXMubG9nTWVzc2FnZUNvbnRlbnQsdGhpcy53aXRoQ3JlZGVudGlhbHMsdGhpcy5oZWFkZXJzKV19KX0pfTtMb25nUG9sbGluZ1RyYW5zcG9ydC5wcm90b3R5cGUuc3RvcD1mdW5jdGlvbigpe3JldHVybiBfX2F3YWl0ZXIodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKCl7dmFyIGhlYWRlcnMsX2EsbmFtZV8xLHZhbHVlLGRlbGV0ZU9wdGlvbnMsdG9rZW47cmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsZnVuY3Rpb24oX2Ipe3N3aXRjaChfYi5sYWJlbCl7Y2FzZSAwOnRoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJMb2dMZXZlbCJdLlRyYWNlLCIoTG9uZ1BvbGxpbmcgdHJhbnNwb3J0KSBTdG9wcGluZyBwb2xsaW5nLiIpO3RoaXMucnVubmluZz1mYWxzZTt0aGlzLnBvbGxBYm9ydC5hYm9ydCgpO19iLmxhYmVsPTE7Y2FzZSAxOl9iLnRyeXMucHVzaChbMSwsNSw2XSk7cmV0dXJuWzQsdGhpcy5yZWNlaXZpbmddO2Nhc2UgMjpfYi5zZW50KCk7dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIkxvZ0xldmVsIl0uVHJhY2UsIihMb25nUG9sbGluZyB0cmFuc3BvcnQpIHNlbmRpbmcgREVMRVRFIHJlcXVlc3QgdG8gIit0aGlzLnVybCsiLiIpO2hlYWRlcnM9e307X2E9T2JqZWN0KF9VdGlsc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfNF9fWyJnZXRVc2VyQWdlbnRIZWFkZXIiXSkoKSxuYW1lXzE9X2FbMF0sdmFsdWU9X2FbMV07aGVhZGVyc1tuYW1lXzFdPXZhbHVlO2RlbGV0ZU9wdGlvbnM9e2hlYWRlcnM6X19hc3NpZ24oe30saGVhZGVycyx0aGlzLmhlYWRlcnMpLHdpdGhDcmVkZW50aWFsczp0aGlzLndpdGhDcmVkZW50aWFsc307cmV0dXJuWzQsdGhpcy5nZXRBY2Nlc3NUb2tlbigpXTtjYXNlIDM6dG9rZW49X2Iuc2VudCgpO3RoaXMudXBkYXRlSGVhZGVyVG9rZW4oZGVsZXRlT3B0aW9ucyx0b2tlbik7cmV0dXJuWzQsdGhpcy5odHRwQ2xpZW50LmRlbGV0ZSh0aGlzLnVybCxkZWxldGVPcHRpb25zKV07Y2FzZSA0Ol9iLnNlbnQoKTt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siTG9nTGV2ZWwiXS5UcmFjZSwiKExvbmdQb2xsaW5nIHRyYW5zcG9ydCkgREVMRVRFIHJlcXVlc3Qgc2VudC4iKTtyZXR1cm5bMyw2XTtjYXNlIDU6dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIkxvZ0xldmVsIl0uVHJhY2UsIihMb25nUG9sbGluZyB0cmFuc3BvcnQpIFN0b3AgZmluaXNoZWQuIik7dGhpcy5yYWlzZU9uQ2xvc2UoKTtyZXR1cm5bN107Y2FzZSA2OnJldHVyblsyXX19KX0pfTtMb25nUG9sbGluZ1RyYW5zcG9ydC5wcm90b3R5cGUucmFpc2VPbkNsb3NlPWZ1bmN0aW9uKCl7aWYodGhpcy5vbmNsb3NlKXt2YXIgbG9nTWVzc2FnZT0iKExvbmdQb2xsaW5nIHRyYW5zcG9ydCkgRmlyaW5nIG9uY2xvc2UgZXZlbnQuIjtpZih0aGlzLmNsb3NlRXJyb3Ipe2xvZ01lc3NhZ2UrPSIgRXJyb3I6ICIrdGhpcy5jbG9zZUVycm9yfXRoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJMb2dMZXZlbCJdLlRyYWNlLGxvZ01lc3NhZ2UpO3RoaXMub25jbG9zZSh0aGlzLmNsb3NlRXJyb3IpfX07cmV0dXJuIExvbmdQb2xsaW5nVHJhbnNwb3J0fSgpfSxmdW5jdGlvbihtb2R1bGUsX193ZWJwYWNrX2V4cG9ydHNfXyxfX3dlYnBhY2tfcmVxdWlyZV9fKXsidXNlIHN0cmljdCI7X193ZWJwYWNrX3JlcXVpcmVfXy5yKF9fd2VicGFja19leHBvcnRzX18pO19fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCJBYm9ydENvbnRyb2xsZXIiLGZ1bmN0aW9uKCl7cmV0dXJuIEFib3J0Q29udHJvbGxlcn0pO3ZhciBBYm9ydENvbnRyb2xsZXI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBBYm9ydENvbnRyb2xsZXIoKXt0aGlzLmlzQWJvcnRlZD1mYWxzZTt0aGlzLm9uYWJvcnQ9bnVsbH1BYm9ydENvbnRyb2xsZXIucHJvdG90eXBlLmFib3J0PWZ1bmN0aW9uKCl7aWYoIXRoaXMuaXNBYm9ydGVkKXt0aGlzLmlzQWJvcnRlZD10cnVlO2lmKHRoaXMub25hYm9ydCl7dGhpcy5vbmFib3J0KCl9fX07T2JqZWN0LmRlZmluZVByb3BlcnR5KEFib3J0Q29udHJvbGxlci5wcm90b3R5cGUsInNpZ25hbCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzfSxlbnVtZXJhYmxlOnRydWUsY29uZmlndXJhYmxlOnRydWV9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoQWJvcnRDb250cm9sbGVyLnByb3RvdHlwZSwiYWJvcnRlZCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmlzQWJvcnRlZH0sZW51bWVyYWJsZTp0cnVlLGNvbmZpZ3VyYWJsZTp0cnVlfSk7cmV0dXJuIEFib3J0Q29udHJvbGxlcn0oKX0sZnVuY3Rpb24obW9kdWxlLF9fd2VicGFja19leHBvcnRzX18sX193ZWJwYWNrX3JlcXVpcmVfXyl7InVzZSBzdHJpY3QiO19fd2VicGFja19yZXF1aXJlX18ucihfX3dlYnBhY2tfZXhwb3J0c19fKTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiU2VydmVyU2VudEV2ZW50c1RyYW5zcG9ydCIsZnVuY3Rpb24oKXtyZXR1cm4gU2VydmVyU2VudEV2ZW50c1RyYW5zcG9ydH0pO3ZhciBfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fPV9fd2VicGFja19yZXF1aXJlX18oOCk7dmFyIF9JVHJhbnNwb3J0X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX189X193ZWJwYWNrX3JlcXVpcmVfXygyMCk7dmFyIF9VdGlsc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fPV9fd2VicGFja19yZXF1aXJlX18oOSk7dmFyIF9fYXNzaWduPXVuZGVmaW5lZCYmdW5kZWZpbmVkLl9fYXNzaWdufHxPYmplY3QuYXNzaWdufHxmdW5jdGlvbih0KXtmb3IodmFyIHMsaT0xLG49YXJndW1lbnRzLmxlbmd0aDtpPG47aSsrKXtzPWFyZ3VtZW50c1tpXTtmb3IodmFyIHAgaW4gcylpZihPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocyxwKSl0W3BdPXNbcF19cmV0dXJuIHR9O3ZhciBfX2F3YWl0ZXI9dW5kZWZpbmVkJiZ1bmRlZmluZWQuX19hd2FpdGVyfHxmdW5jdGlvbih0aGlzQXJnLF9hcmd1bWVudHMsUCxnZW5lcmF0b3Ipe3JldHVybiBuZXcoUHx8KFA9UHJvbWlzZSkpKGZ1bmN0aW9uKHJlc29sdmUscmVqZWN0KXtmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpe3RyeXtzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSl9Y2F0Y2goZSl7cmVqZWN0KGUpfX1mdW5jdGlvbiByZWplY3RlZCh2YWx1ZSl7dHJ5e3N0ZXAoZ2VuZXJhdG9yWyJ0aHJvdyJdKHZhbHVlKSl9Y2F0Y2goZSl7cmVqZWN0KGUpfX1mdW5jdGlvbiBzdGVwKHJlc3VsdCl7cmVzdWx0LmRvbmU/cmVzb2x2ZShyZXN1bHQudmFsdWUpOm5ldyBQKGZ1bmN0aW9uKHJlc29sdmUpe3Jlc29sdmUocmVzdWx0LnZhbHVlKX0pLnRoZW4oZnVsZmlsbGVkLHJlamVjdGVkKX1zdGVwKChnZW5lcmF0b3I9Z2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsX2FyZ3VtZW50c3x8W10pKS5uZXh0KCkpfSl9O3ZhciBfX2dlbmVyYXRvcj11bmRlZmluZWQmJnVuZGVmaW5lZC5fX2dlbmVyYXRvcnx8ZnVuY3Rpb24odGhpc0FyZyxib2R5KXt2YXIgXz17bGFiZWw6MCxzZW50OmZ1bmN0aW9uKCl7aWYodFswXSYxKXRocm93IHRbMV07cmV0dXJuIHRbMV19LHRyeXM6W10sb3BzOltdfSxmLHksdCxnO3JldHVybiBnPXtuZXh0OnZlcmIoMCksdGhyb3c6dmVyYigxKSxyZXR1cm46dmVyYigyKX0sdHlwZW9mIFN5bWJvbD09PSJmdW5jdGlvbiImJihnW1N5bWJvbC5pdGVyYXRvcl09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30pLGc7ZnVuY3Rpb24gdmVyYihuKXtyZXR1cm4gZnVuY3Rpb24odil7cmV0dXJuIHN0ZXAoW24sdl0pfX1mdW5jdGlvbiBzdGVwKG9wKXtpZihmKXRocm93IG5ldyBUeXBlRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy4iKTt3aGlsZShfKXRyeXtpZihmPTEseSYmKHQ9b3BbMF0mMj95WyJyZXR1cm4iXTpvcFswXT95WyJ0aHJvdyJdfHwoKHQ9eVsicmV0dXJuIl0pJiZ0LmNhbGwoeSksMCk6eS5uZXh0KSYmISh0PXQuY2FsbCh5LG9wWzFdKSkuZG9uZSlyZXR1cm4gdDtpZih5PTAsdClvcD1bb3BbMF0mMix0LnZhbHVlXTtzd2l0Y2gob3BbMF0pe2Nhc2UgMDpjYXNlIDE6dD1vcDticmVhaztjYXNlIDQ6Xy5sYWJlbCsrO3JldHVybnt2YWx1ZTpvcFsxXSxkb25lOmZhbHNlfTtjYXNlIDU6Xy5sYWJlbCsrO3k9b3BbMV07b3A9WzBdO2NvbnRpbnVlO2Nhc2UgNzpvcD1fLm9wcy5wb3AoKTtfLnRyeXMucG9wKCk7Y29udGludWU7ZGVmYXVsdDppZighKHQ9Xy50cnlzLHQ9dC5sZW5ndGg+MCYmdFt0Lmxlbmd0aC0xXSkmJihvcFswXT09PTZ8fG9wWzBdPT09Mikpe189MDtjb250aW51ZX1pZihvcFswXT09PTMmJighdHx8b3BbMV0+dFswXSYmb3BbMV08dFszXSkpe18ubGFiZWw9b3BbMV07YnJlYWt9aWYob3BbMF09PT02JiZfLmxhYmVsPHRbMV0pe18ubGFiZWw9dFsxXTt0PW9wO2JyZWFrfWlmKHQmJl8ubGFiZWw8dFsyXSl7Xy5sYWJlbD10WzJdO18ub3BzLnB1c2gob3ApO2JyZWFrfWlmKHRbMl0pXy5vcHMucG9wKCk7Xy50cnlzLnBvcCgpO2NvbnRpbnVlfW9wPWJvZHkuY2FsbCh0aGlzQXJnLF8pfWNhdGNoKGUpe29wPVs2LGVdO3k9MH1maW5hbGx5e2Y9dD0wfWlmKG9wWzBdJjUpdGhyb3cgb3BbMV07cmV0dXJue3ZhbHVlOm9wWzBdP29wWzFdOnZvaWQgMCxkb25lOnRydWV9fX07dmFyIFNlcnZlclNlbnRFdmVudHNUcmFuc3BvcnQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBTZXJ2ZXJTZW50RXZlbnRzVHJhbnNwb3J0KGh0dHBDbGllbnQsYWNjZXNzVG9rZW5GYWN0b3J5LGxvZ2dlcixsb2dNZXNzYWdlQ29udGVudCxldmVudFNvdXJjZUNvbnN0cnVjdG9yLHdpdGhDcmVkZW50aWFscyxoZWFkZXJzKXt0aGlzLmh0dHBDbGllbnQ9aHR0cENsaWVudDt0aGlzLmFjY2Vzc1Rva2VuRmFjdG9yeT1hY2Nlc3NUb2tlbkZhY3Rvcnk7dGhpcy5sb2dnZXI9bG9nZ2VyO3RoaXMubG9nTWVzc2FnZUNvbnRlbnQ9bG9nTWVzc2FnZUNvbnRlbnQ7dGhpcy53aXRoQ3JlZGVudGlhbHM9d2l0aENyZWRlbnRpYWxzO3RoaXMuZXZlbnRTb3VyY2VDb25zdHJ1Y3Rvcj1ldmVudFNvdXJjZUNvbnN0cnVjdG9yO3RoaXMuaGVhZGVycz1oZWFkZXJzO3RoaXMub25yZWNlaXZlPW51bGw7dGhpcy5vbmNsb3NlPW51bGx9U2VydmVyU2VudEV2ZW50c1RyYW5zcG9ydC5wcm90b3R5cGUuY29ubmVjdD1mdW5jdGlvbih1cmwsdHJhbnNmZXJGb3JtYXQpe3JldHVybiBfX2F3YWl0ZXIodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKCl7dmFyIHRva2VuO3ZhciBfdGhpcz10aGlzO3JldHVybiBfX2dlbmVyYXRvcih0aGlzLGZ1bmN0aW9uKF9hKXtzd2l0Y2goX2EubGFiZWwpe2Nhc2UgMDpfVXRpbHNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siQXJnIl0uaXNSZXF1aXJlZCh1cmwsInVybCIpO19VdGlsc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJBcmciXS5pc1JlcXVpcmVkKHRyYW5zZmVyRm9ybWF0LCJ0cmFuc2ZlckZvcm1hdCIpO19VdGlsc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJBcmciXS5pc0luKHRyYW5zZmVyRm9ybWF0LF9JVHJhbnNwb3J0X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19bIlRyYW5zZmVyRm9ybWF0Il0sInRyYW5zZmVyRm9ybWF0Iik7dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19bIkxvZ0xldmVsIl0uVHJhY2UsIihTU0UgdHJhbnNwb3J0KSBDb25uZWN0aW5nLiIpO3RoaXMudXJsPXVybDtpZighdGhpcy5hY2Nlc3NUb2tlbkZhY3RvcnkpcmV0dXJuWzMsMl07cmV0dXJuWzQsdGhpcy5hY2Nlc3NUb2tlbkZhY3RvcnkoKV07Y2FzZSAxOnRva2VuPV9hLnNlbnQoKTtpZih0b2tlbil7dXJsKz0odXJsLmluZGV4T2YoIj8iKTwwPyI/IjoiJiIpKygiYWNjZXNzX3Rva2VuPSIrZW5jb2RlVVJJQ29tcG9uZW50KHRva2VuKSl9X2EubGFiZWw9MjtjYXNlIDI6cmV0dXJuWzIsbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSxyZWplY3Qpe3ZhciBvcGVuZWQ9ZmFsc2U7aWYodHJhbnNmZXJGb3JtYXQhPT1fSVRyYW5zcG9ydF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJUcmFuc2ZlckZvcm1hdCJdLlRleHQpe3JlamVjdChuZXcgRXJyb3IoIlRoZSBTZXJ2ZXItU2VudCBFdmVudHMgdHJhbnNwb3J0IG9ubHkgc3VwcG9ydHMgdGhlICdUZXh0JyB0cmFuc2ZlciBmb3JtYXQiKSk7cmV0dXJufXZhciBldmVudFNvdXJjZTtpZihfVXRpbHNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX1siUGxhdGZvcm0iXS5pc0Jyb3dzZXJ8fF9VdGlsc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJQbGF0Zm9ybSJdLmlzV2ViV29ya2VyKXtldmVudFNvdXJjZT1uZXcgX3RoaXMuZXZlbnRTb3VyY2VDb25zdHJ1Y3Rvcih1cmwse3dpdGhDcmVkZW50aWFsczpfdGhpcy53aXRoQ3JlZGVudGlhbHN9KX1lbHNle3ZhciBjb29raWVzPV90aGlzLmh0dHBDbGllbnQuZ2V0Q29va2llU3RyaW5nKHVybCk7dmFyIGhlYWRlcnM9e307aGVhZGVycy5Db29raWU9Y29va2llczt2YXIgX2E9T2JqZWN0KF9VdGlsc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJnZXRVc2VyQWdlbnRIZWFkZXIiXSkoKSxuYW1lXzE9X2FbMF0sdmFsdWU9X2FbMV07aGVhZGVyc1tuYW1lXzFdPXZhbHVlO2V2ZW50U291cmNlPW5ldyBfdGhpcy5ldmVudFNvdXJjZUNvbnN0cnVjdG9yKHVybCx7d2l0aENyZWRlbnRpYWxzOl90aGlzLndpdGhDcmVkZW50aWFscyxoZWFkZXJzOl9fYXNzaWduKHt9LGhlYWRlcnMsX3RoaXMuaGVhZGVycyl9KX10cnl7ZXZlbnRTb3VyY2Uub25tZXNzYWdlPWZ1bmN0aW9uKGUpe2lmKF90aGlzLm9ucmVjZWl2ZSl7dHJ5e190aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX1siTG9nTGV2ZWwiXS5UcmFjZSwiKFNTRSB0cmFuc3BvcnQpIGRhdGEgcmVjZWl2ZWQuICIrT2JqZWN0KF9VdGlsc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJnZXREYXRhRGV0YWlsIl0pKGUuZGF0YSxfdGhpcy5sb2dNZXNzYWdlQ29udGVudCkrIi4iKTtfdGhpcy5vbnJlY2VpdmUoZS5kYXRhKX1jYXRjaChlcnJvcil7X3RoaXMuY2xvc2UoZXJyb3IpO3JldHVybn19fTtldmVudFNvdXJjZS5vbmVycm9yPWZ1bmN0aW9uKGUpe3ZhciBlcnJvcj1uZXcgRXJyb3IoZS5kYXRhfHwiRXJyb3Igb2NjdXJyZWQiKTtpZihvcGVuZWQpe190aGlzLmNsb3NlKGVycm9yKX1lbHNle3JlamVjdChlcnJvcil9fTtldmVudFNvdXJjZS5vbm9wZW49ZnVuY3Rpb24oKXtfdGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19bIkxvZ0xldmVsIl0uSW5mb3JtYXRpb24sIlNTRSBjb25uZWN0ZWQgdG8gIitfdGhpcy51cmwpO190aGlzLmV2ZW50U291cmNlPWV2ZW50U291cmNlO29wZW5lZD10cnVlO3Jlc29sdmUoKX19Y2F0Y2goZSl7cmVqZWN0KGUpO3JldHVybn19KV19fSl9KX07U2VydmVyU2VudEV2ZW50c1RyYW5zcG9ydC5wcm90b3R5cGUuc2VuZD1mdW5jdGlvbihkYXRhKXtyZXR1cm4gX19hd2FpdGVyKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbigpe3JldHVybiBfX2dlbmVyYXRvcih0aGlzLGZ1bmN0aW9uKF9hKXtpZighdGhpcy5ldmVudFNvdXJjZSl7cmV0dXJuWzIsUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCJDYW5ub3Qgc2VuZCB1bnRpbCB0aGUgdHJhbnNwb3J0IGlzIGNvbm5lY3RlZCIpKV19cmV0dXJuWzIsT2JqZWN0KF9VdGlsc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJzZW5kTWVzc2FnZSJdKSh0aGlzLmxvZ2dlciwiU1NFIix0aGlzLmh0dHBDbGllbnQsdGhpcy51cmwsdGhpcy5hY2Nlc3NUb2tlbkZhY3RvcnksZGF0YSx0aGlzLmxvZ01lc3NhZ2VDb250ZW50LHRoaXMud2l0aENyZWRlbnRpYWxzLHRoaXMuaGVhZGVycyldfSl9KX07U2VydmVyU2VudEV2ZW50c1RyYW5zcG9ydC5wcm90b3R5cGUuc3RvcD1mdW5jdGlvbigpe3RoaXMuY2xvc2UoKTtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCl9O1NlcnZlclNlbnRFdmVudHNUcmFuc3BvcnQucHJvdG90eXBlLmNsb3NlPWZ1bmN0aW9uKGUpe2lmKHRoaXMuZXZlbnRTb3VyY2Upe3RoaXMuZXZlbnRTb3VyY2UuY2xvc2UoKTt0aGlzLmV2ZW50U291cmNlPXVuZGVmaW5lZDtpZih0aGlzLm9uY2xvc2Upe3RoaXMub25jbG9zZShlKX19fTtyZXR1cm4gU2VydmVyU2VudEV2ZW50c1RyYW5zcG9ydH0oKX0sZnVuY3Rpb24obW9kdWxlLF9fd2VicGFja19leHBvcnRzX18sX193ZWJwYWNrX3JlcXVpcmVfXyl7InVzZSBzdHJpY3QiO19fd2VicGFja19yZXF1aXJlX18ucihfX3dlYnBhY2tfZXhwb3J0c19fKTtfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywiV2ViU29ja2V0VHJhbnNwb3J0IixmdW5jdGlvbigpe3JldHVybiBXZWJTb2NrZXRUcmFuc3BvcnR9KTt2YXIgX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfXz1fX3dlYnBhY2tfcmVxdWlyZV9fKDgpO3ZhciBfSVRyYW5zcG9ydF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fPV9fd2VicGFja19yZXF1aXJlX18oMjApO3ZhciBfVXRpbHNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfXz1fX3dlYnBhY2tfcmVxdWlyZV9fKDkpO3ZhciBfX2Fzc2lnbj11bmRlZmluZWQmJnVuZGVmaW5lZC5fX2Fzc2lnbnx8T2JqZWN0LmFzc2lnbnx8ZnVuY3Rpb24odCl7Zm9yKHZhciBzLGk9MSxuPWFyZ3VtZW50cy5sZW5ndGg7aTxuO2krKyl7cz1hcmd1bWVudHNbaV07Zm9yKHZhciBwIGluIHMpaWYoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMscCkpdFtwXT1zW3BdfXJldHVybiB0fTt2YXIgX19hd2FpdGVyPXVuZGVmaW5lZCYmdW5kZWZpbmVkLl9fYXdhaXRlcnx8ZnVuY3Rpb24odGhpc0FyZyxfYXJndW1lbnRzLFAsZ2VuZXJhdG9yKXtyZXR1cm4gbmV3KFB8fChQPVByb21pc2UpKShmdW5jdGlvbihyZXNvbHZlLHJlamVjdCl7ZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKXt0cnl7c3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpfWNhdGNoKGUpe3JlamVjdChlKX19ZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpe3RyeXtzdGVwKGdlbmVyYXRvclsidGhyb3ciXSh2YWx1ZSkpfWNhdGNoKGUpe3JlamVjdChlKX19ZnVuY3Rpb24gc3RlcChyZXN1bHQpe3Jlc3VsdC5kb25lP3Jlc29sdmUocmVzdWx0LnZhbHVlKTpuZXcgUChmdW5jdGlvbihyZXNvbHZlKXtyZXNvbHZlKHJlc3VsdC52YWx1ZSl9KS50aGVuKGZ1bGZpbGxlZCxyZWplY3RlZCl9c3RlcCgoZ2VuZXJhdG9yPWdlbmVyYXRvci5hcHBseSh0aGlzQXJnLF9hcmd1bWVudHN8fFtdKSkubmV4dCgpKX0pfTt2YXIgX19nZW5lcmF0b3I9dW5kZWZpbmVkJiZ1bmRlZmluZWQuX19nZW5lcmF0b3J8fGZ1bmN0aW9uKHRoaXNBcmcsYm9keSl7dmFyIF89e2xhYmVsOjAsc2VudDpmdW5jdGlvbigpe2lmKHRbMF0mMSl0aHJvdyB0WzFdO3JldHVybiB0WzFdfSx0cnlzOltdLG9wczpbXX0sZix5LHQsZztyZXR1cm4gZz17bmV4dDp2ZXJiKDApLHRocm93OnZlcmIoMSkscmV0dXJuOnZlcmIoMil9LHR5cGVvZiBTeW1ib2w9PT0iZnVuY3Rpb24iJiYoZ1tTeW1ib2wuaXRlcmF0b3JdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KSxnO2Z1bmN0aW9uIHZlcmIobil7cmV0dXJuIGZ1bmN0aW9uKHYpe3JldHVybiBzdGVwKFtuLHZdKX19ZnVuY3Rpb24gc3RlcChvcCl7aWYoZil0aHJvdyBuZXcgVHlwZUVycm9yKCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuIik7d2hpbGUoXyl0cnl7aWYoZj0xLHkmJih0PW9wWzBdJjI/eVsicmV0dXJuIl06b3BbMF0/eVsidGhyb3ciXXx8KCh0PXlbInJldHVybiJdKSYmdC5jYWxsKHkpLDApOnkubmV4dCkmJiEodD10LmNhbGwoeSxvcFsxXSkpLmRvbmUpcmV0dXJuIHQ7aWYoeT0wLHQpb3A9W29wWzBdJjIsdC52YWx1ZV07c3dpdGNoKG9wWzBdKXtjYXNlIDA6Y2FzZSAxOnQ9b3A7YnJlYWs7Y2FzZSA0Ol8ubGFiZWwrKztyZXR1cm57dmFsdWU6b3BbMV0sZG9uZTpmYWxzZX07Y2FzZSA1Ol8ubGFiZWwrKzt5PW9wWzFdO29wPVswXTtjb250aW51ZTtjYXNlIDc6b3A9Xy5vcHMucG9wKCk7Xy50cnlzLnBvcCgpO2NvbnRpbnVlO2RlZmF1bHQ6aWYoISh0PV8udHJ5cyx0PXQubGVuZ3RoPjAmJnRbdC5sZW5ndGgtMV0pJiYob3BbMF09PT02fHxvcFswXT09PTIpKXtfPTA7Y29udGludWV9aWYob3BbMF09PT0zJiYoIXR8fG9wWzFdPnRbMF0mJm9wWzFdPHRbM10pKXtfLmxhYmVsPW9wWzFdO2JyZWFrfWlmKG9wWzBdPT09NiYmXy5sYWJlbDx0WzFdKXtfLmxhYmVsPXRbMV07dD1vcDticmVha31pZih0JiZfLmxhYmVsPHRbMl0pe18ubGFiZWw9dFsyXTtfLm9wcy5wdXNoKG9wKTticmVha31pZih0WzJdKV8ub3BzLnBvcCgpO18udHJ5cy5wb3AoKTtjb250aW51ZX1vcD1ib2R5LmNhbGwodGhpc0FyZyxfKX1jYXRjaChlKXtvcD1bNixlXTt5PTB9ZmluYWxseXtmPXQ9MH1pZihvcFswXSY1KXRocm93IG9wWzFdO3JldHVybnt2YWx1ZTpvcFswXT9vcFsxXTp2b2lkIDAsZG9uZTp0cnVlfX19O3ZhciBXZWJTb2NrZXRUcmFuc3BvcnQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBXZWJTb2NrZXRUcmFuc3BvcnQoaHR0cENsaWVudCxhY2Nlc3NUb2tlbkZhY3RvcnksbG9nZ2VyLGxvZ01lc3NhZ2VDb250ZW50LHdlYlNvY2tldENvbnN0cnVjdG9yLGhlYWRlcnMpe3RoaXMubG9nZ2VyPWxvZ2dlcjt0aGlzLmFjY2Vzc1Rva2VuRmFjdG9yeT1hY2Nlc3NUb2tlbkZhY3Rvcnk7dGhpcy5sb2dNZXNzYWdlQ29udGVudD1sb2dNZXNzYWdlQ29udGVudDt0aGlzLndlYlNvY2tldENvbnN0cnVjdG9yPXdlYlNvY2tldENvbnN0cnVjdG9yO3RoaXMuaHR0cENsaWVudD1odHRwQ2xpZW50O3RoaXMub25yZWNlaXZlPW51bGw7dGhpcy5vbmNsb3NlPW51bGw7dGhpcy5oZWFkZXJzPWhlYWRlcnN9V2ViU29ja2V0VHJhbnNwb3J0LnByb3RvdHlwZS5jb25uZWN0PWZ1bmN0aW9uKHVybCx0cmFuc2ZlckZvcm1hdCl7cmV0dXJuIF9fYXdhaXRlcih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24oKXt2YXIgdG9rZW47dmFyIF90aGlzPXRoaXM7cmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsZnVuY3Rpb24oX2Epe3N3aXRjaChfYS5sYWJlbCl7Y2FzZSAwOl9VdGlsc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJBcmciXS5pc1JlcXVpcmVkKHVybCwidXJsIik7X1V0aWxzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIkFyZyJdLmlzUmVxdWlyZWQodHJhbnNmZXJGb3JtYXQsInRyYW5zZmVyRm9ybWF0Iik7X1V0aWxzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIkFyZyJdLmlzSW4odHJhbnNmZXJGb3JtYXQsX0lUcmFuc3BvcnRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX1siVHJhbnNmZXJGb3JtYXQiXSwidHJhbnNmZXJGb3JtYXQiKTt0aGlzLmxvZ2dlci5sb2coX0lMb2dnZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX1siTG9nTGV2ZWwiXS5UcmFjZSwiKFdlYlNvY2tldHMgdHJhbnNwb3J0KSBDb25uZWN0aW5nLiIpO2lmKCF0aGlzLmFjY2Vzc1Rva2VuRmFjdG9yeSlyZXR1cm5bMywyXTtyZXR1cm5bNCx0aGlzLmFjY2Vzc1Rva2VuRmFjdG9yeSgpXTtjYXNlIDE6dG9rZW49X2Euc2VudCgpO2lmKHRva2VuKXt1cmwrPSh1cmwuaW5kZXhPZigiPyIpPDA/Ij8iOiImIikrKCJhY2Nlc3NfdG9rZW49IitlbmNvZGVVUklDb21wb25lbnQodG9rZW4pKX1fYS5sYWJlbD0yO2Nhc2UgMjpyZXR1cm5bMixuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLHJlamVjdCl7dXJsPXVybC5yZXBsYWNlKC9eaHR0cC8sIndzIik7dmFyIHdlYlNvY2tldDt2YXIgY29va2llcz1fdGhpcy5odHRwQ2xpZW50LmdldENvb2tpZVN0cmluZyh1cmwpO3ZhciBvcGVuZWQ9ZmFsc2U7aWYoX1V0aWxzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIlBsYXRmb3JtIl0uaXNOb2RlKXt2YXIgaGVhZGVycz17fTt2YXIgX2E9T2JqZWN0KF9VdGlsc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJnZXRVc2VyQWdlbnRIZWFkZXIiXSkoKSxuYW1lXzE9X2FbMF0sdmFsdWU9X2FbMV07aGVhZGVyc1tuYW1lXzFdPXZhbHVlO2lmKGNvb2tpZXMpe2hlYWRlcnNbIkNvb2tpZSJdPSIiK2Nvb2tpZXN9d2ViU29ja2V0PW5ldyBfdGhpcy53ZWJTb2NrZXRDb25zdHJ1Y3Rvcih1cmwsdW5kZWZpbmVkLHtoZWFkZXJzOl9fYXNzaWduKHt9LGhlYWRlcnMsX3RoaXMuaGVhZGVycyl9KX1pZighd2ViU29ja2V0KXt3ZWJTb2NrZXQ9bmV3IF90aGlzLndlYlNvY2tldENvbnN0cnVjdG9yKHVybCl9aWYodHJhbnNmZXJGb3JtYXQ9PT1fSVRyYW5zcG9ydF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJUcmFuc2ZlckZvcm1hdCJdLkJpbmFyeSl7d2ViU29ja2V0LmJpbmFyeVR5cGU9ImFycmF5YnVmZmVyIn13ZWJTb2NrZXQub25vcGVuPWZ1bmN0aW9uKF9ldmVudCl7X3RoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fWyJMb2dMZXZlbCJdLkluZm9ybWF0aW9uLCJXZWJTb2NrZXQgY29ubmVjdGVkIHRvICIrdXJsKyIuIik7X3RoaXMud2ViU29ja2V0PXdlYlNvY2tldDtvcGVuZWQ9dHJ1ZTtyZXNvbHZlKCl9O3dlYlNvY2tldC5vbmVycm9yPWZ1bmN0aW9uKGV2ZW50KXt2YXIgZXJyb3I9bnVsbDtpZih0eXBlb2YgRXJyb3JFdmVudCE9PSJ1bmRlZmluZWQiJiZldmVudCBpbnN0YW5jZW9mIEVycm9yRXZlbnQpe2Vycm9yPWV2ZW50LmVycm9yfWVsc2V7ZXJyb3I9bmV3IEVycm9yKCJUaGVyZSB3YXMgYW4gZXJyb3Igd2l0aCB0aGUgdHJhbnNwb3J0LiIpfXJlamVjdChlcnJvcil9O3dlYlNvY2tldC5vbm1lc3NhZ2U9ZnVuY3Rpb24obWVzc2FnZSl7X3RoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fWyJMb2dMZXZlbCJdLlRyYWNlLCIoV2ViU29ja2V0cyB0cmFuc3BvcnQpIGRhdGEgcmVjZWl2ZWQuICIrT2JqZWN0KF9VdGlsc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fWyJnZXREYXRhRGV0YWlsIl0pKG1lc3NhZ2UuZGF0YSxfdGhpcy5sb2dNZXNzYWdlQ29udGVudCkrIi4iKTtpZihfdGhpcy5vbnJlY2VpdmUpe3RyeXtfdGhpcy5vbnJlY2VpdmUobWVzc2FnZS5kYXRhKX1jYXRjaChlcnJvcil7X3RoaXMuY2xvc2UoZXJyb3IpO3JldHVybn19fTt3ZWJTb2NrZXQub25jbG9zZT1mdW5jdGlvbihldmVudCl7aWYob3BlbmVkKXtfdGhpcy5jbG9zZShldmVudCl9ZWxzZXt2YXIgZXJyb3I9bnVsbDtpZih0eXBlb2YgRXJyb3JFdmVudCE9PSJ1bmRlZmluZWQiJiZldmVudCBpbnN0YW5jZW9mIEVycm9yRXZlbnQpe2Vycm9yPWV2ZW50LmVycm9yfWVsc2V7ZXJyb3I9bmV3IEVycm9yKCJUaGVyZSB3YXMgYW4gZXJyb3Igd2l0aCB0aGUgdHJhbnNwb3J0LiIpfXJlamVjdChlcnJvcil9fX0pXX19KX0pfTtXZWJTb2NrZXRUcmFuc3BvcnQucHJvdG90eXBlLnNlbmQ9ZnVuY3Rpb24oZGF0YSl7aWYodGhpcy53ZWJTb2NrZXQmJnRoaXMud2ViU29ja2V0LnJlYWR5U3RhdGU9PT10aGlzLndlYlNvY2tldENvbnN0cnVjdG9yLk9QRU4pe3RoaXMubG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fWyJMb2dMZXZlbCJdLlRyYWNlLCIoV2ViU29ja2V0cyB0cmFuc3BvcnQpIHNlbmRpbmcgZGF0YS4gIitPYmplY3QoX1V0aWxzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bImdldERhdGFEZXRhaWwiXSkoZGF0YSx0aGlzLmxvZ01lc3NhZ2VDb250ZW50KSsiLiIpO3RoaXMud2ViU29ja2V0LnNlbmQoZGF0YSk7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfXJldHVybiBQcm9taXNlLnJlamVjdCgiV2ViU29ja2V0IGlzIG5vdCBpbiB0aGUgT1BFTiBzdGF0ZSIpfTtXZWJTb2NrZXRUcmFuc3BvcnQucHJvdG90eXBlLnN0b3A9ZnVuY3Rpb24oKXtpZih0aGlzLndlYlNvY2tldCl7dGhpcy5jbG9zZSh1bmRlZmluZWQpfXJldHVybiBQcm9taXNlLnJlc29sdmUoKX07V2ViU29ja2V0VHJhbnNwb3J0LnByb3RvdHlwZS5jbG9zZT1mdW5jdGlvbihldmVudCl7aWYodGhpcy53ZWJTb2NrZXQpe3RoaXMud2ViU29ja2V0Lm9uY2xvc2U9ZnVuY3Rpb24oKXt9O3RoaXMud2ViU29ja2V0Lm9ubWVzc2FnZT1mdW5jdGlvbigpe307dGhpcy53ZWJTb2NrZXQub25lcnJvcj1mdW5jdGlvbigpe307dGhpcy53ZWJTb2NrZXQuY2xvc2UoKTt0aGlzLndlYlNvY2tldD11bmRlZmluZWR9dGhpcy5sb2dnZXIubG9nKF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19bIkxvZ0xldmVsIl0uVHJhY2UsIihXZWJTb2NrZXRzIHRyYW5zcG9ydCkgc29ja2V0IGNsb3NlZC4iKTtpZih0aGlzLm9uY2xvc2Upe2lmKHRoaXMuaXNDbG9zZUV2ZW50KGV2ZW50KSYmKGV2ZW50Lndhc0NsZWFuPT09ZmFsc2V8fGV2ZW50LmNvZGUhPT0xZTMpKXt0aGlzLm9uY2xvc2UobmV3IEVycm9yKCJXZWJTb2NrZXQgY2xvc2VkIHdpdGggc3RhdHVzIGNvZGU6ICIrZXZlbnQuY29kZSsiICgiK2V2ZW50LnJlYXNvbisiKS4iKSl9ZWxzZSBpZihldmVudCBpbnN0YW5jZW9mIEVycm9yKXt0aGlzLm9uY2xvc2UoZXZlbnQpfWVsc2V7dGhpcy5vbmNsb3NlKCl9fX07V2ViU29ja2V0VHJhbnNwb3J0LnByb3RvdHlwZS5pc0Nsb3NlRXZlbnQ9ZnVuY3Rpb24oZXZlbnQpe3JldHVybiBldmVudCYmdHlwZW9mIGV2ZW50Lndhc0NsZWFuPT09ImJvb2xlYW4iJiZ0eXBlb2YgZXZlbnQuY29kZT09PSJudW1iZXIifTtyZXR1cm4gV2ViU29ja2V0VHJhbnNwb3J0fSgpfSxmdW5jdGlvbihtb2R1bGUsX193ZWJwYWNrX2V4cG9ydHNfXyxfX3dlYnBhY2tfcmVxdWlyZV9fKXsidXNlIHN0cmljdCI7X193ZWJwYWNrX3JlcXVpcmVfXy5yKF9fd2VicGFja19leHBvcnRzX18pO19fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCJKc29uSHViUHJvdG9jb2wiLGZ1bmN0aW9uKCl7cmV0dXJuIEpzb25IdWJQcm90b2NvbH0pO3ZhciBfSUh1YlByb3RvY29sX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX189X193ZWJwYWNrX3JlcXVpcmVfXygxNSk7dmFyIF9JTG9nZ2VyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX189X193ZWJwYWNrX3JlcXVpcmVfXyg4KTt2YXIgX0lUcmFuc3BvcnRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfXz1fX3dlYnBhY2tfcmVxdWlyZV9fKDIwKTt2YXIgX0xvZ2dlcnNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzNfXz1fX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTt2YXIgX1RleHRNZXNzYWdlRm9ybWF0X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV80X189X193ZWJwYWNrX3JlcXVpcmVfXygxNCk7dmFyIEpTT05fSFVCX1BST1RPQ09MX05BTUU9Impzb24iO3ZhciBKc29uSHViUHJvdG9jb2w9ZnVuY3Rpb24oKXtmdW5jdGlvbiBKc29uSHViUHJvdG9jb2woKXt0aGlzLm5hbWU9SlNPTl9IVUJfUFJPVE9DT0xfTkFNRTt0aGlzLnZlcnNpb249MTt0aGlzLnRyYW5zZmVyRm9ybWF0PV9JVHJhbnNwb3J0X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19bIlRyYW5zZmVyRm9ybWF0Il0uVGV4dH1Kc29uSHViUHJvdG9jb2wucHJvdG90eXBlLnBhcnNlTWVzc2FnZXM9ZnVuY3Rpb24oaW5wdXQsbG9nZ2VyKXtpZih0eXBlb2YgaW5wdXQhPT0ic3RyaW5nIil7dGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGlucHV0IGZvciBKU09OIGh1YiBwcm90b2NvbC4gRXhwZWN0ZWQgYSBzdHJpbmcuIil9aWYoIWlucHV0KXtyZXR1cm5bXX1pZihsb2dnZXI9PT1udWxsKXtsb2dnZXI9X0xvZ2dlcnNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzNfX1siTnVsbExvZ2dlciJdLmluc3RhbmNlfXZhciBtZXNzYWdlcz1fVGV4dE1lc3NhZ2VGb3JtYXRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzRfX1siVGV4dE1lc3NhZ2VGb3JtYXQiXS5wYXJzZShpbnB1dCk7dmFyIGh1Yk1lc3NhZ2VzPVtdO2Zvcih2YXIgX2k9MCxtZXNzYWdlc18xPW1lc3NhZ2VzO19pPG1lc3NhZ2VzXzEubGVuZ3RoO19pKyspe3ZhciBtZXNzYWdlPW1lc3NhZ2VzXzFbX2ldO3ZhciBwYXJzZWRNZXNzYWdlPUpTT04ucGFyc2UobWVzc2FnZSk7aWYodHlwZW9mIHBhcnNlZE1lc3NhZ2UudHlwZSE9PSJudW1iZXIiKXt0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgcGF5bG9hZC4iKX1zd2l0Y2gocGFyc2VkTWVzc2FnZS50eXBlKXtjYXNlIF9JSHViUHJvdG9jb2xfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX1siTWVzc2FnZVR5cGUiXS5JbnZvY2F0aW9uOnRoaXMuaXNJbnZvY2F0aW9uTWVzc2FnZShwYXJzZWRNZXNzYWdlKTticmVhaztjYXNlIF9JSHViUHJvdG9jb2xfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX1siTWVzc2FnZVR5cGUiXS5TdHJlYW1JdGVtOnRoaXMuaXNTdHJlYW1JdGVtTWVzc2FnZShwYXJzZWRNZXNzYWdlKTticmVhaztjYXNlIF9JSHViUHJvdG9jb2xfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX1siTWVzc2FnZVR5cGUiXS5Db21wbGV0aW9uOnRoaXMuaXNDb21wbGV0aW9uTWVzc2FnZShwYXJzZWRNZXNzYWdlKTticmVhaztjYXNlIF9JSHViUHJvdG9jb2xfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX1siTWVzc2FnZVR5cGUiXS5QaW5nOmJyZWFrO2Nhc2UgX0lIdWJQcm90b2NvbF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fWyJNZXNzYWdlVHlwZSJdLkNsb3NlOmJyZWFrO2RlZmF1bHQ6bG9nZ2VyLmxvZyhfSUxvZ2dlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fWyJMb2dMZXZlbCJdLkluZm9ybWF0aW9uLCJVbmtub3duIG1lc3NhZ2UgdHlwZSAnIitwYXJzZWRNZXNzYWdlLnR5cGUrIicgaWdub3JlZC4iKTtjb250aW51ZX1odWJNZXNzYWdlcy5wdXNoKHBhcnNlZE1lc3NhZ2UpfXJldHVybiBodWJNZXNzYWdlc307SnNvbkh1YlByb3RvY29sLnByb3RvdHlwZS53cml0ZU1lc3NhZ2U9ZnVuY3Rpb24obWVzc2FnZSl7cmV0dXJuIF9UZXh0TWVzc2FnZUZvcm1hdF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfNF9fWyJUZXh0TWVzc2FnZUZvcm1hdCJdLndyaXRlKEpTT04uc3RyaW5naWZ5KG1lc3NhZ2UpKX07SnNvbkh1YlByb3RvY29sLnByb3RvdHlwZS5pc0ludm9jYXRpb25NZXNzYWdlPWZ1bmN0aW9uKG1lc3NhZ2Upe3RoaXMuYXNzZXJ0Tm90RW1wdHlTdHJpbmcobWVzc2FnZS50YXJnZXQsIkludmFsaWQgcGF5bG9hZCBmb3IgSW52b2NhdGlvbiBtZXNzYWdlLiIpO2lmKG1lc3NhZ2UuaW52b2NhdGlvbklkIT09dW5kZWZpbmVkKXt0aGlzLmFzc2VydE5vdEVtcHR5U3RyaW5nKG1lc3NhZ2UuaW52b2NhdGlvbklkLCJJbnZhbGlkIHBheWxvYWQgZm9yIEludm9jYXRpb24gbWVzc2FnZS4iKX19O0pzb25IdWJQcm90b2NvbC5wcm90b3R5cGUuaXNTdHJlYW1JdGVtTWVzc2FnZT1mdW5jdGlvbihtZXNzYWdlKXt0aGlzLmFzc2VydE5vdEVtcHR5U3RyaW5nKG1lc3NhZ2UuaW52b2NhdGlvbklkLCJJbnZhbGlkIHBheWxvYWQgZm9yIFN0cmVhbUl0ZW0gbWVzc2FnZS4iKTtpZihtZXNzYWdlLml0ZW09PT11bmRlZmluZWQpe3Rocm93IG5ldyBFcnJvcigiSW52YWxpZCBwYXlsb2FkIGZvciBTdHJlYW1JdGVtIG1lc3NhZ2UuIil9fTtKc29uSHViUHJvdG9jb2wucHJvdG90eXBlLmlzQ29tcGxldGlvbk1lc3NhZ2U9ZnVuY3Rpb24obWVzc2FnZSl7aWYobWVzc2FnZS5yZXN1bHQmJm1lc3NhZ2UuZXJyb3Ipe3Rocm93IG5ldyBFcnJvcigiSW52YWxpZCBwYXlsb2FkIGZvciBDb21wbGV0aW9uIG1lc3NhZ2UuIil9aWYoIW1lc3NhZ2UucmVzdWx0JiZtZXNzYWdlLmVycm9yKXt0aGlzLmFzc2VydE5vdEVtcHR5U3RyaW5nKG1lc3NhZ2UuZXJyb3IsIkludmFsaWQgcGF5bG9hZCBmb3IgQ29tcGxldGlvbiBtZXNzYWdlLiIpfXRoaXMuYXNzZXJ0Tm90RW1wdHlTdHJpbmcobWVzc2FnZS5pbnZvY2F0aW9uSWQsIkludmFsaWQgcGF5bG9hZCBmb3IgQ29tcGxldGlvbiBtZXNzYWdlLiIpfTtKc29uSHViUHJvdG9jb2wucHJvdG90eXBlLmFzc2VydE5vdEVtcHR5U3RyaW5nPWZ1bmN0aW9uKHZhbHVlLGVycm9yTWVzc2FnZSl7aWYodHlwZW9mIHZhbHVlIT09InN0cmluZyJ8fHZhbHVlPT09IiIpe3Rocm93IG5ldyBFcnJvcihlcnJvck1lc3NhZ2UpfX07cmV0dXJuIEpzb25IdWJQcm90b2NvbH0oKX1dKX0pOwovLyMgc291cmNlTWFwcGluZ1VSTD1zaWduYWxyLm1pbi5qcy5tYXA=";

                return new ContentResult()
                {
                    Content = stringPayload.DecodeBase64(),
                    ContentType = "application/javascript",
                    StatusCode = 200
                };
            }
            catch (Exception)
            {
                return new ContentResult()
                {
                    Content = "Could not return signalr.js",
                    ContentType = "application/json",
                    StatusCode = 500
                };
            }
        }
    }
}
